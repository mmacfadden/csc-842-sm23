var maxDigits,ZERO_ARRAY,bigZero,bigOne,biRadixBase=2,biRadixBits=16,bitsPerDigit=biRadixBits,biRadix=65536,biHalfRadix=biRadix>>>1,biRadixSquared=biRadix*biRadix,maxDigitVal=biRadix-1,maxInteger=9999999999999998;function setMaxDigits(i){ZERO_ARRAY=new Array(maxDigits=i);for(var t=0;t<ZERO_ARRAY.length;t++)ZERO_ARRAY[t]=0;bigZero=new BigInt,(bigOne=new BigInt).digits[0]=1}setMaxDigits(20);var dpl10=15,lr10=biFromNumber(1e15);function BigInt(i){this.digits="boolean"==typeof i&&1==i?null:ZERO_ARRAY.slice(0),this.isNeg=!1}function biFromDecimal(i){for(var t,r="-"==i.charAt(0),e=r?1:0;e<i.length&&"0"==i.charAt(e);)++e;if(e==i.length)t=new BigInt;else{var g=(i.length-e)%dpl10;for(0==g&&(g=dpl10),t=biFromNumber(Number(i.substr(e,g))),e+=g;e<i.length;)t=biAdd(biMultiply(t,lr10),biFromNumber(Number(i.substr(e,dpl10)))),e+=dpl10;t.isNeg=r}return t}function biCopy(i){var t=new BigInt(!0);return t.digits=i.digits.slice(0),t.isNeg=i.isNeg,t}function biFromNumber(i){var t=new BigInt;t.isNeg=i<0,i=Math.abs(i);for(var r=0;0<i;)t.digits[r++]=i&maxDigitVal,i=Math.floor(i/biRadix);return t}function reverseStr(i){for(var t="",r=i.length-1;-1<r;--r)t+=i.charAt(r);return t}var hexatrigesimalToChar=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z");function biToString(i,t){var r=new BigInt;r.digits[0]=t;for(var e=biDivideModulo(i,r),g=hexatrigesimalToChar[e[1].digits[0]];1==biCompare(e[0],bigZero);)e=biDivideModulo(e[0],r),digit=e[1].digits[0],g+=hexatrigesimalToChar[e[1].digits[0]];return(i.isNeg?"-":"")+reverseStr(g)}function biToDecimal(i){var t=new BigInt;t.digits[0]=10;for(var r=biDivideModulo(i,t),e=String(r[1].digits[0]);1==biCompare(r[0],bigZero);)r=biDivideModulo(r[0],t),e+=String(r[1].digits[0]);return(i.isNeg?"-":"")+reverseStr(e)}var hexToChar=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");function digitToHex(t){var r="";for(i=0;i<4;++i)r+=hexToChar[15&t],t>>>=4;return reverseStr(r)}function biToHex(i){for(var t="",r=(biHighIndex(i),biHighIndex(i));-1<r;--r)t+=digitToHex(i.digits[r]);return t}function charToHex(i){i=48<=i&&i<=57?i-48:65<=i&&i<=90?10+i-65:97<=i&&i<=122?10+i-97:0;return i}function hexToDigit(i){for(var t=0,r=Math.min(i.length,4),e=0;e<r;++e)t<<=4,t|=charToHex(i.charCodeAt(e));return t}function biFromHex(i){for(var t=new BigInt,r=i.length,e=0;0<r;r-=4,++e)t.digits[e]=hexToDigit(i.substr(Math.max(r-4,0),Math.min(r,4)));return t}function biFromString(i,t){var r="-"==i.charAt(0),e=r?1:0,g=new BigInt;(n=new BigInt).digits[0]=1;for(var s=i.length-1;e<=s;s--)var g=biAdd(g,biMultiplyDigit(n,charToHex(i.charCodeAt(s)))),n=biMultiplyDigit(n,t);return g.isNeg=r,g}function biDump(i){return(i.isNeg?"-":"")+i.digits.join(" ")}function biAdd(i,t){if(i.isNeg!=t.isNeg)t.isNeg=!t.isNeg,e=biSubtract(i,t),t.isNeg=!t.isNeg;else{for(var r,e=new BigInt,g=0,s=0;s<i.digits.length;++s)r=i.digits[s]+t.digits[s]+g,e.digits[s]=r%biRadix,g=Number(biRadix<=r);e.isNeg=i.isNeg}return e}function biSubtract(i,t){if(i.isNeg!=t.isNeg)t.isNeg=!t.isNeg,e=biAdd(i,t),t.isNeg=!t.isNeg;else{for(var r,e=new BigInt,g=s=0;g<i.digits.length;++g)r=i.digits[g]-t.digits[g]+s,e.digits[g]=r%biRadix,e.digits[g]<0&&(e.digits[g]+=biRadix),s=0-Number(r<0);if(-1==s){for(var s=0,g=0;g<i.digits.length;++g)r=0-e.digits[g]+s,e.digits[g]=r%biRadix,e.digits[g]<0&&(e.digits[g]+=biRadix),s=0-Number(r<0);e.isNeg=!i.isNeg}else e.isNeg=i.isNeg}return e}function biHighIndex(i){for(var t=i.digits.length-1;0<t&&0==i.digits[t];)--t;return t}function biNumBits(i){for(var t=biHighIndex(i),r=i.digits[t],e=(t+1)*bitsPerDigit,g=e;e-bitsPerDigit<g&&0==(32768&r);--g)r<<=1;return g}function biMultiply(i,t){for(var r,e,g,s=new BigInt,n=biHighIndex(i),d=biHighIndex(t),o=0;o<=d;++o){for(g=o,j=r=0;j<=n;++j,++g)e=s.digits[g]+i.digits[j]*t.digits[o]+r,s.digits[g]=e&maxDigitVal,r=e>>>biRadixBits;s.digits[o+n+1]=r}return s.isNeg=i.isNeg!=t.isNeg,s}function biMultiplyDigit(i,t){var r;result=new BigInt;for(var e=biHighIndex(i),g=0,s=0;s<=e;++s)r=result.digits[s]+i.digits[s]*t+g,result.digits[s]=r&maxDigitVal,g=r>>>biRadixBits;return result.digits[1+e]=g,result}function arrayCopy(i,t,r,e,g){for(var s=Math.min(t+g,i.length),n=t,d=e;n<s;++n,++d)r[d]=i[n]}var highBitMasks=new Array(0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535);function biShiftLeft(i,t){var r=Math.floor(t/bitsPerDigit),e=new BigInt;arrayCopy(i.digits,0,e.digits,r,e.digits.length-r);for(var g=t%bitsPerDigit,s=bitsPerDigit-g,n=e.digits.length-1,d=n-1;0<n;--n,--d)e.digits[n]=e.digits[n]<<g&maxDigitVal|(e.digits[d]&highBitMasks[g])>>>s;return e.digits[0]=e.digits[n]<<g&maxDigitVal,e.isNeg=i.isNeg,e}var lowBitMasks=new Array(0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535);function biShiftRight(i,t){var r=Math.floor(t/bitsPerDigit),e=new BigInt;arrayCopy(i.digits,r,e.digits,0,i.digits.length-r);for(var g=t%bitsPerDigit,s=bitsPerDigit-g,n=0,d=n+1;n<e.digits.length-1;++n,++d)e.digits[n]=e.digits[n]>>>g|(e.digits[d]&lowBitMasks[g])<<s;return e.digits[e.digits.length-1]>>>=g,e.isNeg=i.isNeg,e}function biMultiplyByRadixPower(i,t){var r=new BigInt;return arrayCopy(i.digits,0,r.digits,t,r.digits.length-t),r}function biDivideByRadixPower(i,t){var r=new BigInt;return arrayCopy(i.digits,t,r.digits,0,r.digits.length-t),r}function biModuloByRadixPower(i,t){var r=new BigInt;return arrayCopy(i.digits,0,r.digits,0,t),r}function biCompare(i,t){if(i.isNeg!=t.isNeg)return 1-2*Number(i.isNeg);for(var r=i.digits.length-1;0<=r;--r)if(i.digits[r]!=t.digits[r])return i.isNeg?1-2*Number(i.digits[r]>t.digits[r]):1-2*Number(i.digits[r]<t.digits[r]);return 0}function biDivideModulo(i,t){var r=biNumBits(i),e=biNumBits(t),g=t.isNeg;if(r<e)return i.isNeg?((s=biCopy(bigOne)).isNeg=!t.isNeg,i.isNeg=!1,t.isNeg=!1,n=biSubtract(t,i),i.isNeg=!0,t.isNeg=g):(s=new BigInt,n=biCopy(i)),new Array(s,n);for(var s=new BigInt,n=i,d=Math.ceil(e/bitsPerDigit)-1,o=0;t.digits[d]<biHalfRadix;)t=biShiftLeft(t,1),++o,++e,d=Math.ceil(e/bitsPerDigit)-1;n=biShiftLeft(n,o),r+=o;for(var a=Math.ceil(r/bitsPerDigit)-1,u=biMultiplyByRadixPower(t,a-d);-1!=biCompare(n,u);)++s.digits[a-d],n=biSubtract(n,u);for(var b=a;d<b;--b){var l=b>=n.digits.length?0:n.digits[b],h=b-1>=n.digits.length?0:n.digits[b-1],f=b-2>=n.digits.length?0:n.digits[b-2],x=d>=t.digits.length?0:t.digits[d],c=d-1>=t.digits.length?0:t.digits[d-1];s.digits[b-d-1]=l==x?maxDigitVal:Math.floor((l*biRadix+h)/x);for(var m=s.digits[b-d-1]*(x*biRadix+c),v=l*biRadixSquared+(h*biRadix+f);v<m;)--s.digits[b-d-1],m=s.digits[b-d-1]*(x*biRadix|c),v=l*biRadix*biRadix+(h*biRadix+f);(n=biSubtract(n,biMultiplyDigit(u=biMultiplyByRadixPower(t,b-d-1),s.digits[b-d-1]))).isNeg&&(n=biAdd(n,u),--s.digits[b-d-1])}return n=biShiftRight(n,o),s.isNeg=i.isNeg!=g,i.isNeg&&(s=(g?biAdd:biSubtract)(s,bigOne),n=biSubtract(t=biShiftRight(t,o),n)),0==n.digits[0]&&0==biHighIndex(n)&&(n.isNeg=!1),new Array(s,n)}function biDivide(i,t){return biDivideModulo(i,t)[0]}function biModulo(i,t){return biDivideModulo(i,t)[1]}function biMultiplyMod(i,t,r){return biModulo(biMultiply(i,t),r)}function biPow(i,t){for(var r=bigOne,e=i;0!=(1&t)&&(r=biMultiply(r,e)),0!=(t>>=1);)e=biMultiply(e,e);return r}function biPowMod(i,t,r){for(var e=bigOne,g=i,s=t;0!=(1&s.digits[0])&&(e=biMultiplyMod(e,g,r)),0!=(s=biShiftRight(s,1)).digits[0]||0!=biHighIndex(s);)g=biMultiplyMod(g,g,r);return e}function RSAKeyPair(i,t,r){this.e=biFromHex(i),this.d=biFromHex(t),this.m=biFromHex(r),this.digitSize=2*biHighIndex(this.m)+2,this.chunkSize=this.digitSize-11,this.radix=16,this.barrett=new BarrettMu(this.m)}function twoDigit(i){return(i<10?"0":"")+String(i)}function encryptedString(i,t){if(i.chunkSize>i.digitSize-11)return"Error";for(var r=new Array,e=t.length,g=0;g<e;)r[g]=t.charCodeAt(g),g++;for(var s,n=r.length,d="",g=0;g<n;g+=i.chunkSize){for(var o=new BigInt,a=0,u=g+i.chunkSize>n?n%i.chunkSize:i.chunkSize,b=new Array,l=0;l<u;l++)b[l]=r[g+u-1-l];b[u]=0;var h=Math.max(8,i.digitSize-3-u);for(l=0;l<h;l++)b[u+1+l]=Math.floor(254*Math.random())+1;for(b[i.digitSize-2]=2,s=b[i.digitSize-1]=0;s<i.digitSize;++a)o.digits[a]=b[s++],o.digits[a]+=b[s++]<<8;var f=i.barrett.powMod(o,i.e);d+=(16==i.radix?biToHex(f):biToString(f,i.radix))+" "}return d.substring(0,d.length-1)}function decryptedString(i,t){for(var r=t.split(" "),e="",g=0;g<r.length;++g)for(var s=16==i.radix?biFromHex(r[g]):biFromString(r[g],i.radix),n=i.barrett.powMod(s,i.d),d=0;d<=biHighIndex(n);++d)e+=String.fromCharCode(255&n.digits[d],n.digits[d]>>8);return e=0==e.charCodeAt(e.length-1)?e.substring(0,e.length-1):e}function BarrettMu(i){this.modulus=biCopy(i),this.k=biHighIndex(this.modulus)+1;i=new BigInt;i.digits[2*this.k]=1,this.mu=biDivide(i,this.modulus),this.bkplus1=new BigInt,this.bkplus1.digits[this.k+1]=1,this.modulo=BarrettMu_modulo,this.multiplyMod=BarrettMu_multiplyMod,this.powMod=BarrettMu_powMod}function BarrettMu_modulo(i){for(var t=biDivideByRadixPower(i,this.k-1),t=biDivideByRadixPower(biMultiply(t,this.mu),this.k+1),r=biSubtract(biModuloByRadixPower(i,this.k+1),biModuloByRadixPower(biMultiply(t,this.modulus),this.k+1)),e=0<=biCompare(r=r.isNeg?biAdd(r,this.bkplus1):r,this.modulus);e;)e=0<=biCompare(r=biSubtract(r,this.modulus),this.modulus);return r}function BarrettMu_multiplyMod(i,t){t=biMultiply(i,t);return this.modulo(t)}function BarrettMu_powMod(i,t){var r=new BigInt;r.digits[0]=1;for(var e=i,g=t;0!=(1&g.digits[0])&&(r=this.multiplyMod(r,e)),0!=(g=biShiftRight(g,1)).digits[0]||0!=biHighIndex(g);)e=this.multiplyMod(e,e);return r}