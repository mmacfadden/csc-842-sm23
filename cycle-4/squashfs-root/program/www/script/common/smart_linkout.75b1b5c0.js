Utils.$package("smartLinkOutIframe"),smartLinkOutIframe=function(s){var m={},c={LinkOutPreset:0,LinkOutFTP:0,LinkOutUSBStor:0,LinkOutEmail:0,LinkOutSwitch:0,LinkOutFaceCapture:0,LinkOutFeatureCapture:0,LinkOutAlarmReport:0,LinkOutPic:0},A={};return new(Class.extend({setLinkOutValueToMap:function(){var t,e,a,r,i,u=0;for(t in m.Actions=[],c)s("#"+t).is(":checked")&&(e={},r=a=-1,i=s("#"+t).attr("actId"),u++,-1<t.indexOf("Preset")?(a=SmartAlarmAct.PRESET,r=s("#PresetNum").val()):-1<t.indexOf("Switch")?(a=SmartAlarmAct.OUT_SWITCH,r=1):-1<t.indexOf("FTP")?a=SmartAlarmAct.CAPTURE2FTP:-1<t.indexOf("Stor")?a=SmartAlarmAct.START_LOCAL_STORAGE:-1<t.indexOf("Email")?a=SmartAlarmAct.CAPTURE2EMAIL:-1<t.indexOf("FaceCapture")?a=SmartAlarmAct.FACE_CAPTURE:-1<t.indexOf("FeatureCapture")?a=SmartAlarmAct.FEATURE_CAPTURE:-1<t.indexOf("AlarmReport")?a=SmartAlarmAct.CENTER_REPORT:-1<t.indexOf("Pic")&&(a=SmartAlarmAct.FEATURE_CAPTURE),-1!=a&&(void 0===i&&(i=a),e.ActID=i),-1!=r&&(e.ActParam=5==i?{Num:r,IDs:[1]}:4==i?{Num:1,ChannelPresetList:{0:{PresetID:r}}}:r),m.Actions.push(e));m.Num=u},makePresetList:function(){var t,e,a;Capinfo.isSupportPTZ&&(t=document.frmSetup,e=s("#position").html(),(a=s("#PresetNum")).empty(),a.append(e),s("#PresetNum option:first").remove(),0==t.PresetNum.length&&(t.LinkOutPreset.disabled=!0))},initPreset:function(){var t=document.frmSetup;1==t.LinkOutPreset.checked&&0==t.PresetNum.length&&(t.LinkOutPreset.checked=!1),t.PresetNum.disabled=!t.LinkOutPreset.checked},IsChanged:function(){return s("#LinkOutPreset").is(":checked")&&(c.PresetNum=s("#PresetNum").val()),Utils.LAPI_FormToCfg("frmSetup",c),!Utils.isObjectEquals(c,A)},submitF:function(t){return this.setLinkOutValueToMap(),(t=Utils.LAPI_SetCfgData(t,m,!1))&&(A=Utils.objectClone(c)),Frame.showMsg(t),t},initPage:function(t){for(var e=0;e<t.length;e++)"presetLi"==t[e]&&!Capinfo.isSupportPTZ||"ftpLi"==t[e]&&!Capinfo.isSupportBasicFTP||"emailLi"==t[e]&&!Capinfo.isSupportEmail||!("storLi"!=t[e]&&"picLi"!=t[e]||Capinfo.isSupportStorage)||"switchOutLi"==t[e]&&!Capinfo.isSupportSwitchOut||"AlarmBoxLi"==t[e]&&!Capinfo.isSupportVM||s("#"+t[e]).removeClass("hidden");0==s("#smartLinkOutIFrame li:visible").length&&s("#smartLinkOutIFrame").addClass("hidden")},initData:function(t){var e=document.frmSetup;if(m={},c={LinkOutPreset:0,LinkOutFTP:0,LinkOutUSBStor:0,LinkOutEmail:0,LinkOutSwitch:0,LinkOutFaceCapture:0,LinkOutFeatureCapture:0,LinkOutAlarmReport:0,LinkOutPic:0},!Utils.LAPI_GetCfgData(t,m))return Utils.disableAll(),!1;for(var a=m.Num,r=m.Actions,i=0;i<a;i++){var u=r[i],n=(u.AlarmParam,u.ActID);switch(Number(n)){case SmartAlarmAct.PRESET:c.LinkOutPreset=1,c.PresetNum=u.ActParam.ChannelPresetList[0].PresetID,s("#presetLi").attr("actId",n);break;case SmartAlarmAct.OUT_SWITCH:c.LinkOutSwitch=1,s("#switchOutLi").attr("actId",n);break;case SmartAlarmAct.CAPTURE2FTP:c.LinkOutFTP=1,s("#ftpLi").attr("actId",n);break;case SmartAlarmAct.START_LOCAL_STORAGE:c.LinkOutUSBStor=1,s("#storLi").attr("actId",n);break;case SmartAlarmAct.CAPTURE2EMAIL:c.LinkOutEmail=1,s("#emailLi").attr("actId",n);break;case SmartAlarmAct.FACE_CAPTURE:c.LinkOutFaceCapture=1,s("#FaceCaptureLi").attr("actId",n);break;case SmartAlarmAct.FEATURE_CAPTURE:Frame.currentNameSpace===Config.iva_capture?(c.LinkOutFeatureCapture=1,s("#FeatureCaptureLi").attr("actId",n)):(c.LinkOutPic=1,s("#picLi").attr("actId",n));break;case SmartAlarmAct.CENTER_REPORT:c.LinkOutAlarmReport=1,s("#AlarmBoxLi").attr("actId",n)}}return A=Utils.objectClone(c),this.makePresetList(),Utils.cfgToForm(c,"frmSetup"),Utils.setComboxTitle("PresetNum"),this.initPreset(e),!0}}))}(jQuery);