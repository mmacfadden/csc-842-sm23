Config.OperateSound=function(d){var n=null,l={},a={},s={},t={},u={},p={Mute:["IsMute"],audioInMode:["Type"],EncFormat:["EncodeFormat"],Sampling:["SampleRate"],InputPlus:["InputGain"],NoiseReduction:["NoiseReduction","Enabled"],AudioDevice1:["AudioInputList",0,"Mode"],AudioOut1:["AudioInputList",0,"Enabled"]};return new(Class.extend({init:function(){Utils.beforeDataLoad(),Utils.initLang(),this.initPage(),this.initValidator(),this.initEvent(),this.initData(),Utils.afterDataLoad()},initPage:function(){var i=[];this.initVideoFormatOption(),this.initAudioInMode(),Utils.parseCapOptions("AudioDevice1",Capinfo.AudioInItem0Mode,"mode"),2==Capinfo.AudioInNum&&(d("#AudioInDevice2").removeClass("hidden"),Utils.parseCapOptions("AudioDevice2",Capinfo.AudioInItem1Mode,"mode"),p.AudioDevice2=["AudioInputList",1,"Mode"],p.AudioOut2=["AudioInputList",1,"Enabled"]),Capinfo.AudioOutNum&&(d("#AudioOutCfg").removeClass("hidden"),i.push(Capinfo.AudioOutItem0Mode),1<Capinfo.AudioOutNum&&i.push(Capinfo.AudioOutItem1Mode),Utils.parseCapOptions("AudioSpeakerMode",i,"mode")),Capinfo.isSupportFishEye&&(d("#AudioOutCfg").removeClass("hidden"),i='<option value="0">Line_Out</option>',Capinfo.isSupportMicOut&&(i+='<option value="1">'+d.lang.pub.LoudSpeaker+"</option>"),d("#AudioOutMode").append(i)),Capinfo.isSupportNoiseReduction&&d("#audioEchoCancellation").removeClass("hidden")},initData:function(){var i=d("#audioInMode");a={},Utils.LAPI_GetCfgData(LAPI_URL.AudioIn,a)?(s=Utils.objectClone(a),Utils.LAPI_CfgToForm("frmSetup",a,l,p),this.AudioEncformat_change(),d("#Sampling").val(l.Sampling),undefined!=i.val()&&1==i.val()&&this.changeInput(),1==i.val()&&(d("#AudioInDevice1").addClass("hidden"),d("#AudioInDevice2").addClass("hidden")),this.disableAudioEchoCancellation(),Capinfo.AudioOutNum&&Utils.LAPI_GetCfgData(LAPI_URL.AudioOut,t)&&(u=Utils.objectClone(t),d("#AudioSpeakerMode").val(t.DeviceType))):Utils.disableAll()},initEvent:function(){var i=this;d("#audioInMode").change(function(){i.changeInput()}),d("#EncFormat").change(function(){i.AudioEncformat_change()}),d("input[name='audioProcessing']").bind("click",function(){i.audioProcessing_click()}),d("#Sampling").change(function(){i.disableAudioEchoCancellation()})},submitF:function(){if(Capinfo.isSupport4KFishEye&&(t.DeviceType=d("#AudioSpeakerMode").val(),Utils.isObjectEquals(u,t)||Utils.LAPI_SetCfgData(LAPI_URL.AudioOut,t)&&(u=Utils.objectClone(t))),Utils.IsChanged("frmSetup",l)&&n.form()){if(0==d("#audioInMode").val()){var i=d("#AudioOut1").is(":checked"),o=d("#AudioOut2").is(":checked");if(!Capinfo.isSupportDualAudio&&i&&o)return void Frame.showMsg(!1,d.lang.tip.tipDoubleAudio)}if(Utils.LAPI_FormToCfg("frmSetup",a,l,p),Utils.LAPI_SetCfgData(LAPI_URL.AudioIn,a)){if(l.AudioOut2==undefined?l.AudioOut1!=s.AudioInputList[0].Enabled||l.audioInMode!=s.audioInMode:l.AudioOut1!=s.AudioInputList[0].Enabled||l.AudioOut2!=s.AudioInputList[1].Enabled||l.audioInMode!=s.audioInMode){for(var e=0;e<Video.statusList.length;e++)Video.statusList[e].isVideoOpen&&Video.stopVideo(StreamType.LIVE,e);Video.isVoiceTalkOpen&&(Video.stopVoiceTalk(),d("#MuteOn").is(":checked")&&Video.startVoiceTalk())}s=Utils.objectClone(a)}}},release:function(){Frame.currentNameSpace="",delete Config.OperateSound},initValidator:function(){d("#InputPlus").attr("tip",d.validator.format(d.lang.tip.tipIntRange,0,255)),(n=d("#frmSetup").validate({debug:!1,focusInvalid:!1,errorElement:"span",errorPlacement:function(i,o){Utils.showJqueryErr(i,o,"div")},success:function(){},rules:{InputPlus:{integer:!0,required:!0,range:[0,255]}}})).init()},AudioEncformat_change:function(){for(var i=d("#EncFormat").val(),o=d("#Sampling"),e=d("#audioInMode"),n=Capinfo.audioSampling,a="",t=0,u=n[i].length;t<u;t++)switch(parseInt(n[i][t])){case 0:a+="<option value='0'>8</option>";break;case 1:a+="<option value='1'>16</option>";break;case 6:a+="<option value='6'>48</option>";break;case 7:a+="<option value='7'>96</option>"}o.html(a),1==u?o.prop("disabled",!0):o.prop("disabled",!1),6==i&&undefined!=e.val()&&1==e.val()&&(o.html("<option value='4'>32</option>"),o.val(4),o.prop("disabled",!0)),this.disableAudioEchoCancellation()},audioProcessing_click:function(){var i=d("input[name='audioProcessing']:checked").val();0==i?(d("#AudioEchoCancellation").val(0),d("#NoiseReduction").val(0)):1==i?(d("#AudioEchoCancellation").val(0),d("#NoiseReduction").val(1)):2==i&&(d("#AudioEchoCancellation").val(1),d("#NoiseReduction").val(0))},initVideoFormatOption:function(){for(var i=Capinfo.audioFormatArr,o="",e=0;e<i.length;e++)switch(Number(i[e])){case 1:o+="<option value='1'>G.711A</option>";break;case 2:o+="<option value='2'>G.711U</option>";break;case 6:o+="<option value='6'>AAC-LC</option>";break;case 7:o+="<option value='7'>PCM</option>";break;case 8:o+="<option value='8'>G.726</option>";break;case 9:o+="<option value='9'>MP2L2</option>";break;case 10:o+="<option value='10'>G.722.1</option>";break;default:throw new Error("This shouldn't happen.")}d("#EncFormat").html(o)},initAudioInMode:function(){var i=d("#audioInMode"),o=i.html();Capinfo.isSupportSerialInput&&(o+="<option value='1'>"+d.lang.pub.audioOutCapture+"</option>"),i.html(o)},ChannelModeEnable:function(){0==d("#audioInMode").val()&&(d("#AudioInDevice1").removeClass("hidden"),2==Capinfo.AudioInNum&&d("#AudioInDevice2").removeClass("hidden"))},disableAudioEchoCancellation:function(){var i=6==d("#Sampling").val()?1:0;d("input[name='NoiseReduction']").prop("disabled",i)},changeInput:function(){var i=d("#EncFormat"),o=d("#InputPlus"),e=d("#Sampling"),n=d("#inputTip"),a=d("#audioEchoCancellation"),t=d("#audioInMode"),u=t.val();Utils.LAPI_CfgToForm("frmSetup",s,l,p),t.val(u),1==t.val()?(i.html(""),i.prop("disabled",!0),n.fadeIn("slow"),o.prop("disabled",!0),i.html("<option value='6'>AAC-LC</option>"),o.val(128),e.html("<option value='4'>32</option>"),e.prop("disabled",!0),d("#AudioInDevice1").addClass("hidden"),d("#AudioInDevice2").addClass("hidden"),a.addClass("hidden")):(this.initVideoFormatOption(),this.ChannelModeEnable(),i.prop("disabled",!1),i.val("1"==l.EncFormat?l.EncFormat:"2"),o.val(l.InputPlus),n.fadeOut("slow"),o.prop("disabled",!1),Capinfo.isSupportNoiseReduction&&a.removeClass("hidden"),this.AudioEncformat_change())}}))}(jQuery),Frame.currentNameSpace=Config.OperateSound;