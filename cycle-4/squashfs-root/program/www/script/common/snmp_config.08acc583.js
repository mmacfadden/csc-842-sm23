Config.snmp=function(i){var t=!1,a=!1,P=!1,r=!1,l="@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@",n={},u={},S={},v={SNMPType:["Type"],SNMPV3UserName:["SNMPv3","UserName"],SNMPV3AuthName:["SNMPv3","AuthName"],SNMPV3PrivMode:["SNMPv3","PrivMode"],SNMPROCommuName:["SNMPv2","ROCommunity"]};return new(Class.extend({init:function(){Utils.beforeDataLoad(),Utils.initLang(),this.initEvent(),this.initValidator(),this.initData(document.frmSetup),Utils.afterDataLoad()},initData:function(e){e.SNMPV3AuthKey.value=l,e.cfgAuthKey.value=l,e.SNMPV3PrivKey.value=l,e.cfgPrivKey.value=l,u={},n={},Utils.LAPI_GetCfgData(LAPI_URL.SNMP_Cfg,u)&&(this.showHidden(u.Type),S=Utils.objectClone(u),Utils.LAPI_CfgToForm("frmSetup",u,n,v))},initEvent:function(){var t=this;i("#SNMPType").change(function(){validator.resetForm(),t.initValidator();var e=i(this).val();0!=e||confirm(i.lang.tip.tipSNMPv2NotSafe)||(e=1),t.showHidden(e)})},showHidden:function(e){1==e?(i(".SNMPv2").addClass("hidden"),i(".SNMPv3").removeClass("hidden"),i("#SNMPType").val(1)):(i(".SNMPv3").addClass("hidden"),i(".SNMPv2").removeClass("hidden"))},initValidator:function(){var t=this;i("#SNMPV3AuthKey").attr("tip",i.lang.tip.tipSNMPPwdInfo),i("#cfgAuthKey").attr("tip",i.lang.tip.tipSNMPPwdInfo),i("#SNMPV3PrivKey").attr("tip",i.lang.tip.tipSNMPPwdInfo),i("#cfgPrivKey").attr("tip",i.lang.tip.tipSNMPPwdInfo),i("#SNMPROCommuName").attr("tip",i.lang.tip.tipSNMPROCommuName),i.validator.addMethod("valPwd",function(e){return t.validPwdCheck(e)},i.lang.tip.tipSNMPKeyErr),i.validator.addMethod("cfgAuthKeyPwd",function(){return i("#SNMPV3AuthKey").val()==i("#cfgAuthKey").val()},i.lang.tip.tipCfmKeyErr),i.validator.addMethod("cfgPrivPwd",function(){return i("#SNMPV3PrivKey").val()==i("#cfgPrivKey").val()},i.lang.tip.tipCfmKeyErr),i.validator.addMethod("validV2commonName",function(e){return t.validV2commonName(e)},i.lang.tip.tipSNMPROCommuNameErr),validator=i("#frmSetup").validate({focusInvalid:!1,errorElement:"span",errorPlacement:function(e,t){Utils.showJqueryErr(e,t,"span")},success:function(){},rules:{SNMPV3AuthKey:{required:!0,valPwd:""},cfgAuthKey:{required:!0,valPwd:"",cfgAuthKeyPwd:""},SNMPV3PrivKey:{required:!0,valPwd:""},cfgPrivKey:{required:!0,valPwd:"",cfgPrivPwd:""},SNMPROCommuName:{required:!0,validV2commonName:""}}}),validator.init()},release:function(){delete Config.snmp},validPwdCheck:function(e){return!/[^0-9A-Za-z_\-@]{1,}/.test(e)&&8<=e.length&&e.length<=32},validV2commonName:function(e){return!/[^0-9A-Za-z_\-@]{1,}/.test(e)&&1<=e.length&&e.length<=32},submitF:function(){var e;validator.form()&&(Utils.LAPI_FormToCfg("frmSetup",u,n,v),e=!Utils.isObjectEquals(u,S),t||P||e?((t||P)&&(u.SNMPv3.RSAPublicKey={},u.SNMPv3.RSAPublicKey.RSAPublicKeyE=Frame.RSAPublicKeyE,u.SNMPv3.RSAPublicKey.RSAPublicKeyN=Frame.RSAPublicKeyN,t&&(u.SNMPv3.AuthKey=Utils.encrypting(i("#SNMPV3AuthKey").val(),Frame.RSAKey)),P&&(u.SNMPv3.PrivKey=Utils.encrypting(i("#SNMPV3PrivKey").val(),Frame.RSAKey))),Utils.LAPI_SetCfgData(LAPI_URL.SNMP_Cfg,u,!1,this.callback)):Frame.showMsg(!0,i.lang.tip.tipAnyChangeInfo,0))},callback:function(e){ResultCode.RESULT_CODE_SUCCEED==e?((t||P)&&(delete u.SNMPv3.RSAPublicKey,t&&delete u.SNMPv3.AuthKey,P&&delete u.SNMPv3.PrivKey),S=Utils.objectClone(u),r=P=a=t=!1,i("#SNMPV3AuthKey").val(l),i("#cfgAuthKey").val(l),i("#SNMPV3PrivKey").val(l),i("#cfgPrivKey").val(l),Frame.showMsg(!0)):ResultCode.RESULT_RASPUBLICKEY_AUTH_ERR==e?(e={},Utils.LAPI_GetCfgData(LAPI_URL.SecurityRSA,e)&&(setMaxDigits(130),Frame.RSAPublicKeyE=e.RSAPublicKeyE,Frame.RSAPublicKeyN=e.RSAPublicKeyN,Frame.RSAKey=new RSAKeyPair(Frame.RSAPublicKeyE,"",Frame.RSAPublicKeyN),u.SNMPv3.RSAPublicKey={},u.SNMPv3.RSAPublicKey.RSAPublicKeyE=Frame.RSAPublicKeyE,u.SNMPv3.RSAPublicKey.RSAPublicKeyN=Frame.RSAPublicKeyN,t&&(u.SNMPv3.AuthKey=Utils.encrypting(i("#SNMPV3AuthKey").val(),Frame.RSAKey)),P&&(u.SNMPv3.PrivKey=Utils.encrypting(i("#SNMPV3PrivKey").val(),Frame.RSAKey)),Utils.LAPI_SetCfgData(LAPI_URL.SNMP_Cfg,u,!1,Config.snmp.callback))):Frame.showMsg(!1,i.lang.tip.tipSetCfgFail)},initPwdChanged:function(e){"SNMPV3AuthKey"!=e||t?"cfgAuthKey"!=e||a?"SNMPV3PrivKey"!=e||P?"cfgPrivKey"!=e||r||(i("#"+e).val(""),r=!0):(i("#"+e).val(""),P=!0):(i("#"+e).val(""),a=!0):(i("#"+e).val(""),t=!0)}}))}(jQuery),Frame.currentNameSpace=Config.snmp;