Utils.$package("Live"),Live=function(m){Frame.isLivePageStartVideo=!0;var a=0,s=0,o=Frame.IsAutoStartVideo,p=0,u=0,t=null,h=null,n=null,l=null,d=!1,r=!1,f=0,c=!0,g=!0,C=!0,b={},v={},e={},S={},I={},P=Capinfo.vehicleRecordOSDArr,V={},y=Capinfo.isSupportCapture&&!Frame.isShowPtzForHTS||Capinfo.isSupportIvaPark,_=Capinfo.isSupportIpcCapture&&!Frame.isShowPtzForHTS,T=Capinfo.isSupportPTZ||Capinfo.isSupportFishEye,L=!1,A=Capinfo.isSupport4KFishEye&&LensPlayMode.PLAYER_FISH_LEFT_4PTZ==Variables.PlayMode,D={},F={},E={},w=!1,M={},R={},k={},N={},B={magnificationSET:["CurrentZoom"]},U={},O=null,x=[],Z={},H={},G=[{fieldId:"rowNum",fieldType:"RowNum"},{fieldId:"PassTime"},{fieldId:"PlateType",hidden:!Capinfo.isSupportHISIParam},{fieldId:"LaneID",hidden:Capinfo.isSupportHISIParam},{fieldId:"CarColor",hidden:!Capinfo.isSupportIvaPark},{fieldId:"PlateColor"},{fieldId:"PlateNum"},{fieldId:"DriveStatusStr",hidden:!Capinfo.isSupportIllegalParam},{fieldId:"Speed",hidden:!Capinfo.isSupportShowSpeed},{fieldId:"trigMode",hidden:!Capinfo.isSupportHISIParam},{fieldId:"PlateWidth",hidden:!Capinfo.isSupportHISIParam},{fieldId:"PicName",hidden:!0},{fieldId:"PicPalateExist",hidden:!0}],z=null,K=[],j=[{fieldId:"StartTime"},{fieldId:"DrivewayID"},{fieldId:"wayState",hidden:!Capinfo.isSupportTrafficFlow},{fieldId:"CarFlow"},{fieldId:"AveSpeed"},{fieldId:"AveHeadTime"},{fieldId:"AveHeadGap"},{fieldId:"AveTimeOcupyRat"},{fieldId:"AveSpaceOcupyRat"},{fieldId:"smallCarFlow"},{fieldId:"SUVFlow"},{fieldId:"VanFlow"},{fieldId:"SmallTruckFlow"},{fieldId:"MidiBusFlow"},{fieldId:"LargeBusFlow"},{fieldId:"BigTruckFlow"}],W=[{fieldId:"StartTime"},{fieldId:"DrivewayID"},{fieldId:"wayState",hidden:!Capinfo.isSupportTrafficFlow},{fieldId:"CarFlow"},{fieldId:"AveSpeed"},{fieldId:"AveHeadTime"},{fieldId:"AveHeadGap",hidden:!Capinfo.isSupportTrafficFlow},{fieldId:"AveTimeOcupyRat"},{fieldId:"AveSpaceOcupyRat",hidden:!Capinfo.isSupportTrafficFlow},{fieldId:"OversizeVehicleFlow",hidden:!Capinfo.isSupportTrafficFlow},{fieldId:"MidsizeSedanFlow",hidden:!Capinfo.isSupportTrafficFlow},{fieldId:"EconomysizeSedanFlow",hidden:!Capinfo.isSupportTrafficFlow}],Y=[{fieldId:"rowNum",fieldType:"RowNum"},{fieldId:"PassTime"},{fieldId:"sex"},{fieldId:"age"},{fieldId:"glasses"},{fieldId:"PicName",hidden:!0},{fieldId:"Time",fieldType:"text",hidden:!0}],X=null,J=[];return new(Class.extend({varRotateSpeed:Video.varRotateSpeed,init:function(){},init2:function(){Utils.beforeDataLoad(),this.initPage(),Utils.initLang(),this.initEvent(),this.initData(),this.initDataView(),Capinfo.isSupportHorizontalMenu&&this.initValidator(),this.resetVideoWH(),Utils.afterDataLoad()},initPage:function(){var e,t=m("#btn_manualSnap"),a=m("#drivewayIDHead"),i=m("#RTStatus"),s=m("#dataViewnew"),o=m(".ptz-acc-header-tab"),n=m("#videoTD"),l=m("#videoBar"),d=m("#ctrlPanel"),r=m("#audioBar");Capinfo.isNoPlugin&&(m("#btn_talk,#btn_areaFocus,#btn_opticsZoom,#btn_manualSnap,#btn_liveSwitch_pic").css("width",0),m("#voiceTalk,#audioBar").addClass("hidden"),r.css("visibility","hidden")),m("#ptzImg").attr("src",ptzSrc[Capinfo.skinType]),top.document.title=m.lang.pub.liveTitle,e='<option value="1" lang="scale_proportion" selected="selected"></option>',Capinfo.isNoPlugin||(e+='<option value="0" lang="scale_full"></option>'),t.attr("data-title",""),Frame.isShowPtzForHTS||!Capinfo.isSupportRealtimeStatus&&!Capinfo.isSupportIvaPark||Capinfo.isSupportHISIParam?i.addClass("hidden"):(i.removeClass("hidden"),i.find(".contentLine").removeClass("RTStatusHeight")),IVAMode.ILLEGAL==Frame.IVAType&&(t.attr("data-title","startManualSnap"),t.removeClass("hidden")),Capinfo.isSupportRectManulTrack&&(t.attr("data-title","startManualTrack"),t.removeClass("hidden")),Capinfo.isSupportPersonPhoto&&(m("#btn_liveSwitchIpc_pic").removeClass("hidden"),Frame.autoSnapStream&&(m("#btn_liveSwitchIpc_pic").removeClass("openIpc_picture").addClass("closeIpc_picture"),m("#captureMode").removeClass("hidden"),n.addClass("videoLeft"),l.addClass("videoLeft"),m("#controlhead").addClass("margin_left_300"),Capinfo.isSupportFaceFeature&&(m("#captureInfoDiv").removeClass("hidden"),n.addClass("faceRecognitionVideoTD"),l.addClass("faceRecognitionPluginbar"),d.addClass("faceRecognitionCtrl"),m("#captureMode").addClass("faceRecognitionPluginbar")))),y||_?(Capinfo.isSupportIvaPark||IVAMode.ILLEGAL==Frame.IVAType||!Capinfo.isSupportTrafficParam||Capinfo.isSupportTrafficFlow||m("#TrafficStatisticPeSpan").removeClass("hidden"),Capinfo.isSupportUsualCapture||(a.removeClass("hidden"),m("#drivewayTheadCol").removeClass("hidden"),m("#drivewayTbodyCol").removeClass("hidden"),Capinfo.isSupportIvaPark?(a.attr("data-lang","CapPortID"),m("#carColorHead").removeClass("hidden"),m("#carColorTheadCol").removeClass("hidden"),m("#carColorTbodyCol").removeClass("hidden")):(Capinfo.isSupportIllegalParam&&(m("#peccancyHead").removeClass("hidden"),m("#peccancyTheadCol").removeClass("hidden"),m("#peccancyTbodyCol").removeClass("hidden")),m("#speedHead").removeClass("hidden"),m("#speedTheadCol").removeClass("hidden"),m("#speedTbodyCol").removeClass("hidden"))),Capinfo.isSupportHISIParam&&(a.addClass("hidden"),m("#speedHead").addClass("hidden"),m("#drivewayTheadCol").addClass("hidden"),m("#drivewayTbodyCol").addClass("hidden"),m("#plateTypeTheadCol").removeClass("hidden"),m("#plateTypeHead").removeClass("hidden"),m("#plateTypeTbodyCol").removeClass("hidden"),m("#triggerModeTheadCol").removeClass("hidden"),m("#triggerModeHead").removeClass("hidden"),m("#triggerModeTbodyCol").removeClass("hidden"),m("#PlateWidthTheadCol").removeClass("hidden"),m("#PlateWidthHead").removeClass("hidden"),m("#PlateWidthTbodyCol").removeClass("hidden"),m("#advancedCfgDiv").removeClass("hidden")),l.remove(),m("#videoBar_traffic").removeClass("hidden"),m("#trafficInfoDiv").removeClass("hidden"),Capinfo.isSupportHISIParam?n.addClass("live-plugins-hisi"):(n.addClass("live-plugins-traffic"),n.addClass("live-plugins-traffic")),i.addClass("realstatus_live"),m("div.realStatusSection").addClass("left"),Capinfo.isSupportTrafficLight&&(i.addClass("realstatus_eplive"),m("#tlStatusDiv").removeClass("hidden"),m("#intelligentLink").attr("href","/page/ITS/operate_epIntelligent.ae0d4dcd.htm")),IVAMode.ILLEGAL!=Frame.IVAType&&!Capinfo.isSupportTrafficFlow||(m("#btn_grabImg").addClass("hidden"),Capinfo.isSupportTrafficFlow&&(m("#openPicPathSpan").addClass("hidden"),m("#dataViewold").addClass("hidden"),s.removeClass("hidden"),i.removeClass("realstatus_live").addClass("realstatus_live_TrafficFlow"),m("#liveBtnBarDiv").removeClass("liveBtnBar").addClass("liveBtnBarTrafficFlow"),m("#traffictLightStatusDiv").removeClass("realStatusPanel").addClass("realStatusPanelTrafficFlow"),m("#photoBtnBarDiv").removeClass("photoBtnBar").addClass("photoBtnBarTrafficFlow"),s.removeClass("dataView").addClass("dataViewTrafficFlow")))):(m("#videoBar_traffic").remove(),l.removeClass("hidden"),n.removeClass("plugin-bar_traffic"),Capinfo.isSupportFishEye||(e+='<option value="2" lang="scale_actual"></option>')),m("#renderScale").append(e),y&&!(1<Capinfo.maxStreamNum)||Capinfo.isSupportFishEye||m("#streamIDDiv").removeClass("hidden"),(y||_)&&(m("#streamIDDiv").addClass("hidden"),IVAMode.ILLEGAL==Frame.IVAType&&m("#btn_grabImg").addClass("hidden")),Capinfo.isSupportAudio&&(r.removeClass("hidden"),Capinfo.isSupportAudioTalk?(m("#btn_talk").removeClass("hidden"),m("#btn_mic_mute").removeClass("hidden"),m("#sliderMic").removeClass("hidden"),y||_||this.disableAudio()):m("#voiceTalk").addClass("hidden")),!(Capinfo.isSupportLens&&!Capinfo.isUnSupportImmutableLens||Capinfo.isSupportABF||T||Capinfo.isSupportFishIpc)||y||_||(Capinfo.isSupportFishIpc||(m("#ctrlPanelBtn_live").removeClass("hidden"),m("#ctrlBody_live").removeClass("hidden")),Capinfo.isSupportFishIpc&&(m("#btn_fishIpc").removeClass("hidden"),m("#ctrlFishBody").removeClass("hidden"),Capinfo.Product4KFishEye?(m("#fishIpcInstallation").remove(),m("#changeRenderScale").addClass("hidden"),m("#lensCtrlPanel").removeClass("hidden"),n.removeClass("video_left_0"),l.removeClass("video_left_0"),m("#controlhead").addClass("margin_left"),m(".fishIpc").remove(),m(".fishIpcDisplayMode").remove()):(m("#lensInstallDiv").remove(),m("#controlhead").removeClass("margin_left"),m(".Lens").remove())),d.removeClass("hidden"),n.removeClass("video_full_w"),l.removeClass("video_full_w"),m("#controlhead").removeClass("margin_right_0"),(Capinfo.isSupportLens||Capinfo.isSupportABF||Capinfo.isSupportMBF)&&(m("#LENSDiv_live").removeClass("hidden"),Capinfo.isSupportLens&&!Capinfo.isUnSupportImmutableLens&&(Capinfo.isSupportFishEye||(m("#focusBtns_live").removeClass("hidden"),Capinfo.isSupportIRIS&&m("#apertureBtns_live").removeClass("hidden")),m("#becomeBtns_live").removeClass("hidden")),Capinfo.isSupportFishEye||Capinfo.isSupportABF&&m("#autobackfocusBtns_live").removeClass("hidden")),Capinfo.isSupport3DAreaZoom&&m("#btn_opticsZoom").removeClass("hidden"),T&&(m("#derectionBtns_live").removeClass("hidden"),Capinfo.isSupportFishEye||(Capinfo.isSupportPeripheralPTZ&&(Capinfo.isSupportInfrare&&m("#infrareBtns_live").removeClass("hidden"),Capinfo.isSupportHeatup&&m("#heatupBtns_live").removeClass("hidden"),Capinfo.isSupportRainbrush&&m("#rainbrushBtns_live").removeClass("hidden"),Capinfo.isSupportIlluminate&&m("#illuminateBtns_live").removeClass("hidden")),Capinfo.isSupportClearSnow&&(m("#clearsnowBtns_live").removeClass("hidden"),Video.changeSweepSnowStatus()),(Capinfo.isSupportPeripheralPTZ||Capinfo.isSupportClearSnow)&&m("#ptzExtend_live").removeClass("hidden"),m("#ptzAccordion").removeClass("hidden")),this.initSliderForSpeed())),UserType.Administrator==top.userType&&(T&&m("#ptzPresetFoot").removeClass("hidden"),m("#imgConfigSpn").removeClass("hidden"),IVADeviceMode.TG!=Capinfo.IVADeviceType&&IVADeviceMode.EP!=Capinfo.IVADeviceType&&IVADeviceMode.PARK!=Capinfo.IVADeviceType&&IVAMode.ILLEGAL!=Frame.IVAType||m("#intelligentLink").parent("span").removeClass("hidden")),Capinfo.isSupportFishEye&&this.initPearlEyePage(),Capinfo.isSupportLiveSwitch&&(m("#btn_liveSwitch_pic").removeClass("hidden"),m("#btn_liveSwitch_live").removeClass("hidden")),Capinfo.isSupportAreaFocus&&m("#btn_areaFocus").removeClass("hidden"),0==o.parent().find(".hidden").length?o.css("width","65px"):o.css("width","98px"),Capinfo.isSupportDigitalZoom&&(m("#frmSetup").removeClass("hidden"),m("#MagnificatSETDiv").removeClass("hidden")),r.is(":visible")&&this.initSliderForVideoObject(),top.sdk_viewer.isInstalled||this.disableAllButtons()},initData:function(){var e,t,a,i={},s=!y&&!_||Capinfo.isSupportTrafficFlow?RunMode.LIVE:RunMode.LIVE_JPEG,o=0;top.sdk_viewer&&top.sdk_viewer.isInstalled&&(a=Video.NetSDKGetFocusWnd(Video),Video.currentWndID=parseInt(a.result)),Capinfo.isSupportFishEye&&PearlEyeLiveMode.PTZ4==Frame.LiveMode&&(s=RunMode.SCREEN_4),A&&(s=RunMode.FISH4K),Capinfo.isSupportHISIParam&&(s=RunMode.HISI4),Utils.resetVideoSize(StreamID.MAIN_VIDEO,"videoTD",!1),0==Video.statusList.length&&(Video.statusList.push(Utils.objectClone(Video.statusMap)),Video.statusList[0].streamID=Frame.DefaultStreamID);var n=m("#streamIDDiv");if(n.is(":visible")){for(m(".plugin-bar-head div").addClass("plugin-bar-head_div"),e=Video.streamNum,t=1;t<e;t++)m(n.find("button").get(t)).removeClass("hidden"),m(n.find(".line").get(t-1)).removeClass("hidden");m(n.find("button").get(t-1)).addClass("last-btn-right"),this.changeStreamBtnStyle(n.find("button[data-value='"+Number(Video.statusList[0].streamID)+"']")[0])}if(Capinfo.isSupportPTZ&&(o=1),Utils.initVideo("videoTD",StreamType.LIVE,s,Video.statusList[0].streamID,!1,this.initVideo_callback,o),!Capinfo.isMac&&y){if(Utils.LAPI_GetCfgData(LAPI_URL.CAMARA_CAPTURE_CFG,i)&&((C=0<(4&Number(i.CapturePeccancyType)))||(s=m.lang.tip.tipNoGrabImg,(o=m("#btn_grabImg")).prop("disabled",!0),o.removeClass().addClass("noGrabImg"),o.attr("title",s))),i={},!Utils.LAPI_GetCfgData(LAPI_URL.PECCANCY_CAPTURE_CFG,F))return;if(IVAMode.ILLEGAL==Frame.IVAType)for(E.IllegalCodeNum=["Nums"],t=0;t<F.Nums;t++)E["IllegalType"+(t+1)]=["ViolationInfo",t,"Type"],E["IllegalCode"+(t+1)]=["ViolationInfo",t,"ViolationCode"],E["IllegalName"+(t+1)]=["ViolationInfo",t,"CustomName"],E["IllegalCodeStr"+(t+1)]=["ViolationInfo",t,"CustomCode"];else for(E.PeccancyTypeNum=["Nums"],t=0;t<F.Nums;t++)E["PeccancyType"+(t+1)]=["ViolationInfo",t,"Type"],E["Enable"+(t+1)]=["ViolationInfo",t,"Enable"],E["PeccancyCode"+(t+1)]=["ViolationInfo",t,"ViolationCode"],E["Priority"+(t+1)]=["ViolationInfo",t,"Level"],E["ProcessNum"+(t+1)]=["ViolationInfo",t,"SnapShots"],E["CustomName"+(t+1)]=["ViolationInfo",t,"CustomName"],E["PeccancyCodeStr"+(t+1)]=["ViolationInfo",t,"CustomCode"];Utils.changeMapToMapByMapping(F,E,i,0),this.changeDataMapToPeccancyMap(i)}if(Capinfo.isSupport4KFishEye){if(!Utils.LAPI_GetCfgData(LAPI_URL.FishEyeCorrectMode,Z,!1))return void Utils.disableAll();H=Utils.objectClone(Z),this.init4KFishStyle()}if(T&&(2==Capinfo.ptzType&&(Frame.initMaxPresetNum(),Video.resetCombox()),this.freshPreset(),cruise.initCruiseInfo()),Capinfo.isSupportTrafficLight&&(i=m("#trafficlight"),Utils.LAPI_GetCfgData(LAPI_URL.DebugEpTmpMsg,M)&&(w=1==M.SimulateRedLight)&&i.removeClass("openTrafficlight").addClass("closeTrafficlight"),this.getTrafficLightColor(),i.removeClass("hidden")),Capinfo.isSupportTrafficFlow&&!Utils.LAPI_GetCfgData("/LAPI/Intelligent/PlateIdentify",D))return Utils.disableAll(),!1;Capinfo.isSupportDigitalZoom&&(Utils.LAPI_GetCfgData(LAPI_URL.ZoomInput,R)&&Utils.LAPI_GetCfgData(LAPI_URL.DigitalZoom,U)?(k=Utils.objectClone(R),Utils.LAPI_CfgToForm("frmSetup",R,N,B)):Utils.disableAll())},initValidator:function(){var e=U.MaxDigitalZoom;m("#magnificationSET").attr("tip",m.validator.format(m.lang.tip.tipNumRange,1,e)),m.validator.addMethod("kepTwoBits",function(e){e=e.split(".");return!(2==e.length&&2<e[1].length)},m.lang.tip.tipKepTwoBits),(t=m("#frmSetup").validate({focusInvalid:!1,errorElement:"span",errorPlacement:function(e,t){Utils.showJqueryErr(e,t,"span")},success:function(e){},rules:{magnificationSET:{required:!0,number:!0,range:[1,e],kepTwoBits:""}}})).init()},initEvent:function(){var e,t,n=document.getElementById("btn_digitalZoom"),r=this,c=!1;window.onresize=this.resetVideoWH,m("#intelligentLink").click(function(){var e=m("#ivaCfgLink");IVAMode.ILLEGAL==Frame.IVAType?(e.attr("data-defaultLink","ivaSceneManagerTab"),Menu.selectItem("ivaSceneManagerTab"),e.trigger("click"),m("#RTStatus").removeClass("hidden")):(IVADeviceMode.PARK==Capinfo.IVADeviceType?(e.attr("data-defaultLink","ivaParkSceneTab"),Menu.selectItem("ivaParkSceneTab")):(e.attr("data-defaultLink","intelligentTab"),Menu.selectItem("intelligentTab")),e.trigger("click"))}),Capinfo.isSupportHISIParam&&(e=screen.width/4,t=screen.height/5,m("#stackAreaEnable").click(function(){m("#stackAreaEnable").is(":checked")?(top.sdk_viewer.execFunctionReturnAll("NetSDKModifyDrawObj",wndIdNum.LIVE,4,0,{ShowObj:1,SelObj:1}),top.sdk_viewer.execFunctionReturnAll("NetSDKModifyDrawObj",wndIdNum.CAPTURESCREEN,4,0,{ShowObj:1})):(top.sdk_viewer.execFunctionReturnAll("NetSDKModifyDrawObj",wndIdNum.LIVE,4,0,{ShowObj:0}),top.sdk_viewer.execFunctionReturnAll("NetSDKModifyDrawObj",wndIdNum.CAPTURESCREEN,4,0,{ShowObj:0}),Utils.liveAddButton(!1))}),m("#openWay").click(function(){Utils.LAPI_SetCfgData(LAPI_URL.OpenWay,{},!1)}),m("#localCfg").click(function(){Utils.openWin(m.lang.pub.LocalCfgTitle,"/page/IA/client_settings.4a09f246.htm",902,488,!1,e,t,!1)}),m("#cfgNetWork").click(function(){Utils.openWin(m.lang.pub.cfgNetWorkTitle,"/page/IA/network_system.945bbd92.htm",902,488,!1,e,t,!1)}),m("#installWizard").bind("click",function(){Utils.openWin(m.lang.pub.installWizard,"/page/ITS/setupGuide.e9366e6c.htm?id=setupGuide",902,488,!1,e,t,!1)}),m("#cancelButton").click(function(){Utils.liveAddButton(!1),Live.initDrawObj()}),m("#cancelBut").click(function(){Utils.liveAddButton(!1,1,1,"testButton","videoContain"),Live.initDrawObj()})),m("#imgConfigLink").click(function(){var e=m("#imgCfgLink");e.attr("data-defaultLink","imgConfigTab"),Menu.selectItem("imgConfigTab"),e.trigger("click"),IVAMode.ILLEGAL==Frame.IVAType&&m("#RTStatus").removeClass("hidden")}),m(".h264").click(function(){var e=m("#videoLink");e.attr("data-defaultLink","videoTab"),Menu.selectItem("videoTab"),e.trigger("click")}),m("#ctrlPanelBtn_live").click(function(){r.toggleCtrlPanel(0)}),m("#btn_fishIpc").click(function(){r.toggleCtrlPanel(1)}),m("#player-top-installation,#player-bottom-installation").click(function(){m(".button-7").removeClass("hidden"),m(".button-5").addClass("hidden"),m("#renderScale").prop("disabled","")}),m("#player-side-installation").click(function(){m(".button-7").addClass("hidden"),m(".button-5").removeClass("hidden"),m("#renderScale").prop("disabled","")}),m(".installMode").bind("click",function(){var e=0,t=m(".installMode");t.each(function(){m(this).hasClass("selected")&&m(this).removeClass("selected")}),m(this).addClass("selected"),t.each(function(){m(this).hasClass("selected")?(m(this).removeClass(this.id).addClass(this.id+"-open"),e=this.value):m(this).removeClass(this.id+"-open").addClass(this.id),r.resetVideoWH()}),m(".playMode").each(function(){m(this).hasClass("selected")&&m(this).removeClass(this.id+"-open").addClass(this.id)}),m("#player-original").removeClass("player-original").addClass("player-original-open");for(var a=!1,i=0;i<Video.statusList.length;i++)if(Video.statusList[i].isVideoOpen){a=!0;break}top.sdk_viewer&&top.sdk_viewer.isInstalled&&a&&(n.disabled=!1,n.className="openDigitalZoom"),Video.NetSDKSetPtzAndFixMode(top,0,0,Number(e))}),m(".playMode").bind("click",function(){var e=0,t=0,a=m(".playMode"),i=m("#renderScale");if(a.each(function(){m(this).hasClass("selected")&&m(this).removeClass("selected")}),m(this).addClass("selected"),a.each(function(){m(this).hasClass("selected")?(m(this).removeClass(this.id).addClass(this.id+"-open"),t=this.value):m(this).removeClass(this.id+"-open").addClass(this.id)}),m(".installMode").each(function(){m(this).hasClass("selected")&&(e=this.value)}),m(".lensInstallMode").each(function(){m(this).hasClass("selected")&&(e=this.value)}),0!=Number(t))i.val(0),r.changeRenderScale(),i.prop("disabled","disabled"),n.className="noDigitalZoom",n.title=m.lang.pub.startDigitalZoom,n.disabled=!0,Video.isDigitalZoom&&(Video.isDigitalZoom=!Video.isDigitalZoom,Video.NetSDKDigitalZoom(top,0,0));else{Capinfo.isSupport4KFishEye&&(m("#renderScale").val(1),r.changeRenderScale());for(var s=!1,o=0;o<Video.statusList.length;o++)if(Video.statusList[o].isVideoOpen){s=!0;break}top.sdk_viewer.isInstalled&&s&&(n.disabled=!1,n.className="openDigitalZoom"),i.prop("disabled","")}Capinfo.isSupport4KFishEye&&(1==e?e=0:0==e&&(e=1)),Video.NetSDKSetPtzAndFixMode(top,0,Number(t),Number(e))}),m("a.ptz-acc-header-tab").click(function(){m("a.ptz-acc-header-tab").removeClass("ptz-acc-header-tab-selected"),m(this).addClass("ptz-acc-header-tab-selected"),"presetTab"==this.id?(m("#ptzCmdBody").addClass("hidden"),m("#ptzPresetBody").removeClass("hidden"),m("#ptzCruiseBody").addClass("hidden"),UserType.Administrator==top.userType&&m("#ptzPresetFoot").removeClass("hidden"),m("#record").addClass("hidden"),m("#plan").addClass("hidden"),r.freshPreset()):"cmdTab"==this.id?(m("#ptzCmdBody").removeClass("hidden"),m("#ptzPresetBody").addClass("hidden"),m("#ptzCruiseBody").addClass("hidden"),m("#ptzPresetFoot").addClass("hidden"),m("#record").addClass("hidden"),m("#plan").addClass("hidden")):(m("#ptzCmdBody").addClass("hidden"),m("#ptzPresetBody").addClass("hidden"),m("#ptzCruiseBody").removeClass("hidden"),UserType.Administrator==top.userType&&m("#ptzPresetFoot").removeClass("hidden"),m("#plan").removeClass("hidden"),Capinfo.isSupportTrackRecord&&m("#record").removeClass("hidden"))}),m(".lensPlayMode").bind("click",function(){var e,t,a=y||_?RunMode.LIVE_JPEG:RunMode.LIVE,s=null,o=Number(Capinfo.isSupportPTZ),n=Number(this.value),l=m("#btn_stop").hasClass("stopPlay"),d=!0;if(Z.StreamMode=n,(c=Utils.isObjectEquals(Z,H))||(u=1,d=Utils.LAPI_SetCfgData(LAPI_URL.FishEyeCorrectMode,Z,!1,r.fishModeCalllBack)),(0==u&&0==p||!c)&&d){if(H=Utils.objectClone(Z),Variables.PlayMode=Z.StreamMode,l)for(i=0;i<Video.statusList.length;i++)Video.stopVideo(StreamType.LIVE,i);if(LensPlayMode.PLAYER_PANORAMA==Variables.PlayMode)Video.currentWndID=0,Video.NetSDKSetWndPos(top,0),Frame.DefaultStreamID=7,Video.statusList=[],Video.statusList.push(Utils.objectClone(Video.statusMap)),Video.statusList[0].streamID=7;else if(LensPlayMode.PLAYER_FISH_LEFT_4PTZ==Variables.PlayMode)for(e in Video.NetSDKSetWndPos(top,4),top.sdk_viewer&&top.sdk_viewer.isInstalled&&(l=Video.NetSDKGetFocusWnd(top),Video.currentWndID=parseInt(l.result)),Frame.DefaultStreamID=1,t=Variables.Fish4PTZMap,Video.statusList=[],t)(s={isVideoOpen:!1,bRecEnabled:!1,streamID:0}).streamID=t[e],Video.statusList.push(s);else Frame.DefaultStreamID=0,Video.currentWndID=0,Video.NetSDKSetWndPos(top,0),Video.statusList=[],Video.statusList.push(Utils.objectClone(Video.statusMap)),Video.statusList[0].streamID=0;(A=Capinfo.isSupport4KFishEye&&LensPlayMode.PLAYER_FISH_LEFT_4PTZ==Variables.PlayMode)&&(a=RunMode.FISH4K),Frame.IsAutoStartVideo&&Utils.initVideo("videoTD",StreamType.LIVE,a,Video.statusList[0].streamID,!1,r.initVideo_callback,o),p=1,r.init4KFishStyle()}}),m(".lensInstallMode").bind("click",function(){var e=Number(this.value);Z.InstallMode=e,(c=Utils.isObjectEquals(Z,H))||(Utils.LAPI_SetCfgData(LAPI_URL.FishEyeCorrectMode,Z,!1,r.fishModeCalllBack)&&(H=Utils.objectClone(Z),r.init4KFishStyle()),LensPlayMode.PLAYER_ORIGINAL==Capinfo.PlayMode&&(1==e?e=0:0==e&&(e=1),Video.NetSDKSetPtzAndFixMode(top,0,0,e)))}),m("#centerBtn_live").click(function(){Utils.submitCtrolCmd(PtzTurnAroundVal[f++%4],Live.varRotateSpeed,Live.varRotateSpeed)}),m("#addPTZPreset").bind("click",function(){cruise.currentCruiseOperate=0,m("#ptzPresetBody").is(":visible")?Utils.openWin(m.lang.pub.cruisePresetPosAdd,"/page/common/preset_edit.801a4356.htm",400,195,!1,"70%","60%",!0,"body"):Utils.openWin(m.lang.pub.trackAdd,"/page/common/cruise_edit.262bbffa.htm?id=cruise_edit",750,500,!1,"40%","25%",!0,"body")}),m("#record").bind("click",function(){cruise.recordTrack()}),m("#plan").bind("click",function(){Utils.openWin(m.lang.pub.trackPlan,"/page/common/cruise_plan.ea7e0418.htm?id=cruise_plan",680,430,!1,"40%","25%",!0,"body")}),m("#ptzExtend_live").find("button").bind("click",function(){Utils.submitCtrolCmd(Number(m(this).attr("data-cmd")))}),m("#clearsnowBtns_live").find("button").bind("click",function(){Video.sweepSnow(Number(m(this).attr("data-cmd")))}),m("#streamIDDiv").find(".streamBtn").bind("click",function(){for(var e,t,a,i=m("#streamIDDiv"),s=i.find(".selected").length,o=(m("#btn_fishIpc"),0);o<s;o++)if(""!=m(i.find(".selected")[o]).attr("id")){t=m(i.find(".selected")[o]).attr("id");break}e=(a=m(this).hasClass("btn_l")?m(this).next()[0]:m(this).hasClass("btn_r")?(undefined==m(this).parent().find(".hidden")[0]?m(this):m(m(this).parent().find(".hidden")[0])).prev()[0]:this).id,L||e==t||(L=!0,r.changeStreamBtnStyle(a),r.chooseStream(e))}),m(".mousepointer").bind("click",function(){var e=this.id,t=m("div.menu-content li.menu-active").attr("id");L||e==t||(L=!0,r.changeFishEyeModeStyle(e),r.chooseStream(e))}),m("#trafficlight").bind("click",function(){M.SimulateRedLight=w?0:1,Utils.LAPI_SetCfgData(LAPI_URL.DebugEpTmpMsg,M,!1)&&((w=!w)?m("#trafficlight").removeClass("openTrafficlight").addClass("closeTrafficlight"):m("#trafficlight").removeClass("closeTrafficlight").addClass("openTrafficlight"))}),m("#openPicPath").bind("click",function(){var e=Video.NetSDKGetDefaultPath(top);ResultCode.RESULT_CODE_SUCCEED==e.code&&(e=e.result+"JPEG",top.sdk_viewer.execFunction("NetSDKOpenFloder",e))}),m("#TrafficStatisticPe").bind("click",function(){m(".dataViewold").addClass("hidden"),m(".dataViewnew").removeClass("hidden"),m(".TrafficStatisticPe").addClass("hidden"),m(".capturePhoto").removeClass("hidden")}),m("#capturePhoto").bind("click",function(){m(".dataViewold").removeClass("hidden"),m(".dataViewnew").addClass("hidden"),m(".TrafficStatisticPe").removeClass("hidden"),m(".capturePhoto").addClass("hidden")}),m("#clearCarInfo").bind("click",this.clearCarRecord),m("#advanced_Cfg").click(function(){Utils.openWin(m.lang.pub.advancedCfg,"/page/ITS/advanced_Cfg.10cc50fc.htm",902,488,!1,e,t,!1)}),m("#autobackfocusStart_live").bind("click",function(){Video.startAutoBackFocus()}),m("#autobackfocusPosition_live").bind("click",function(){Video.restoreABFPosition()}),this.bindPtzDerectEvent(PtzDerectMap),this.bindPtzLensEvent(PtzLensMap),this.bindManualBackFocusNear(),this.bindManualBackFocusFar(),m("#magnificationSET").bind("change",function(){r.submitF()}),m(".plugin-bar a,.plugin-bar button,#HISIStatusDiv button").hover(function(){m(this)[0].disabled||m(this).addClass("barHover")},function(){m(this).removeClass("barHover")}),m("#OpenImg").bind("click",function(){r.FindSnapImg()}),m("#deleteAll").bind("click",function(){r.ClearSnapImg()})},changeOverride:function(){var e;Capinfo.isSupportHorizontalMenu&&(Utils.LAPI_GetCfgData(LAPI_URL.ZoomInput,R)?(e=R.CurrentZoom,m("#magnificationSET").val(e)):Utils.disableAll())},submitLiveArea:function(){!m.isEmptyObject(v)&&S&&Utils.LAPI_GetCfgData(LAPI_URL.PlateIdentify,I)&&(S.Area[0].Point[0].X=v.PointX0,S.Area[0].Point[0].Y=v.PointY0,S.Area[0].Point[1].X=v.PointX1,S.Area[0].Point[1].Y=v.PointY1,S.Area[0].Point[2].X=v.PointX2,S.Area[0].Point[2].Y=v.PointY2,S.Area[0].Point[3].X=v.PointX3,S.Area[0].Point[3].Y=v.PointY3,Utils.LAPI_SetCfgData(LAPI_URL.DETECTAREA_CFG,S,!1),Utils.LAPI_SetCfgData(LAPI_URL.PlateIdentify,I)),Utils.liveAddButton(!1)},submitSetupArea:function(){!m.isEmptyObject(v)&&S&&Utils.LAPI_GetCfgData(LAPI_URL.PlateIdentify,I)&&(S.Area[0].Point[0].X=v.PointX0,S.Area[0].Point[0].Y=v.PointY0,S.Area[0].Point[1].X=v.PointX1,S.Area[0].Point[1].Y=v.PointY1,S.Area[0].Point[2].X=v.PointX2,S.Area[0].Point[2].Y=v.PointY2,S.Area[0].Point[3].X=v.PointX3,S.Area[0].Point[3].Y=v.PointY3,Utils.LAPI_SetCfgData(LAPI_URL.DETECTAREA_CFG,S,!1),Utils.LAPI_SetCfgData(LAPI_URL.PlateIdentify,I)),Utils.liveAddButton(!1,1,1,"testButton","videoContain")},submitF:function(){var e;t.form()&&(Utils.LAPI_FormToCfg("frmSetup",R,N,B),(e=!Utils.isObjectEquals(R,k))?e&&Utils.LAPI_SetCfgData(LAPI_URL.ZoomInput,R)&&(k=Utils.objectClone(R)):parent.status=m.lang.tip.tipAnyChangeInfo)},release:function(){for(var e=m("#RTStatus"),t=0;t<Video.statusList.length;t++)Capinfo.isSupportFishEye||Frame.DefaultStreamID!=Video.statusList[t].streamID||Video.statusList[t].bRecEnabled&&Video.stopStorage(t);Capinfo.isSupportHISIParam&&(top.sdk_viewer.execFunctionReturnAll("NetSDKModifyDrawObj",wndIdNum.LIVE,4,0,{ShowObj:0}),top.sdk_viewer.execFunctionReturnAll("NetSDKModifyDrawObj",wndIdNum.CAPTURESCREEN,4,0,{ShowObj:0}),Video.sdk_viewer.execFunctionReturnAll("NetSDKEnableDraw",wndIdNum.LIVE,0,0,1,0,30),Video.sdk_viewer.execFunctionReturnAll("NetSDKEnableDraw",wndIdNum.CAPTURESCREEN,0,0,1,0,30),Utils.liveAddButton(!1)),Frame.hiddenVideo(),Frame.DefaultStreamID!=Video.statusList[0].streamID&&Capinfo.isSupportHorizontalMenu&&(Video.statusList[0]=Utils.objectClone(Video.statusMap),Video.statusList[0].streamID=Frame.DefaultStreamID),(y||_)&&(m("#RTStatus").removeClass("realstatus_eplive").removeClass("realstatus_live").removeClass("realstatus_live_TrafficFlow"),m("div.realStatusSection").removeClass("left")),T&&(Video.varRotateSpeed=this.varRotateSpeed),m("#audioBar").is(":visible")&&(top.pcVolume=h.GetValue(),m("#btn_mic_mute").is(":visible")&&(top.pcMicVolume=n.GetValue())),this.stopMutexFunc(),window.onresize=null,g=!1,Video.currentWndID=0,Capinfo.isSupport4KFishEye&&Variables.PlayMode!=LensPlayMode.PLAYER_ORIGINAL&&(Frame.DefaultStreamID=1),Capinfo.isSupportPersonPhoto&&Frame.autoSnapStream&&(Video.sdk_viewer.execFunctionReturnAll("NetSDKCloseStream",2),Video.sdk_viewer.execFunctionReturnAll("NetSDKFreeLocalPort",2),Video.isCaptureOpen=!1),Frame.isLivePageStartVideo=!1,m("#RTStatus .contentLine").addClass("RTStatusHeight"),Capinfo.isSupportRealtimeStatus&&(Frame.isShowPtzForHTS||Capinfo.isSupportIpcCapture)&&e.addClass("hidden")},disableAllButtons:function(){var e=m("#btn_areaFocus"),t=m("#audioBar");document.getElementById("btn_grabImg")&&(document.getElementById("btn_grabImg").disabled=!0,document.getElementById("btn_grabImg").className="noGrabImg"),document.getElementById("btn_prScrn").disabled=!0,document.getElementById("btn_prScrn").className="noSnapshot",document.getElementById("btn_stop").disabled=!0,document.getElementById("btn_stop").className="noPlay",document.getElementById("btn_record").disabled=!0,document.getElementById("btn_record").className="noRecord",m("#btn_talk").hasClass("hidden")||(document.getElementById("btn_talk").disabled=!0,document.getElementById("btn_talk").className="noTalk"),m("#btn_digitalZoom").hasClass("hidden")||(document.getElementById("btn_digitalZoom").disabled=!0,document.getElementById("btn_digitalZoom").className="noDigitalZoom"),m("#btn_opticsZoom").hasClass("hidden")||(document.getElementById("btn_opticsZoom").disabled=!0,document.getElementById("btn_opticsZoom").className="noOpticsZoom"),m("#btn_manualSnap").hasClass("hidden")||(document.getElementById("btn_manualSnap").disabled=!0,document.getElementById("btn_manualSnap").className="noManualSnap"),m("#btn_liveSwitchIpc_pic").hasClass("hidden")||(document.getElementById("btn_liveSwitchIpc_pic").disabled=!0,document.getElementById("btn_liveSwitchIpc_pic").className="noIpc_picture"),document.getElementById("btn_mute").disabled=!0,document.getElementById("btn_mute").className="noAdjustVoice",document.getElementById("btn_mic_mute").disabled=!0,document.getElementById("btn_mic_mute").className="noMicVoice",e.hasClass("hidden")||e.prop("disabled",!0).removeClass().addClass("noAreaFocus"),t.is(":visible")&&(document.getElementById("sliderVolume").className="slider4",document.getElementById("barVolume").className="bar3 bar4",h.setEnable(!1),document.getElementById("sliderMic").className="slider4",document.getElementById("barMic").className="bar3 bar4",n.setEnable(!1)),m("#LiveStreamTyp").prop("disabled",!0),document.getElementById("btn_fullScreen").disabled=!0,document.getElementById("btn_fullScreen").className="fullscreen_black_disable",document.getElementById("OpenImg").disabled=!0},initSliderForVideoObject:function(){var a=this;this.showMuteVoiceCss(),(h=new Slider("sliderVolume","barVolume",{onMove:function(){},showTip:!0})).MinValue=parseInt("0",10),h.MaxValue=parseInt("255",10),h.onMove(),h.onMove=function(){var e,t;c&&(top.pcVolume=this.GetValue(),Video.setAdjustVolume(this.GetValue())||(e=0,t=Video.NetSDKGetVolume(top,0),ResultCode.RESULT_CODE_SUCCEED==t.code&&(e=t.result),isNaN(e)&&(e=0),c=!1,h.SetValue(e),top.pcVolume=e,c=!0),1==Video.isVoiceMute&&(Video.setSilenceStatus(1),a.showMuteVoiceCss()))},this.showMuteMicCss(),n=new Slider("sliderMic","barMic",{onMove:function(){},showTip:!0}),0==Video.isVoiceTalkOpen?(document.getElementById("btn_mic_mute").disabled=!0,n.setEnable(!1)):(document.getElementById("btn_mic_mute").disabled=!1,n.setEnable(!0)),n.MinValue=parseInt("0",10),n.MaxValue=parseInt("255",10),n.onMove(),n.onMove=function(){var e,t;c&&Video.isVoiceTalkOpen&&(Video.setMicVolume(this.GetValue(),!1)?(a.showMuteMicCss(),top.pcMicVolume=this.GetValue()):(e=0,t=Video.NetSDKGetMicVolume(Video,0),ResultCode.RESULT_CODE_SUCCEED==t.code&&(e=t.result),isNaN(e)&&(e=0),c=!1,n.SetValue(e),top.pcMicVolume=e,c=!0))}},initSliderForVideoData:function(){var e,t=0;Capinfo.isMac?Video.statusList[0].isVideoOpen?(e=Video.NetSDKGetVolume(top,0),ResultCode.RESULT_CODE_SUCCEED==e.code&&(t=e.result)):(Video.NetSDKGetLocalPort(top,0),e=Video.NetSDKGetVolume(top,0),ResultCode.RESULT_CODE_SUCCEED==e.code&&(t=e.result),Video.NetSDKFreeLocalPort(top,0)):t="undefined"==typeof top.pcVolume?255:top.pcVolume,this.showMuteVoiceCss(),c=!1,h.SetValue(t),top.pcVolume=t,c=!0;t=0,t="undefined"!=typeof top.pcMicVolume&&Video.isVoiceTalkOpen?top.pcMicVolume:255;n.SetValue(t),top.pcMicVolume=t},initSliderForSpeed:function(){(l=new Slider("rotateSpeedSld_live","rotateSpeedBar_live",{onMove:function(){c&&(Live.varRotateSpeed=Math.round(this.GetValue()))},Horizontal:!1,showTip:!0})).MinValue=1,l.MaxValue=9,c=!1,l.SetValue(Live.varRotateSpeed),c=!0},createEmptyString:function(e){for(var t=[],a=0;a<e;a++)t[a]="*";return t.join("")},refreshRenderScaleByRunMode:function(){var e;top.sdk_viewer&&top.sdk_viewer.isInstalled?(e=Video.NetSDKGetOCXRendScale(Video),Video.cur_scale=e.result):Video.cur_scale=1},changeDataMapToPeccancyMap:function(e){for(var t,a,i=IVAMode.ILLEGAL==Frame.IVAType?Number(e.IllegalCodeNum):Number(e.PeccancyTypeNum),s=!1,o=1;o<=i;o++)t=IVAMode.ILLEGAL==Frame.IVAType?e["IllegalType"+o]:e["PeccancyType"+o],a=IVAMode.ILLEGAL==Frame.IVAType?e["IllegalCodeStr"+o]:e["PeccancyCodeStr"+o],0!=Number(e["Enable"+o])&&("undefined"==typeof b[a]?b[a]=t:"16"==t||"32"==t||"4096"==t?s=!0:"128"!=t&&"16777216"!=t&&"262144"!=t&&"33554432"!=t&&"67108864"!=t&&"16384"!=t&&"134217728"!=t&&"268435456"!=t&&"536870912"!=t&&"1073741824"!=t&&"524288"!=t||(b[a]=128));for(a in b)"16"!=(t=b[a])&&"32"!=t&&"4096"!=t||!s?IVAMode.ILLEGAL==Frame.IVAType?b[a]=m.lang.pub[peccancyIllegalIVAMap[t]]:b[a]=m.lang.pub[peccancyMap[t]]:b[a]=m.lang.pub.disobeyBan},initVideo_callback:function(e,t,a){var i=y||_||Capinfo.isSupportPersonPhoto?0:Video.currentWndID;m("#audioBar").is(":visible")&&top.sdk_viewer&&top.sdk_viewer.isInstalled&&Live.initSliderForVideoData(),Capinfo.isSupportFishEye?m(".mousepointer").each(function(){if(!m(this).hasClass("hidden"))return m(this).trigger("click"),!1}):top.sdk_viewer&&top.sdk_viewer.isInstalled&&((y||_||Capinfo.isSupportPersonPhoto&&Frame.autoSnapStream&&Frame.isLivePageStartVideo)&&!Video.isCaptureOpen&&Video.startJpeg(),Capinfo.isSupportHISIParam&&(o?(Live.initDrawObj(),m("#stackAreaEnable").prop("disabled",!1)):m("#stackAreaEnable").prop("disabled",!0),Utils.liveAddButton(!1),Live.showLevelLine(),Live.showRadarLine())),Live.changeVideoBtnByVideoType(i),Live.refreshRenderScaleByRunMode(),Capinfo.isNoPlugin?m("#renderScale").val(Video.cur_scale):m("#renderScale").val(0),Live.changeRenderScale(),0<P.length&&Utils.LAPI_GetCfgData(LAPI_URL.IVA_EVIDENCE_OSD_CFG+"?BaseCfgType=0",V)&&(i=V.OSDBaseCFG.Mode,top.sdk_viewer.isInstalled&&top.sdk_viewer.execFunctionReturnAll("NetSDKSetOSDStyle",2,i))},initDrawObj:function(){Video.sdk_viewer.execFunctionReturnAll("NetSDKEnableDraw",wndIdNum.LIVE,1,1,1,0,30),Video.sdk_viewer.execFunctionReturnAll("NetSDKEnableDraw",wndIdNum.CAPTURESCREEN,1,0,1,0,30),Utils.LAPI_GetCfgData(LAPI_URL.DETECTAREA_CFG,S)&&(e.PointX0=S.Area[0].Point[0].X,e.PointY0=S.Area[0].Point[0].Y,e.PointX1=S.Area[0].Point[1].X,e.PointY1=S.Area[0].Point[1].Y,e.PointX2=S.Area[0].Point[2].X,e.PointY2=S.Area[0].Point[2].Y,e.PointX3=S.Area[0].Point[3].X,e.PointY3=S.Area[0].Point[3].Y,e.LineColor=16776960,e.LineWidth=3,e.ModifyLimit=1,e.MinWidthLimit=20,e.MaxWidthLimit=100,e.MinHeightLimit=20,e.MaxHeightLimit=50,e.RedrawAble=0,e.ButtonLink=1,v.Right=e.PointX3,v.Bottom=e.PointY3),top.sdk_viewer.execFunctionReturnAll("NetSDKAddDrawObj",wndIdNum.LIVE,4,0,e),top.sdk_viewer.execFunctionReturnAll("NetSDKAddDrawObj",wndIdNum.CAPTURESCREEN,4,0,e)},showLevelLine:function(){var e={};Video.sdk_viewer.isInstalled&&(e.LineColor=8421631,e.LineWidth=3,e.AreaID=1,e.AreaType=6,e.PointX0=99,e.PointY0=6666,e.PointX1=9900,e.PointY1=6666),Video.sdk_viewer.execFunctionReturnAll("NetSDKAddDrawObj",wndIdNum.LIVE,0,19,e)},showRadarLine:function(){var e={};Video.sdk_viewer.isInstalled&&(e.LineColor=16744448,e.LineWidth=3,e.Left=2806,e.Top=6666,e.Right=7191,e.Bottom=8526),Video.sdk_viewer.execFunctionReturnAll("NetSDKAddDrawObj",wndIdNum.LIVE,2,2,e)},initCmdRelationTable:function(){var e,t,a=m("#ptzCmdBody");for(a.empty(),e=0;e<29;e++)t=m.lang.pub["cmdName"+e],t="<div class='ptz-acc-item'><div class='mid_right'><button class='icon start' hidefocus='true' data-cmd='"+e+"' onclick='submitCtrolCmd(0x9000 + "+e+");' title='"+m.lang.pub.start+"'></button></div><span class='ptz-acc-span' title='"+t+"'>"+t+"</span></div>",a.append(t)},startstopVideo:function(){y||_||Video.wndID;var e,t=document.getElementById("msgObj"),a=0,i=m("#btn_stop").hasClass("stopPlay");if((top.sdk_viewer.isInstalled||Capinfo.isNoPlugin)&&(!Capinfo.isNoPlugin||1==Video.StreamInfoChangeList[Video.statusList[0].streamID].EncodeFormat)){if(Frame.IsAutoStartVideo=!i,Capinfo.isSupportFishIpc&&Capinfo.isSupport4KFishEye&&LensPlayMode.PLAYER_ORIGINAL==Variables.PlayMode&&this.resetFish(),i)if(Capinfo.isSupportHISIParam)o=!0,recode=top.sdk_viewer.execFunctionReturnAll("NetSDKLivePause",0,1);else for(e=0;e<Video.statusList.length;e++)Video.stopVideo(StreamType.LIVE,e);else if(Capinfo.isSupportPTZ&&(a=1),Capinfo.isSupportHISIParam&&o)recode=top.sdk_viewer.execFunctionReturnAll("NetSDKLivePause",0,0);else{for(o=!0,e=0;e<Video.statusList.length;e++)Video.startVideo(Video.statusList[e].streamID,!0,e,a,!0);Capinfo.isSupportHISIParam&&(this.initDrawObj(),Live.showLevelLine(),Live.showRadarLine(),m("#stackAreaEnable").prop("disabled",!1),Utils.liveAddButton(!1),t&&top.sdk_viewer.execFunctionReturnAll("NetSDKModifyDrawObj",wndIdNum.LIVE,4,0,{ShowObj:1,SelObj:1}))}i=Number(!i),this.eventNetStreamRst(i)}},init4KFishStyle:function(){var e,t,a=m("#streamIDDiv");if(m(".lensInstallMode").each(function(){m(this).hasClass("selected")&&(m(this).removeClass("selected"),m(this).removeClass(this.id+"-open").addClass(this.id))}),m(".lensInstallMode[value="+Z.InstallMode+"]").addClass("selected"),m(".lensInstallMode").each(function(){m(this).hasClass("selected")&&m(this).removeClass(this.id).addClass(this.id+"-open")}),m(".lensPlayMode").each(function(){m(this).hasClass("selected")&&(m(this).removeClass("selected"),m(this).removeClass(this.id+"-open").addClass(this.id))}),m(".lensPlayMode[value="+Z.StreamMode+"]").addClass("selected"),m(".lensPlayMode").each(function(){m(this).hasClass("selected")&&(m(this).removeClass(this.id).addClass(this.id+"-open"),0==p&&m("#"+this.id).trigger("click"))}),LensPlayMode.PLAYER_ORIGINAL==Variables.PlayMode){for(m("#ctrlFishBody").removeClass("hidden"),m("#btn_fishIpc").hasClass("nocloseFishIpc")&&m("#btn_fishIpc").removeClass("nocloseFishIpc").addClass("closeFishIpc"),Video.getVideoFormat(),document.getElementById("btn_fishIpc").disabled=!1,e=0;e<3&&0!=Number(Video.StreamInfoChangeList[e].IsEnable);e++);if(0<e){for(a.removeClass("hidden"),t=1;t<e;t++)m(a.find("button").get(t)).removeClass("hidden"),m(a.find(".line").get(t-1)).removeClass("hidden");a.find("button").each(function(){m(this).hasClass("last-btn-right")&&m(this).removeClass("last-btn-right")}),m(a.find("button").get(t-1)).addClass("last-btn-right"),this.changeStreamBtnStyle(a.find("button[data-value='"+Number(Video.statusList[0].streamID)+"']")[0])}m(".lensInstallMode").each(function(){m(this).hasClass("selected")&&m("#"+this.id).trigger("click")})}else LensPlayMode.PLAYER_PANORAMA==Variables.PlayMode?m("#renderScale").val(0):m("#renderScale").val(1),this.changeRenderScale(),m("#ctrlFishBody").addClass("hidden"),m("#btn_fishIpc").hasClass("openFishIpc")&&this.toggleCtrlPanel(1),document.getElementById("btn_fishIpc").className="nocloseFishIpc",document.getElementById("btn_fishIpc").disabled=!0,m("#streamIDDiv").addClass("hidden")},resetFish:function(){var e=document.getElementById("btn_digitalZoom");m(".installMode").each(function(){m(this).hasClass("selected")&&(m(this).removeClass("selected"),m(this).removeClass(this.id+"-open").addClass(this.id))}),Capinfo.isSupport4KFishEye||(m("#player-top-installation").removeClass("player-top-installation").addClass("player-top-installation-open").addClass("selected"),m(".button-7").removeClass("hidden"),m(".button-5").addClass("hidden")),m(".playMode").each(function(){m(this).hasClass("selected")&&(m(this).removeClass("selected"),m(this).removeClass(this.id+"-open").addClass(this.id))}),m("#player-original").removeClass("player-original").addClass("player-original-open").addClass("selected");for(var t=!1,a=0;a<Video.statusList.length;a++)if(Video.statusList[a].isVideoOpen){t=!0;break}Video.sdk_viewer.isInstalled&&t&&(e.disabled=!1,e.className="openDigitalZoom"),Capinfo.isSupport4KFishEye&&(m("#renderScale").val(1),this.changeRenderScale()),m("#renderScale").prop("disabled","")},startstopTalk:function(){Video.isVoiceTalkOpen?Video.stopVoiceTalk():Video.startVoiceTalk();var e=Video.isVoiceTalkOpen?1:0;Video.isVoiceTalkOpen?(document.getElementById("btn_mic_mute").disabled=!1,n.setEnable(!0)):(document.getElementById("btn_mic_mute").disabled=!0,n.setEnable(!1)),this.eventVoiceTalkRst(e)},showMuteVoiceCss:function(){Video.isVoiceMute?(m("#btn_mute").removeClass("openAdjustVoice").addClass("closeAdjustVoice"),m("#sliderVolume").removeClass("slider3").addClass("slider4"),m("#barVolume").addClass("bar4"),document.getElementById("btn_mute").title=m.lang.pub.audioOn):(m("#btn_mute").removeClass("closeAdjustVoice").addClass("openAdjustVoice"),m("#sliderVolume").removeClass("slider4").addClass("slider3"),m("#barVolume").removeClass("bar4"),document.getElementById("btn_mute").title=m.lang.pub.audioOff)},showMuteMicCss:function(){Video.isMicMute?(m("#btn_mic_mute").removeClass("openMicVoice").addClass("noMicVoice"),m("#sliderMic").removeClass("slider3").addClass("slider4"),m("#barMic").addClass("bar4"),document.getElementById("btn_mic_mute").title=m.lang.pub.audioOn):(m("#btn_mic_mute").removeClass("noMicVoice").addClass("openMicVoice"),m("#sliderMic").removeClass("slider4").addClass("slider3"),m("#barMic").removeClass("bar4"),document.getElementById("btn_mic_mute").title=m.lang.pub.audioOff)},muteVoice:function(){var e=Video.isVoiceMute?0:1;Video.setSilenceStatus(e),this.showMuteVoiceCss(),0==e?h.setEnable(!0):h.setEnable(!1)},muteMic:function(){Video.setMicVolume(n.GetValue(),!0),this.showMuteMicCss()},startStopRecord:function(){for(var e="undefined"==typeof Video.currentWndID?0:Video.currentWndID,t=0;t<Video.statusList.length;t++)Video.statusList[t].bRecEnabled&&e!=t&&Video.stopStorage(t);var a=-1,a=VideoType.LIVE==top.VideoType?(Video.statusList[e].bRecEnabled?Video.stopStorage(e):Video.startStorage(e),Video.statusList[e].bRecEnabled?1:0):(Video.autoSaveGrabImg(),Video.isCapRecEnabled?1:0);this.eventStorageRst(a)},liveSwitch:function(){Frame.isShowPtzForHTS=!Frame.isShowPtzForHTS,(y||_)&&(m("#RTStatus").removeClass("realstatus_eplive").removeClass("realstatus_live").removeClass("realstatus_live_TrafficFlow"),m("div.realStatusSection").removeClass("left")),Utils.loadHtml("configContainer","/page/common/live_video.ff132db7.htm")},eventAreaFoucs:function(e){var t=m.parseJSON(e),e={};Video.isAreaFocus?(e.TopLeft={},e.BotRight={},e.TopLeft.X=Number(t.left),e.TopLeft.Y=Number(t.top),e.BotRight.X=Number(t.right),e.BotRight.Y=Number(t.bottom),Utils.LAPI_SetCfgData(LAPI_URL.AreaFocus,e,!1)):Video.isManualSnap&&(e.PeccancyType=0,e.SnapSrc=0,e.MarkArea={},e.MarkArea.TopLeft={},e.MarkArea.BotRight={},e.MarkArea.TopLeft.X=Number(t.left),e.MarkArea.TopLeft.Y=Number(t.top),e.MarkArea.BotRight.X=Number(t.right),e.MarkArea.BotRight.Y=Number(t.bottom),Utils.LAPI_SetCfgData(LAPI_URL.IVAManualSnapObjMark,e,!1))},event3DPosition:function(e){var t=m.parseJSON(e),e={};Video.isOpticsZoom&&(e.CenterPointX=Number(t.usMidPointX),e.CenterPointY=Number(t.usMidPointY),e.LengthX=Number(t.usLengthX),e.LengthY=Number(t.usLengthY),e.Width=Number(t.usWidth),e.Height=Number(t.usHeight),t=Number(t.usPtzZoomType),PostionMode.PositionOut==t||PostionMode.Positionlocation==t?Utils.LAPI_SetCfgData(LAPI_URL.AreaZoomIn,e,!1):PostionMode.PositionIn==t&&Utils.LAPI_SetCfgData(LAPI_URL.AreaZoomOut,e,!1))},stopMutexFunc:function(){Video.isDigitalZoom&&this.ditigalZoom(),(Video.isManualSnap||Video.isManualTrack)&&this.manualSnap(),Video.isOpticsZoom&&this.opticsZoom(),Video.isAreaFocus&&this.areaFocus()},areaFocus:function(){Video.isAreaFocus||this.stopMutexFunc(),Video.setAreaFocus(),this.eventSetAreaFocus()},opticsZoom:function(){Video.isOpticsZoom||this.stopMutexFunc(),Video.setOpticsZoom(),Capinfo.isSupport3DAreaZoom&&this.eventSetOpticsZoom()},ditigalZoom:function(){Video.isDigitalZoom||this.stopMutexFunc(),Video.setDigitalZoom(),this.eventSetDigitalZoom()},manualSnap:function(){Capinfo.isSupportRectManulTrack?(Video.isManualTrack?Utils.LAPI_SetCfgData("/LAPI/Intelligent/ManualTrack",{Flag:0,RectManualTrack:{TopLeft:{X:0,Y:0},BotRight:{X:0,Y:0}}},!1):this.stopMutexFunc(),Video.setManualTrack(),this.eventSetManualTrack()):(Video.isManualSnap||this.stopMutexFunc(),Video.setManualSnap(),this.eventSetManualSnap())},bindPtzDerectEvent:function(e){if("object"!=typeof e)return!1;for(var t in e){var a=m("#"+t+"_live");a.bind("mousedown",e[t],function(e){Utils.submitCtrolCmd(e.data[0],Live.varRotateSpeed,Live.varRotateSpeed)&&(d=!0)}),a.bind("mouseup",e[t],function(e){d&&Utils.submitCtrolCmd(e.data[1],Live.varRotateSpeed,Live.varRotateSpeed)&&(d=!1)}),a.bind("mouseout",e[t],function(e){d&&Utils.submitCtrolCmd(e.data[1],Live.varRotateSpeed,Live.varRotateSpeed)&&(d=!1)})}},bindPtzLensEvent:function(e){if("object"!=typeof e)return!1;for(var t in e){var a=m("#"+t+"_live");a.bind("mousedown",e[t],function(e){Utils.submitCtrolCmd(e.data[0])&&(d=!0)}),a.bind("mouseup",e[t],function(e){d&&(Utils.submitCtrolCmd(e.data[1]),d=!1)}),a.bind("mouseout",e[t],function(e){d&&(Utils.submitCtrolCmd(e.data[1]),d=!1)})}},bindManualBackFocusNear:function(){var e=m("#manualbackfocusNear_live");e.bind("mousedown",function(){Utils.LAPI_SetCfgData(LAPI_URL.SetBackFocus,{CmdType:2,ComParams:"2"},!1),r=!0}),e.bind("mouseup",function(){Utils.LAPI_SetCfgData(LAPI_URL.SetBackFocus,{CmdType:2,ComParams:"0"},!1),r=!1}),e.bind("mouseout",function(){r&&(Utils.LAPI_SetCfgData(LAPI_URL.SetBackFocus,{CmdType:2,ComParams:"0"},!1),r=!1)})},bindManualBackFocusFar:function(){var e=m("#manualbackfocusFar_live");e.bind("mousedown",function(){Utils.LAPI_SetCfgData(LAPI_URL.SetBackFocus,{CmdType:2,ComParams:"1"},!1),r=!0}),e.bind("mouseup",function(){Utils.LAPI_SetCfgData(LAPI_URL.SetBackFocus,{CmdType:2,ComParams:"0"},!1),r=!1}),e.bind("mouseout",function(){r&&(Utils.LAPI_SetCfgData(LAPI_URL.SetBackFocus,{CmdType:2,ComParams:"0"},!1),r=!1)})},eventDrawObjParamCanvas:function(e,t,a){var i;Video.isDigitalZoom&&DrawType.RECT==e&&0==t&&(i=JSON.parse(a),Number(i.Right)<=Number(i.Left)||Number(i.Bottom)<=Number(i.Top)?(Video.digitalAreaPos.left=0,Video.digitalAreaPos.top=0,Video.digitalAreaPos.right=1e4,Video.digitalAreaPos.bottom=1e4):(e=Video.digitalAreaPos.left+(Video.digitalAreaPos.right-Video.digitalAreaPos.left)*i.Left/1e4,t=Video.digitalAreaPos.top+(Video.digitalAreaPos.bottom-Video.digitalAreaPos.top)*i.Top/1e4,a=Video.digitalAreaPos.left+(Video.digitalAreaPos.right-Video.digitalAreaPos.left)*i.Right/1e4,i=Video.digitalAreaPos.top+(Video.digitalAreaPos.bottom-Video.digitalAreaPos.top)*i.Bottom/1e4,Video.digitalAreaPos.left=e,Video.digitalAreaPos.top=t,Video.digitalAreaPos.right=a,Video.digitalAreaPos.bottom=i),Video.showDigitalView())},changeRenderScale:function(){Video.cur_scale=Capinfo.isSupportHISIParam?1:Number(m("#renderScale").val()),Frame.changeVideoSize(Video.videoWidth,Video.videoHeight),y&&this.setRenderScale(VideoType.PICTRUE),(_||y)&&this.setRenderScale(2),this.setRenderScale(VideoType.LIVE)},changeScreenNum:function(){},setVideoWidthAndHeight:function(){Video.isFullScreen||(Frame.changeVideoSize(Video.videoWidth,Video.videoHeight),this.setRenderScale(VideoType.LIVE))},setRenderScale:function(e){Video.setRenderScale(e,1)},changeVideoBtnByVideoType:function(e){var t=void 0===e?0:e;m("#fishEyeMode2").hasClass("menu-active")?(m("#btn_digitalZoom").css("display","none"),m("#btn_opticsZoom").css("display","none")):(m("#btn_digitalZoom").css("display",""),Capinfo.isSupport3DAreaZoom&&m("#btn_opticsZoom").css("display","")),Capinfo.isNoPlugin||top.sdk_viewer.isInstalled?(e=Video.statusList[t].bRecEnabled?1:0,this.eventStorageRst(e),e=Video.statusList[t].isVideoOpen?1:0,this.eventNetStreamRst(e),this.eventSetDigitalZoom(),Capinfo.isSupport3DAreaZoom&&this.eventSetOpticsZoom(),!Capinfo.isSupportAudio||y||_||(m("#audioBar").removeClass("hidden"),Capinfo.isSupportAudioTalk&&(m("#btn_talk").removeClass("hidden"),e=Video.isVoiceTalkOpen?1:0,this.eventVoiceTalkRst(e)))):this.disableAllButtons()},eventNetStreamRst:function(e){var t,a=document.getElementById("msgObj"),i=document.getElementById("btn_stop"),s=document.getElementById("btn_stopGuide"),o=document.getElementById("btn_grabImg"),n=document.getElementById("btn_prScrn"),l=document.getElementById("btn_record"),d=document.getElementById("btn_digitalZoom"),r=document.getElementById("btn_opticsZoom"),c=document.getElementById("btn_manualSnap");Video.StreamInfoChangeList[top.StreamID]&&(t=Video.StreamInfoChangeList[top.StreamID].EncodeFormat);var p="",u=m("#audioBar");switch(e){case 0:!Video.isVoiceTalkOpen&&u.is(":visible")&&(document.getElementById("btn_mute").disabled=!0,h.setEnable(!1)),l.disabled=!0,Capinfo.isSupportHISIParam?(i.innerHTML=m.lang.pub.startVideo,a&&(s.innerHTML=m.lang.pub.startVideo),i.className="startPlay button",n.disabled=!0):(i.className="startPlay",i.title=m.lang.pub.play,l.disabled=!0,l.className="noRecord",l.title=m.lang.pub.startRecord,Video.isDigitalZoom=!1,d.disabled=!0,d.className="noDigitalZoom",d.title=m.lang.pub.startDigitalZoom,Video.isManualSnap=!1,IVAMode.ILLEGAL==Frame.IVAType&&Frame.isShowPtzForHTS&&(c.disabled=!0,c.className="noManualSnap",c.title=m.lang.pub.startManualSnap),Video.isManualTrack=!1,Capinfo.isSupportRectManulTrack&&(c.disabled=!0,c.className="noManualSnap",c.title=m.lang.pub.startManualTrack),!Capinfo.isSupport3DAreaZoom||_||y||(r.disabled=!0,r.className="noOpticsZoom",r.title=m.lang.pub.startOpticsZoom),VideoFormat.JPEG==t?(o.disabled=!0,o.className="noGrabImg",C||(o.title=m.lang.pub.grabImg),Video.isCapRecEnabled=!1):(n.disabled=!0,n.className="noSnapshot",Video.bRecEnabled=!1),Capinfo.isSupportAreaFocus&&(Video.isAreaFocus=!1,m("#btn_areaFocus").attr("title",m.lang.pub.startAreaFocus).prop("disabled",!0).removeClass().addClass("noAreaFocus")));break;case 1:u.is(":visible")&&(document.getElementById("btn_mute").disabled=!1,Video.isVoiceMute?h.setEnable(!1):h.setEnable(!0)),l.disabled=!1,Capinfo.isSupportHISIParam?(i.innerHTML=m.lang.pub.stopVideo,a&&(s.innerHTML=m.lang.pub.stopVideo),i.className="stopPlay button",n.disabled=!1):(i.className="stopPlay",i.title=m.lang.pub.stop,l.disabled=!1,l.className="startRecord",d.disabled=!1,d.className="openDigitalZoom",IVAMode.ILLEGAL==Frame.IVAType&&Frame.isShowPtzForHTS&&(c.disabled=!1,c.className="openManualSnap"),!Capinfo.isSupport3DAreaZoom||_||y||(r.disabled=!1,r.className="openOpticsZoom"),VideoFormat.JPEG==t?C?(o.disabled=!1,o.className="grabImg"):(p=m.lang.tip.tipNoGrabImg,o.title=p):(n.disabled=!1,n.className="snapshot"),Capinfo.isSupportAreaFocus&&(Video.isAreaFocus=!1,m("#btn_areaFocus").attr("title",m.lang.pub.startAreaFocus).prop("disabled",!1).removeClass().addClass("openAreaFocus")));break;case 2:o.disabled=!0,o.className="noGrabImg",C||(o.title=m.lang.pub.grabImg);break;case 3:C?(o.disabled=!1,o.className="grabImg"):(p=m.lang.tip.tipNoGrabImg,o.title=p);break;default:Utils.eventAlert(m.lang.tip.tipUnknownErr)}},eventStorageRst:function(e){var t=m("#videoType").val(),a=document.getElementById("btn_record");switch(e){case 0:VideoType.PICTRUE==t?(a.className="startAutoSave",a.title=m.lang.pub.startSave):Capinfo.isSupportHISIParam?(a.innerHTML=m.lang.pub.startPlayer,a.className="startRecord button"):(a.className="startRecord",a.title=m.lang.pub.startRecord);break;case 1:VideoType.PICTRUE==t?(a.className="stopAutoSave",a.title=m.lang.pub.stopSave):Capinfo.isSupportHISIParam?(a.innerHTML=m.lang.pub.stopPlayer,a.className="stopRecord button"):(a.className="stopRecord",a.title=m.lang.pub.stopRecord);break;default:Utils.eventAlert(m.lang.tip.tipUnknownErr)}},eventVoiceTalkRst:function(e){var t=document.getElementById("btn_talk");switch(e){case 0:for(var a=0;a<Video.statusList.length&&!Video.statusList[a].isVideoOpen;a++);a+1==Video.statusList.length&&(document.getElementById("btn_mic_mute").disabled=!0,n.setEnable(!1)),t.className="startTalk",t.title=m.lang.pub.openVoiceTalk;break;case 1:document.getElementById("btn_mic_mute").disabled=!1,n.setEnable(!0),t.className="stopTalk",t.title=m.lang.pub.closeVoiceTalk;break;default:Utils.eventAlert(m.lang.tip.tipUnknownErr)}Live.disableAudio()},eventSetLockWnd:function(){var e=Video.isLock?"unlock":"lock",t=Video.isLock?m.lang.pub.stopLock:m.lang.pub.startLock,a=m("#btn_lock");a.removeClass().addClass(e),a.attr("title",t)},eventSetDigitalZoom:function(){var e=Video.isDigitalZoom?"closeDigitalZoom":"openDigitalZoom",t=Video.isDigitalZoom?m.lang.pub.stopDigitalZoom:m.lang.pub.startDigitalZoom,a=m("#btn_digitalZoom");a.removeClass().addClass(e),a.attr("title",t)},eventSetManualSnap:function(){var e=Video.isManualSnap?"closeManualSnap":"openManualSnap",t=Video.isManualSnap?m.lang.pub.stopManualSnap:m.lang.pub.startManualSnap,a=m("#btn_manualSnap");a.removeClass().addClass(e),a.attr("title",t)},eventSetManualTrack:function(){var e=Video.isManualTrack?"closeManualSnap":"openManualSnap",t=Video.isManualTrack?m.lang.pub.stopManualTrack:m.lang.pub.startManualTrack,a=m("#btn_manualSnap");a.removeClass().addClass(e),a.attr("title",t)},eventSetOpticsZoom:function(){var e=Video.isOpticsZoom?"closeOpticsZoom":"openOpticsZoom",t=Video.isOpticsZoom?m.lang.pub.stopOpticsZoom:m.lang.pub.startOpticsZoom,a=m("#btn_opticsZoom");a.removeClass().addClass(e),a.attr("title",t)},eventSetAreaFocus:function(){var e=Video.isAreaFocus?"closeAreaFocus":"openAreaFocus",t=Video.isAreaFocus?m.lang.pub.stopAreaFocus:m.lang.pub.startAreaFocus,a=m("#btn_areaFocus");a.removeClass().addClass(e),a.attr("title",t)},freshPreset:function(){var e,t,a,i,s,o=m("#position").find("option"),n=m("#ptzPresetBody");for(n.empty(),e=0,t=o.length;e<t;e++)-1!=(a=(s=m(o[e])).attr("value"))&&(i=(i=(i=s.text()).substring(i.indexOf("[")+1)).substring(0,i.indexOf("]")),s="<div class='ptz-acc-item' data-id='"+a+"'><div class='mid_right'><button class='icon call-preset' hidefocus='true' onclick='Live.callPreset(this)' title='"+m.lang.pub.gotoPreset+"'></button>",UserType.Administrator==top.userType&&(s+="<button class='icon black-del' hidefocus='true' onclick='Live.delPreset(this)' title='"+m.lang.pub["delete"]+"'></button>"),n.append(s+="</div><span class='ptz-acc-desc'>"+a+"</span><span class='ptz-acc-span' title='"+i+"'>["+i+"]</span></div>"))},callPreset:function(e){e=Number(m(e).parents("div.ptz-acc-item").attr("data-id"));Video.callPreset(e)},delPreset:function(e){e=Number(m(e).parents("div.ptz-acc-item").attr("data-id"));Video.delPreset(e)&&this.freshPreset()},changeStreamBtnStyle:function(e){var t=m("#streamIDDiv");t.find(".selected").removeClass("selected"),m(e).addClass("selected"),0==m(e).attr("data-value")&&t.find(".btn_l").addClass("selected"),m(e).hasClass("last-btn-right")&&t.find(".btn_r").addClass("selected"),Capinfo.isSupportFishIpc&&(this.resetFish(),Capinfo.isSupport4KFishEye||this.resetFishBtn(m(e).attr("id")),Capinfo.isSupport4KFishEye&&LensPlayMode.PLAYER_ORIGINAL==Variables.PlayMode&&this.resetFishBtn(m(e).attr("id")))},FindSnapImg:function(){var e=top.sdk_viewer.execFunctionReturnAll("NetSDKGetDefaultPath");ResultCode.RESULT_CODE_SUCCEED==e.code&&(e=Utils.checkNavigator("safari")?e.result+"JPEG/"+Frame.loginServerIp:e.result+"JPEG\\"+Frame.loginServerIp,top.sdk_viewer.execFunction("NetSDKOpenFloder",e))},ClearSnapImg:function(){Capinfo.isSupportFaceFeature&&(J=[],X.refresh()),m(".photoDivItem").each(function(){m(this).remove()})},resetVideoWH:function(){var e,t,a,i,s=document.getElementById("msgObj");T&&(e=m("#ptzPresetBody"),a=m("#ptzCruiseBody"),t=m("#ctrlPanel"),i=m("#ptzCmdBody"),i=t.height()-(Math.max(i.offset().top,e.offset().top,a.offset().top)-t.offset().top)-25,t=m("#ptzPresetFoot"),UserType.Administrator==top.userType?(e.height(i-t.height()),a.height(i-t.height())):(e.height(i),a.height(i))),g&&(s=(a=m(s?"#videoContain":"#videoTD")).width(),i=a.height(),m("#videoDiv").css({width:s+"px",height:i+"px"}),Frame.changeVideoSize(Video.videoWidth,Video.videoHeight),i=m("#traffictLightStatusDiv").height(),m("#dataViewTbody").height(i-m("#dataViewThead").height()-6),i=document.getElementById("videoTD"),Video.frameWidth=i.offsetWidth,Video.frameHeight=i.offsetHeight,m("#drawButton").hasClass("hidden")||Utils.liveAddButton(!0,v.Right,v.Bottom),m("#testButton").hasClass("hidden")||Utils.liveAddButton(!0,v.Right,v.Bottom,"testButton","videoContain"),Capinfo.isSupportMFace&&Capinfo.isSupportFaceFeature&&m("#dataViewCaptureTbody").height(250-m("#dataViewCaptureThead").height()-4))},getData:function(){return x},getDataT:function(){return K},getFaceInfoData:function(){return J},initDataView:function(){var t,e;(O=new TableView("dataview_tbody",this.getData,G)).setFields({PassTime:function(e){var t="";return t=17==e.length?e.substring(0,4)+"-"+e.substring(4,6)+"-"+e.substring(6,8)+" "+e.substring(8,10)+":"+e.substring(10,12)+":"+e.substring(12,14)+"."+e.substring(14,17):t},PlateColor:function(e){return 0==e?e=m.lang.pub.white:1==e?e=m.lang.pub.yellow:2==e?e=m.lang.pub.blue:3==e?e=m.lang.pub.black:4==e?e=m.lang.pub.other:5==e?e=m.lang.pub.green:6==e?e=m.lang.pub.red:7==e?e=m.lang.pub.YellowGreen:8==e&&(e=m.lang.pub.GradientGreen),e},CarColor:function(e){switch(e){case"A":e=m.lang.pub.white;break;case"B":e=m.lang.pub.gray;break;case"C":e=m.lang.pub.yellow;break;case"D":e=m.lang.pub.pink;break;case"E":e=m.lang.pub.red;break;case"F":e=m.lang.pub.purple;break;case"G":e=m.lang.pub.green;break;case"H":e=m.lang.pub.blue;break;case"I":e=m.lang.pub.brown;break;case"J":e=m.lang.pub.black;break;case"K":e=m.lang.pub.orange;break;case"L":e=m.lang.pub.cyan;break;case"M":e=m.lang.pub.silvery;break;case"N":e=m.lang.pub.silvery_white;break;case"Z":e=m.lang.pub.other}return e},DriveStatusStr:function(e){var t="";return 0==e?t=m.lang.pub.none:"undefined"!=typeof b[e]&&(t=b[e]),t},PlateNum:function(e){return"-"==e?(e=m.lang.pub.unIdentify,Capinfo.isSupportHISIParam&&(m("#unIdentifyCar").html(++s),m("#totalCar").html(++a))):"#"==e?e=m.lang.pub.recognizing:"*"==e?e=m.lang.pub.freeCarPort:"!"==e?e=m.lang.pub.abnormalOccupation:Capinfo.isSupportHISIParam&&m("#totalCar").html(++a),e},PlateType:function(e){return 1==e?e=m.lang.pub.lagerCar:2==e?e=m.lang.pub.smallCar:3==e?e=m.lang.pub.diplomaticcar:4==e?e=m.lang.pub.consulatecar:7==e?e=m.lang.pub.typemotor:8==e?e=m.lang.pub.handinessmotor:9==e?e=m.lang.pub.diplomaticmotor:11==e?e=m.lang.pub.outareamotor:13==e?e=m.lang.pub.farmtransportcar:14==e?e=m.lang.pub.typetractor:15==e?e=m.lang.pub.typetrailer:16==e?e=m.lang.pub.coachcar:17==e?e=m.lang.pub.coachmotor:18==e?e=m.lang.pub.testcar:19==e?e=m.lang.pub.testmotor:20==e?e=m.lang.pub.temporaryentry:21==e?e=m.lang.pub.temporaryentrymotor:22==e?e=m.lang.pub.temporarycar:23==e?e=m.lang.pub.typepolicecar:24==e?e=m.lang.pub.policemotor:25==e?e=m.lang.pub.farmmachinerycar:26==e?e=m.lang.pub.hongkongentryexit:27==e?e=m.lang.pub.macaoentryexit:28==e?e=m.lang.pub.typemidcar:31==e?e=m.lang.pub.policeCar:32==e?e=m.lang.pub.typearmy:33==e?e=m.lang.pub.typepedestrian:34==e?e=m.lang.pub.typearmynonmotor:41==e?e=m.lang.pub.withoutplatecar:42==e?e=m.lang.pub.typefals:51==e?e=m.lang.pub.largeenergy:52==e?e=m.lang.pub.smallenergy:99==e&&(e=m.lang.pub.otherVehicle),e},trigMode:function(e){return 0==e?e=0:1==e?e=m.lang.pub.videoDetect:4==e?e=m.lang.pub.singleCoil:5==e?e=m.lang.pub.halfCoil:6==e?e=m.lang.pub.fullCoil:7==e?e=m.lang.pub.radarHave:8==e?e=m.lang.pub.radarNoDir:9==e?e=m.lang.pub.laserTrigger:10==e?e=m.lang.pub.switchValue:11==e?e=m.lang.pub.switchInput:66==e?e=m.lang.pub.softTrigger:101==e&&(e=m.lang.pub.debugTrigger),e}}),Capinfo.isSupportTrafficFlow&&0<(64&D.PlateRectify0)?(z=new TableView("dataview_tbodyT",this.getDataT,j),m("#smallCarFlow").removeClass("hidden"),m("#SUVFlow").removeClass("hidden"),m("#VanFlow").removeClass("hidden"),m("#SmallTruckFlow").removeClass("hidden"),m("#MidiBusFlow").removeClass("hidden"),m("#LargeBusFlow").removeClass("hidden"),m("#BigTruckFlow").removeClass("hidden")):(z=new TableView("dataview_tbodyT",this.getDataT,W),Capinfo.isSupportTrafficFlow&&(m("#OversizeVehicleFlow").removeClass("hidden"),m("#MidsizeSedanFlow").removeClass("hidden"),m("#EconomysizeSedanFlow").removeClass("hidden"))),Capinfo.isSupportTrafficFlow&&(m("#aveHeadGap").removeClass("hidden"),m("#AveSpaceOcupyRat").removeClass("hidden"),m("#wayState").removeClass("hidden")),z.setFields({StartTime:function(e){var t="";return t=14==e.length?e.substring(0,4)+"-"+e.substring(4,6)+"-"+e.substring(6,8)+" "+e.substring(8,10)+":"+e.substring(10,12)+":"+e.substring(12,14):t}}),O.setTrEvnet({onclick:function(){var e=Utils.getEvent(),t=e.srcElement||e.target,a=("TR"==t.tagName||"TD"==t.tagName?m(t):m(t).parents("td")).attr("rowNum");O.checkRow(a),e=O.getData(a,"PicName"),t=O.getData(a,"PicPalateExist"),Video.NetSDKPlayLocalPic(top,wndIdNum.CAPTURESCREEN,e,""),t?(e=e.substring(0,e.lastIndexOf("_")+1)+"p.jpg",Video.NetSDKPlayLocalPic(top,1,e,O.getData(a,"PlateNum")),Capinfo.isSupportHISIParam&&((t=m("#PlateType"+a+"_TD").html())==m.lang.pub.lagerCar?t=1:t==m.lang.pub.smallCar?t=2:t==m.lang.pub.diplomaticcar?t=3:t==m.lang.pub.consulatecar?t=4:t==m.lang.pub.typemotor?t=7:t==m.lang.pub.handinessmotor?t=8:t==m.lang.pub.diplomaticmotor?t=9:t==m.lang.pub.outareamotor?t=10:t==m.lang.pub.farmtransportcar?t=13:t==m.lang.pub.typetractor?t=14:t==m.lang.pub.typetrailer?t=15:t==m.lang.pub.coachcar?t=16:t==m.lang.pub.coachmotor?t=17:t==m.lang.pub.testcar?t=18:t==m.lang.pub.testmotor?t=19:t==m.lang.pub.temporaryentry?t=20:t==m.lang.pub.temporaryentrymotor?t=21:t==m.lang.pub.temporarycar?t=22:t==m.lang.pub.typepolicecar?t=23:t==m.lang.pub.policemotor?t=24:t==m.lang.pub.farmmachinerycar?t=25:t==m.lang.pub.hongkongentryexit?t=26:t==m.lang.pub.macaoentryexit?t=27:t==m.lang.pub.typemidcar?t=28:t==m.lang.pub.policeCar?t=31:t==m.lang.pub.typearmy?t=32:t==m.lang.pub.typepedestrian?t=33:t==m.lang.pub.typearmynonmotor?t=34:t==m.lang.pub.withoutplatecar?t=41:t==m.lang.pub.typefals?t=42:t==m.lang.pub.largeenergy?t=51:t==m.lang.pub.smallenergy?t=52:t==m.lang.pub.otherVehicle&&(t=99),(e=m("#PlateColor"+a+"_TD").html())==m.lang.pub.white?e=0:e==m.lang.pub.yellow?e=1:e==m.lang.pub.blue?e=2:e==m.lang.pub.black?e=3:e==m.lang.pub.other?e=4:e==m.lang.pub.green?e=5:e==m.lang.pub.red?e=6:e==m.lang.pub.YellowGreen?e=7:e==m.lang.pub.GradientGreen&&(e=8),a=m("#PlateNum"+a+"_TD").html()?m("#PlateNum"+a+"_TD").html():"",top.sdk_viewer.execFunctionReturnAll("NetSDKDisplayCarPlate",3,t,e,a))):(Video.NetSDKPlayLocalPic(top,1,"",""),Capinfo.isSupportHISIParam&&top.sdk_viewer.execFunctionReturnAll("NetSDKDisplayCarPlate",3,0,0,""))}}),O.createDataView(),Capinfo.isSupportHISIParam||z.createDataView(),Capinfo.isSupportMFace&&Capinfo.isSupportFaceFeature&&(e={},Utils.LAPI_GetCfgData(LAPI_URL.FaceDetectionRule,e)&&(0==e.FaceAttributeAnalysis.SexEnabled&&(m(".sex").addClass("hidden"),Y[2].hidden=!0),0==e.FaceAttributeAnalysis.AgeEnabled&&(m(".age").addClass("hidden"),Y[3].hidden=!0),0==e.FaceAttributeAnalysis.GlassEnabled&&(m(".glasses").addClass("hidden"),Y[4].hidden=!0)),(X=new DataView("dataviewCapture_tbody",this.getFaceInfoData,Y,0,"",0)).setFields({PassTime:function(e){return t="",t=17==e.length?e.substring(0,4)+"-"+e.substring(4,6)+"-"+e.substring(6,8)+" "+e.substring(8,10)+":"+e.substring(10,12)+":"+e.substring(12,14)+"."+e.substring(14,17):t},sex:function(e){return t=m.lang.pub.unknownType,0==e?t=m.lang.pub.man:1==e&&(t=m.lang.pub.female),t},age:function(e){return t=m.lang.pub.unknownType,0==e?t=m.lang.pub.children:1==e?t=m.lang.pub.youngMan:2==e?t=m.lang.pub.strongMan:3==e&&(t=m.lang.pub.oldMan),t},glasses:function(e){return t=m.lang.pub.unknownType,7==e?t=m.lang.pub.sunglasses:50==e?t=m.lang.pub.noSunglasses:0==e?t=m.lang.pub.no:98==e?t=m.lang.pub.unknownType:99==e&&(t=m.lang.pub.demoOtherTitle),t},PicName:function(e){return t=m.lang.pub.unknownType,t=-1!=e?e:t},Time:function(e){return e}}),X.setTrEvnet({onclick:function(){var e=Utils.getEvent(),t=e.srcElement||e.target,e=("TR"==t.tagName||"TD"==t.tagName?m(t):m(t).parents("td")).attr("rowNum"),t=Number(m("#Time"+e+"_TD input").val());m(".selectedTR").removeClass("selectedTR"),m("tr[rowNum="+e+"]").addClass("selectedTR"),m(".selectedPic").removeClass("selectedPic"),m("#"+t).addClass("selectedPic")}}))},clearCarRecord:function(){x=[],K=[],O.refresh(),Capinfo.isSupportHISIParam?(a=s=0,m("#unIdentifyCar").html(s),m("#totalCar").html(a)):(K=[],z.refresh())},eventDrawButtonLink:function(e,t,a){e=Number(e),Utils.liveAddButton(e)},eventDrawObjParam:function(e,t,a){var i=document.getElementById("msgObj");""!=a&&(v=m.parseJSON(a)),top.sdk_viewer.execFunctionReturnAll("NetSDKAddDrawObj",wndIdNum.CAPTURESCREEN,4,0,v),i?Utils.liveAddButton(!0,v.PointX3,v.PointY3,"testButton","videoContain"):Utils.liveAddButton(!0,v.PointX3,v.PointY3)},eventSelDrawObj:function(e,t){0==e&&19==t?Utils.selectDrawObj(0,19,wndIdNum.LIVE):2==e&&0==t&&Utils.selectDrawObj(2,0,wndIdNum.LIVE)},selectPic:function(e){m(".selectedPic").removeClass("selectedPic"),m("#"+e).addClass("selectedPic"),m(".selectedTR").removeClass("selectedTR"),m("input[value="+e+"]").parents("tr").addClass("selectedTR")},carRecordReport:function(e,t){var a,i,s,o,n,l,d=e,r={},c=0,p="";r.PicPalateExist=!1,0<d.find("RecordID").length&&(r.rowNum=Number(d.find("RecordID").text())),0<d.find("PassTime").length&&(r.PassTime=m(d.find("Image PassTime")[0]).text()),0<d.find("LaneID").length&&(r.LaneID=Number(d.find("LaneID").text())),0<d.find("VehicleColor").length&&(r.CarColor=d.find("VehicleColor").text()),0<d.find("PlateColor").length&&(s=Number(d.find("PlateColor").text()),r.PlateColor=s),0<d.find("CarPlate").length&&(o=d.find("CarPlate").text(),r.PlateNum=o),0<d.find("DriveStatus").length&&(r.DriveStatusStr=d.find("DriveStatus").text()),0<d.find("VehicleSpeed").length&&(r.Speed=Number(d.find("VehicleSpeed").text())),0<d.find("PlateType").length&&(i=Number(d.find("PlateType").text()),r.PlateType=i),0<d.find("CaptureTriggerMode").length&&(r.trigMode=Number(d.find("CaptureTriggerMode").text())),0<d.find("VehicleLength").length&&(e=Number(d.find("VehicleLength").text()),r.PlateWidth=e),0<d.find("PicNumber").length&&(l=Number(d.find("PicNumber").text())),Capinfo.isSupportHISIParam&&Video.sdk_viewer.execFunctionReturnAll("NetSDKDisplayCarPlate",wndIdNum.SDLIST,i,s,o),a=t.split(";"),n=r.PassTime.substring(0,8)+"_"+r.PassTime.substring(8,16)+"_"+r.rowNum+"_"+r.DriveStatusStr+"_"+r.CarColor+"_"+r.PlateColor+"_"+r.PlateNum+"_"+r.LaneID,Capinfo.isMac?r.PicName=a[0].substring(0,a[0].lastIndexOf("/")+1)+n+"_"+c+".jpg":r.PicName=a[0].substring(0,a[0].lastIndexOf("\\")+1)+n+"_"+c+".jpg";for(var u=0;u<l;u++)2==m(d.find("Image ImageType")[u]).text()&&(c="p",r.PicPalateExist=!0),p=Capinfo.isMac?a[0].substring(0,a[0].lastIndexOf("/")+1)+n+"_"+c+".jpg":a[0].substring(0,a[0].lastIndexOf("\\")+1)+n+"_"+c+".jpg",Video.NetSDKChangeFileName(top,a[u],p),"p"==c&&Video.NetSDKPlayLocalPic(top,1,p,r.PlateNum),c=u,c++;r.PicPalateExist||Video.NetSDKPlayLocalPic(top,1,"",""),x.push(r),O.addData();t=m("#dataViewTbody");t[0].scrollTop=t[0].scrollHeight},snapRecordReport:function(e,t){var a,i={},s="",o="",n="",l=t.split(";");if(0<(a=0<e.find("PicNumber").length?Number(e.find("PicNumber").text()):a))for(var d,r=0;r<a;r++)0!=Number(m(e.find("Image FaceID")[r]).text())&&(0<e.find("PassTime").length&&(i.PassTime=m(e.find("Image PassTime")[r]).text()),i.Time=(new Date).getTime(),d=i.PassTime.substring(0,8)+"_"+i.PassTime.substring(8,16)+"_"+r,Capinfo.isMac?i.PicName=l[r].substring(0,l[r].lastIndexOf("/")+1)+d+".jpg":i.PicName=l[r].substring(0,l[r].lastIndexOf("\\")+1)+d+".jpg",s=Capinfo.isMac?l[r].substring(0,l[r].lastIndexOf("/")+1)+d+".jpg":l[r].substring(0,l[r].lastIndexOf("\\")+1)+d+".jpg",top.sdk_viewer.execFunctionReturnAll("NetSDKChangeFileName",l[r],s),o=i.PicName+"?t="+(new Date).getTime(),n=Utils.checkNavigator("ie")?"<div style='background: url("+(o=o.replace(/\\/g,"\\\\"))+");filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,enabled=true,src="+o+");-moz-background-size:100% 100%;background-size:100% 100%;' class='photoDivItem' id='"+i.Time+"'></div>":"<img src='data:image/jpg;base64,"+top.sdk_viewer.execFunctionReturnAll("NetSDKGetLocalPic",i.PicName).result.split("@")[0]+"' class='photoDivItem' id='"+i.Time+"'></img>",200==(d=m(".photoDivItem")).length&&d.last().remove(),m("#captureList").children().filter(".section_title").after(n),m(".selectedPic").removeClass("selectedPic"))},eventRecordReport:function(e,t){""!=e&&(e=Utils.parseXML(e),e=m(e),Capinfo.isSupportPersonPhoto?(this.snapRecordReport(e,t),m(".photoDivItem").first().addClass("selectedPic")):this.carRecordReport(e,t))},getTrafficParamReport:function(e){for(var t=0;t<e.DriveWayNum;t++){var a={};a.StartTime=e.StartTime,a.DrivewayID=e.TrParaRslt[t].ID,a.wayState=e.TrParaRslt[t].Stat,a.CarFlow=e.TrParaRslt[t].Flow,a.AveSpeed=e.TrParaRslt[t].Speed,a.AveHeadTime=e.TrParaRslt[t].Time,a.AveHeadGap=e.TrParaRslt[t].HeadSpac,a.AveTimeOcupyRat=e.TrParaRslt[t].TimOcupy,a.AveSpaceOcupyRat=e.TrParaRslt[t].OcuRat,a.smallCarFlow=e.TrParaRslt[t].CarType[0],a.SUVFlow=e.TrParaRslt[t].CarType[1],a.VanFlow=e.TrParaRslt[t].CarType[2],a.SmallTruckFlow=e.TrParaRslt[t].CarType[3],a.MidiBusFlow=e.TrParaRslt[t].CarType[4],a.LargeBusFlow=e.TrParaRslt[t].CarType[5],a.BigTruckFlow=e.TrParaRslt[t].CarType[6],a.OversizeVehicleFlow=e.TrParaRslt[t].CarType[7],a.MidsizeSedanFlow=e.TrParaRslt[t].CarType[8],a.EconomysizeSedanFlow=e.TrParaRslt[t].CarType[9],0==a.wayState?a.wayState=m.lang.pub.Unblocked:1==a.wayState?a.wayState=m.lang.pub.Amble:a.wayState=m.lang.pub.Congestion,K.push(a),z.addData()}var i=m("#dataViewTbodyT");i[0].scrollTop=i[0].scrollHeight},getTrafficLightColor:function(){var e={};Utils.LAPI_GetCfgData(LAPI_URL.TrafficLightColour,e)&&this.eventTrafficLightColor(e.StatusParam.TrafficLightColour)},eventTrafficLightColor:function(e){for(var t,a,i,s=0;s<e.length;s++)2==s?(i="left_",t="LeftLight"):1==s?(i="straight_",t="StraightLight"):0==s&&(i="right_",t="RightLight"),"1"==(a=e.charAt(s))?i+="red":"2"==a?i+="yellow":"4"==a?i+="green":"f"==a&&(i+="black"),m("#"+t).removeClass().addClass("traffic_light").addClass(i)},changeFishEyeModeStyle:function(e){e=m("#"+e);e.hasClass("menu-active")||(m(".menu-content li").removeClass("menu-active"),e.addClass("menu-active"))},chooseStream:function(e){var t,a,i,e=m("#"+e),s=""==e.attr("data-value")?[]:e.attr("data-value").split(","),o=0,n=this;for(Capinfo.isSupportFishEye&&(e=m("#ctrlPanelBtn_live"),4<=s.length?e.hasClass("open-ptz")&&e.trigger("click"):e.hasClass("close-ptz")&&e.trigger("click")),i=0;i<Video.statusList.length;i++)Video.statusList[i].isVideoOpen&&Video.stopVideo(StreamType.LIVE,i);for(Video.currentWndID=0,Video.statusList=[],i=0;i<s.length;i++)t=s[i],a=i,Video.statusList[i]=Utils.objectClone(Video.statusMap),Video.statusList[i].streamID=t,Video.getCurVideoFormat(t),Capinfo.isSupportPTZ&&(o=1),n.setVideoWidthAndHeight(),setTimeout(function(){Video.startVideo(t,!0,a,o,!0),n.changeVideoBtnByVideoType(a)},100);L=!1},toggleCtrlPanel:function(e){var t,a=m("#videoTD"),i=Number(a.css("right").replace("px","")),s=this,o=m("#btn_fishIpc"),n=m("#ctrlPanelBtn_live");0==e?n.hasClass("open-ptz")?n.removeClass("open-ptz").addClass("close-ptz"):n.removeClass("close-ptz").addClass("open-ptz"):(n=o.hasClass("openFishIpc")?(o.removeClass("openFishIpc").addClass("closeFishIpc"),m.lang.pub.openFishIpc):(o.removeClass("closeFishIpc").addClass("openFishIpc"),m.lang.pub.closeFishIpc),o.attr("title",n)),m("#ctrlPanel").animate({width:"toggle"},null,null,function(){m("#ctrlPanel").is(":visible")&&T&&l.SetValue(Live.varRotateSpeed),s.resetVideoWH()}),Utils.checkNavigator("ie")&&(t=navigator.appVersion.split(";")[1].replace(/[ ]/g,"")),Utils.checkNavigator("ie")&&"MSIE7.0"==t?(m("#videoBar").css("right",222-i+"px"),200<i?m("#controlhead").addClass("margin_right_0"):m("#controlhead").removeClass("margin_right_0"),a.css("right",222-i+"px"),m("#btn_fishIpc").prop("disabled",!0),setTimeout(function(){m("#videoDiv").css({width:a.width()+"px"}),m("#btn_fishIpc").prop("disabled",!1),s.resetVideoWH()},10)):(m("#videoBar").animate({right:222-i+"px"}),200<i?m("#controlhead").addClass("margin_right_0"):m("#controlhead").removeClass("margin_right_0"),a.animate({right:222-i+"px"},null,null,function(){var e=m("#videoTD").width();m("#videoDiv").css({width:e+"px"}),s.resetVideoWH()}))},fishModeCalllBack:function(e){var t;ResultCode.RESULT_CODE_SUCCEED!=e&&(t=m.lang.pub.ChangeModeFailed,Frame.showMsg(!1,t))},initPearlEyePage:function(){var e,t=m("#fishEyeMode0"),a=m("#fishEyeMode1"),i=m("#fishEyeMode2"),s=m("#fishEyeMode3");switch(m("#ctrlPanelBtn_live").addClass("hidden"),Frame.getPearEyeCommonCfg(),Frame.getDefaultStreamID(),e=Frame.LiveMode,PearlEyeLiveMode.PearlEye_Full_3PTZ!=e&&PearlEyeLiveMode.PearlEye_4PTZ!=e&&PearlEyeLiveMode.Full_4PTZ!=e||(m("#ctrlPanel_fisheye").removeClass("hidden"),m("#controlhead").addClass("controlhead"),m("#videoBar").css("left","220px"),m("#videoTD").css("left","220px")),e){case PearlEyeLiveMode.PearlEye_Full_3PTZ:t.removeClass("hidden"),a.removeClass("hidden"),s.removeClass("hidden");break;case PearlEyeLiveMode.PearlEye_4PTZ:t.removeClass("hidden"),i.removeClass("hidden");break;case PearlEyeLiveMode.Full_4PTZ:a.removeClass("hidden"),i.removeClass("hidden");break;case PearlEyeLiveMode.PearlEye:t.removeClass("hidden");break;case PearlEyeLiveMode.Full:a.removeClass("hidden");break;case PearlEyeLiveMode.PTZ4:i.removeClass("hidden")}},resetFishBtn:function(e){var t,a,i,s={},o=m("#btn_fishIpc"),e="mainStream"==e?0:"auxStream"==e?1:2;Utils.LAPI_GetCfgData(LAPI_URL.VideoEncode,s)&&(t=s.VideoStreamInfos[e].VideoEncodeInfo.Resolution.Width,a=s.VideoStreamInfos[e].VideoEncodeInfo.Resolution.Height,i=s.VideoStreamInfos[e].VideoEncodeInfo.EncodeFormat),(Capinfo.isSupportFishIpc||Capinfo.isSupport4KFishEye&&LensPlayMode.PLAYER_ORIGINAL==Variables.PlayMode)&&(t*a<=414720||0==i?(o.hasClass("openFishIpc")&&this.toggleCtrlPanel(1),document.getElementById("btn_fishIpc").className="nocloseFishIpc",document.getElementById("btn_fishIpc").disabled=!0):(o.hasClass("nocloseFishIpc")&&o.removeClass("nocloseFishIpc").addClass("closeFishIpc"),document.getElementById("btn_fishIpc").disabled=!1),o.hasClass("closeFishIpc")&&this.toggleCtrlPanel(1))},disableAudio:function(){var e={},t=m("#btn_talk");t.hasClass("hidden")||Utils.LAPI_GetCfgData(LAPI_URL.AudioIn,e)&&0<t.length&&(0==e.IsMute?t.hasClass("stopTalk")||(document.getElementById("btn_talk").disabled=!1,document.getElementById("btn_talk").className="startTalk"):(document.getElementById("btn_talk").disabled=!0,document.getElementById("btn_talk").className="noTalk"))},onCruiseStatus:function(e){cruise.onCruiseStatus(e)},snapListSwitch:function(){var e=m("#btn_liveSwitchIpc_pic"),t=this,a=m("#videoTD");e.hasClass("openIpc_picture")?(Frame.autoSnapStream=!0,Video.startJpeg(),e.removeClass("openIpc_picture").addClass("closeIpc_picture"),document.getElementById("btn_liveSwitchIpc_pic").title=m.lang.pub.stopSnap,m("#captureMode").removeClass("hidden"),m("#videoTD").addClass("videoLeft"),m("#videoBar").addClass("videoLeft"),m("#controlhead").addClass("margin_left_300"),Capinfo.isSupportFaceFeature&&(m("#captureInfoDiv").removeClass("hidden"),m("#videoTD").addClass("faceRecognitionVideoTD"),m("#videoBar").addClass("faceRecognitionPluginbar"),m("#ctrlPanel").addClass("faceRecognitionCtrl"),m("#captureMode").addClass("faceRecognitionPluginbar")),m("#videoDiv").css("left","310px"),m("#videoDiv").css({width:a.width()+"px"}),setTimeout(function(){t.resetVideoWH()},10)):e.hasClass("closeIpc_picture")&&(Frame.autoSnapStream=!1,Video.sdk_viewer.execFunctionReturnAll("NetSDKCloseStream",2),Video.sdk_viewer.execFunctionReturnAll("NetSDKFreeLocalPort",2),e.removeClass("closeIpc_picture").addClass("openIpc_picture"),document.getElementById("btn_liveSwitchIpc_pic").title=m.lang.pub.startSnap,m("#captureMode").addClass("hidden"),m("#videoTD").removeClass("videoLeft"),m("#videoBar").removeClass("videoLeft"),m("#controlhead").removeClass("margin_left_300"),Capinfo.isSupportFaceFeature&&(m("#captureInfoDiv").addClass("hidden"),m("#videoTD").removeClass("faceRecognitionVideoTD"),m("#videoBar").removeClass("faceRecognitionPluginbar"),m("#ctrlPanel").removeClass("faceRecognitionCtrl"),m("#captureMode").removeClass("faceRecognitionPluginbar")),m("#videoDiv").css("left","10px"),m("#videoDiv").css({width:a.width()+"px"}),setTimeout(function(){t.resetVideoWH()},10))}}))}(jQuery),Frame.currentNameSpace=Live,$(document).ready(function(){Live.init2()});