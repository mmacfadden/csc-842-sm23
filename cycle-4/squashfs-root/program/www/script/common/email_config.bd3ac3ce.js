Config.emailPage=function(a){var i,t=!1,n=!1,l="@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@",r=null,s={},m={},o={},c={Name:["SenderInfo","Name"],From:["SenderInfo","Address"],SmtpServer:["ServerIPAddress"],SmtpServerPort:["ServerPort"],EnableSSL:["SSL"],CaptureIntervals:["AttachmentInterval"],ImageAttachments:["AttachmentType"],EnableServerAuth:["ServerAuth"],UserName:["LoginName"],RecipientName0:["RecipientInfo","Recipients",0,"Name"],Recipient0:["RecipientInfo","Recipients",0,"Address"],RecipientName1:["RecipientInfo","Recipients",1,"Name"],Recipient1:["RecipientInfo","Recipients",1,"Address"],RecipientName2:["RecipientInfo","Recipients",2,"Name"],Recipient2:["RecipientInfo","Recipients",2,"Address"]};return new(Class.extend({init:function(){Utils.beforeDataLoad(),Utils.initLang(),this.initValidator(),this.initData(document.frmSetup),Utils.afterDataLoad()},initPage:function(){},initData:function(e){e.PassWord.value=l,e.comfirmPassWord.value=l,m={},s={},Utils.LAPI_GetCfgData(LAPI_URL.Email_Cfg,m)&&(o=Utils.objectClone(m),Utils.LAPI_CfgToForm("frmSetup",m,s,c))},initEvent:function(){},submitF:function(){r.form()&&(Utils.LAPI_FormToCfg("frmSetup",m,s,c),t||!Utils.isObjectEquals(m,o)?(t&&(m.RSAPublicKey={},m.RSAPublicKey.RSAPublicKeyE=Frame.RSAPublicKeyE,m.RSAPublicKey.RSAPublicKeyN=Frame.RSAPublicKeyN,m.PIN=Utils.encrypting(a("#PassWord").val(),Frame.RSAKey)),Utils.LAPI_SetCfgData(LAPI_URL.Email_Cfg,m,!1,this.callback)):Frame.showMsg(!0,a.lang.tip.tipAnyChangeInfo,0))},callback:function(e){ResultCode.RESULT_CODE_SUCCEED==e?(t&&(delete m.RSAPublicKey,delete m.PIN),o=Utils.objectClone(m),n=t=!1,a("#PassWord").val(l),a("#comfirmPassWord").val(l),Frame.showMsg(!0)):ResultCode.RESULT_RASPUBLICKEY_AUTH_ERR==e?(e={},Utils.LAPI_GetCfgData(LAPI_URL.SecurityRSA,e)&&(setMaxDigits(130),Frame.RSAPublicKeyE=e.RSAPublicKeyE,Frame.RSAPublicKeyN=e.RSAPublicKeyN,Frame.RSAKey=new RSAKeyPair(Frame.RSAPublicKeyE,"",Frame.RSAPublicKeyN),m.RSAPublicKey={},m.RSAPublicKey.RSAPublicKeyE=Frame.RSAPublicKeyE,m.RSAPublicKey.RSAPublicKeyN=Frame.RSAPublicKeyN,m.PIN=Utils.encrypting(a("#PassWord").val(),Frame.RSAKey),Utils.LAPI_SetCfgData(LAPI_URL.Email_Cfg,m,!1,Config.emailPage.callback))):Frame.showMsg(!1,a.lang.tip.tipSetCfgFail)},release:function(){delete Config.emailPage},initValidator:function(){a("#Name").attr("tip",a.lang.tip.tipCommonNamePwd),a("#From").attr("tip",a.lang.tip.tipCommonNamePwd),a("#SmtpServer").attr("tip",a.lang.tip.tipCommonNamePwd),a("#SmtpServerPort").attr("tip",a.validator.format(a.lang.tip.tipIntRange,1,65535)),a("#UserName").attr("tip",a.lang.tip.tipEmailAdress),a("#PassWord").attr("tip",a.lang.tip.tipCommonNamePwd),a("#comfirmPassWord").attr("tip",a.lang.tip.tipCommonNamePwd),a("#RecipientName0").attr("tip",a.lang.tip.tipCommonNamePwd),a("#Recipient0").attr("tip",a.lang.tip.tipEmailAdress),a("#RecipientName1").attr("tip",a.lang.tip.tipCommonNamePwd),a("#Recipient1").attr("tip",a.lang.tip.tipEmailAdress),a("#RecipientName2").attr("tip",a.lang.tip.tipCommonNamePwd),a("#Recipient2").attr("tip",a.lang.tip.tipEmailAdress),a.validator.addMethod("validStrNoNull",function(e){return Utils.validStrNoNull(e)},a.lang.validate.valRequired),a.validator.addMethod("validNameContent",function(e){return""==e||Utils.validNameContent(e)},a.lang.tip.tipCharFmtErr),a.validator.addMethod("validEmailAdress",function(e){return""==e||Utils.validEmailAdress(e)},a.lang.tip.tipEmailFmtErr),a.validator.addMethod("checkUserName",function(e){return Utils.checkUserName(e)},a.lang.tip.tipCharFmtErr),a.validator.addMethod("checkPwd",function(e){return Utils.checkPassword(e)},a.lang.tip.tipCharFmtErr),a.validator.addMethod("userDefinedConfirmPwd",function(e,i,t){return a(t).val()==e},a.lang.tip.tipUnequalUserPwd),(r=a("#frmSetup").validate({focusInvalid:!1,errorElement:"span",errorPlacement:function(e,i){Utils.showJqueryErr(e,i,"span")},success:function(e){},rules:{Name:{maxlength:32,validNameContent:""},From:{maxlength:32,validNameContent:""},SmtpServer:{maxlength:32,validNameContent:""},SmtpServerPort:{integer:!0,required:!0,range:[1,65535]},UserName:{maxlength:48,validEmailAdress:""},PassWord:{maxlength:32},RecipientName0:{maxlength:32,validNameContent:""},Recipient0:{maxlength:48,validEmailAdress:""},RecipientName1:{maxlength:32,validNameContent:""},Recipient1:{maxlength:48,validEmailAdress:""},RecipientName2:{maxlength:32,validNameContent:""},Recipient2:{maxlength:48,validEmailAdress:""}}})).init()},emailTest:function(){var e=Utils.objectClone(m),i=Utils.objectClone(s);Utils.LAPI_FormToCfg("frmSetup",e,i,c),t&&(e.RSAPublicKey={},e.RSAPublicKey.RSAPublicKeyE=Frame.RSAPublicKeyE,e.RSAPublicKey.RSAPublicKeyN=Frame.RSAPublicKeyN,e.PIN=Utils.encrypting(a("#PassWord").val(),Frame.RSAKey)),Utils.LAPI_SetCfgData(LAPI_URL.EmailTest,e,!1,Config.emailPage.EmailCallBack)},EmailCallBack:function(e){Frame.updateBlock(!1),ResultCode.RESULT_CODE_SUCCEED==e?Config.emailPage.showResult("recipientDiv"+i,!0,a.lang.tip.tipTestSuccess):ResultCode.RESULT_EMAIL_SERVER_ERR==e?Config.emailPage.showResult("recipientDiv"+i,!1,a.lang.tip.tipEmailServerErr):ResultCode.RESULT_EMAIL_AUTH_ERR==e?Config.emailPage.showResult("recipientDiv"+i,!1,a.lang.tip.tipEmailAuthErr):ResultCode.RESULT_EMAIL_SEND_FAIL==e?Config.emailPage.showResult("recipientDiv"+i,!1,a.lang.tip.tipEmailSendErr):ResultCode.RESULT_EMAIL_ENCRYPT_FAIL==e?Config.emailPage.showResult("recipientDiv"+i,!1,a.lang.tip.tipEmailEncryptErr):ResultCode.RESULT_EMAIL_ANILIZE_FAIL==e?Config.emailPage.showResult("recipientDiv"+i,!1,a.lang.tip.tipEmailAnlizeErr):Config.emailPage.showResult("recipientDiv"+i,!1,a.lang.tip.tipTestErr)},showResult:function(e,i,t){i?a("#"+e+" a").removeClass("fail").addClass("success"):a("#"+e+" a").removeClass("success").addClass("fail"),a("#"+e+" span").text(t),a("#"+e).removeClass("hidden")},checkEmailValid:function(e){r.form()&&(i=e,Frame.updateBlock(!0,a.lang.pub.Testing),setTimeout(this.emailTest,400))},initPwdChanged:function(e){"PassWord"!=e||t?"comfirmPassWord"!=e||n||(a("#"+e).val(""),n=!0):(a("#"+e).val(""),t=!0)}}))}(jQuery),Frame.currentNameSpace=Config.emailPage;