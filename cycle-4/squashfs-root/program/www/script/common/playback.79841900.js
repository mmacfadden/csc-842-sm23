Utils.$package("Playback"),Playback=function(C){var g=null,i=!0,s=!0,D=null,S=0,l=null,o=null,p=!1,m={},e={},t={},f=0,v=0,a=document.onselectstart,n=3,d=[{speedValue:2,speedInfo:"-4x"},{speedValue:3,speedInfo:"-2x"},{speedValue:8,speedInfo:"1/2x"},{speedValue:9,speedInfo:"1x"},{speedValue:10,speedInfo:"2x"},{speedValue:11,speedInfo:"4x"}],r=(d[n].speedValue,["#438de0","#cc3333","#0a7ea2"]),c=(new Date).format("yyyy/MM/dd hh:mm:ss"),u=(new Date).format("MM/dd hh:mm:ss"),y=null,h=!0,b=(new Date).format("yyyy/MM/dd"),V=(new Date).format("yyyy/MM/dd"),E=[],f=0,v=0,k=null,_=[{fieldId:"status"},{fieldId:"timeslice"}];return new(Class.extend({init:function(){Utils.beforeDataLoad(),this.initPage(),Utils.initLang(),this.initEvent(),this.showScale(),this.initData(),Utils.initVideo("videoTD",StreamType.LIVE,RunMode.CONFIG,255),this.resetVideoWH(),Utils.afterDataLoad()},initPage:function(){var e=new Date;top.document.title=C.lang.pub.playback,!isOldPlugin&&Video.sdk_viewer.isInstalled&&Video.sdk_viewer.execFunctionReturnAll("NetSDKGetLocalPort",0),Capinfo.isSupportAudio&&(C("#audioBar").removeClass("hidden"),this.initSliderForVideo(),this.showMuteVoiceCss()),C("#year").val(e.getFullYear()),C("#month").val(e.getMonth()+1),C("#day").val(e.getDate()),Capinfo.isSupportFishIpc&&C("#buttunBar").removeClass("hidden"),setTimeout(function(){WdatePicker({skin:"whyGreen",eCont:"datePicker",onpicked:function(e){b=e.cal.getDateStr("yyyy/MM/dd"),C("#year").val(e.cal.date.y),C("#month").val(e.cal.date.M),C("#day").val(e.cal.date.d)},lang:top.wdateLang})},1),this.initSpeedSlider()},initData:function(){this.getTimeZoom();var e={},t={},a=new Date;Video.getVideoFormat(),(D=new TableView("dataview_tbody",this.getData,_)).setFields({status:function(e){return"<a class='icon pucker hidden'></a>"}}),D.setTrEvnet({ondblclick:function(){var e=Utils.getEvent(),e=e.srcElement||e.target;"TD"==e.tagName&&(e=C(e).parent("tr")),C(".playing").removeClass("playing"),e.addClass("playing"),0!=S&&Playback.stopVideoBack(),Playback.startVideoBack(C(e).attr("rowNum")),Playback.changeBtnStatus()}}),D.createDataView(),p=!0,Utils.LAPI_GetCfgData(LAPI_URL.SystemTime,e)&&(f=e.TimeZone,a=new Date(e.LocalTime.Year,e.LocalTime.Month,e.LocalTime.MonthDay,e.LocalTime.Hour),1<Math.abs(f)/100&&(f/=100)),Utils.LAPI_GetCfgData(LAPI_URL.DST_Cfg,t)&&(a=this.dstIsEnable(a,t),1==t.Enable&&1==a&&(v=t.OffsetMinute))},initEvent:function(){var t=this,i=document.getElementById("btn_digitalZoom");document.onselectstart=function(){return!1},window.onresize=t.resetVideoWH,C("#queryBtn").bind("click",function(){D.refresh(),t.checkCurrentRow(new Date(c).getTime(),!0);var e=C("#ptzAccordion");e.hasClass("hidden")&&(e.removeClass("hidden"),t.resetVideoWH())}),C("#loadBtn").bind("click",function(){var e={};Utils.LAPI_GetCfgData(LAPI_URL.RecordDownloadState,e,"",!1)&&(e=e.DownloadState,DownloadResult.DOWNLOAD_SUCCEED==e||DownloadResult.RECORD_CANCEL_DOWNLOAD==e||DownloadResult.RECORD_SEND_NUMOUT==e?(t.resetVideoWH(),Utils.openWin(C.lang.pub.recordCfg,"/page/common/operate_record.c334e98c.htm",620,550,!1,"40%","20%")):DownloadResult.RECORD_DOWNLOADING==e?Frame.showMsg(!1,C.lang.tip.tipRecordDownloading):DownloadResult.RECORD_READ_FAIL==e?Frame.showMsg(!1,C.lang.tip.tipExReadFailure):DownloadResult.RECORD_COMMON_FAIL==e?Frame.showMsg(!1,C.lang.tip.tipExRunFailure):(t.resetVideoWH(),Utils.openWin(C.lang.pub.recordCfg,"/page/common/operate_record.c334e98c.htm",620,550,!1,"40%","20%")))}),C(".plugin-bar a,.plugin-bar button").hover(function(){C(this)[0].disabled||C(this).addClass("barHover")},function(){C(this).removeClass("barHover")}),C("#btn_fishIpc").click(function(){C(this).hasClass("openFishIpc")?(C(this).removeClass("openFishIpc").addClass("closeFishIpc"),C("#ctrlFishBody").addClass("hidden"),C("#ctrlBody_playback").removeClass("hidden")):(C(this).removeClass("closeFishIpc").addClass("openFishIpc"),C("#ctrlBody_playback").addClass("hidden"),C("#ctrlFishBody").removeClass("hidden"))}),C("#backToTime").click(function(){C("#ctrlFishBody").addClass("hidden"),C("#ctrlBody_playback").removeClass("hidden"),C("#btn_fishIpc").removeClass("openFishIpc").addClass("closeFishIpc")}),C("#player-top-installation,#player-bottom-installation").click(function(){C(".button-7").removeClass("hidden"),C(".button-5").addClass("hidden")}),C("#player-side-installation").click(function(){C(".button-7").addClass("hidden"),C(".button-5").removeClass("hidden")}),C(".installMode").bind("click",function(){var e=0,t=C(".installMode");t.each(function(){C(this).hasClass("selected")&&C(this).removeClass("selected")}),C(this).addClass("selected"),t.each(function(){C(this).hasClass("selected")?(C(this).removeClass(this.id).addClass(this.id+"-open"),e=this.value):C(this).removeClass(this.id+"-open").addClass(this.id)}),C(".playMode").each(function(){C(this).hasClass("selected")&&C(this).removeClass(this.id+"-open").addClass(this.id)}),C("#player-original").removeClass("player-original").addClass("player-original-open"),Video.sdk_viewer.isInstalled&&S&&(i.disabled=!1,i.className="openDigitalZoom"),Video.sdk_viewer.execFunctionReturnAll("NetSDKSetPtzAndFixMode",0,0,Number(e))}),C(".playMode").bind("click",function(){var e=0,t=0,a=C(".playMode");a.each(function(){C(this).hasClass("selected")&&C(this).removeClass("selected")}),C(this).addClass("selected"),a.each(function(){C(this).hasClass("selected")?(C(this).removeClass(this.id).addClass(this.id+"-open"),t=this.value):C(this).removeClass(this.id+"-open").addClass(this.id)}),C(".installMode").each(function(){C(this).hasClass("selected")&&(e=this.value)}),C("#progressMouseEvent").mouseleave(function(){C("#playbackScale").addClass("hidden")}),0!=Number(t)?(i.className="noDigitalZoom",i.title=C.lang.pub.startDigitalZoom,i.disabled=!0,Video.isDigitalZoom&&(Video.isDigitalZoom=!Video.isDigitalZoom,Video.sdk_viewer.execFunctionReturnAll("NetSDKDigitalZoom",0,0))):Video.sdk_viewer.isInstalled&&S&&(i.disabled=!1,i.className="openDigitalZoom"),Video.sdk_viewer.execFunctionReturnAll("NetSDKSetPtzAndFixMode",0,Number(t),Number(e))})},submitF:function(e,t){t=Video.sdk_viewer.ViewerAxSetConfig(0,e,t);return ResultCode.RESULT_CODE_SUCCEED==t},release:function(){window.onresize=null,document.onselectstart=a,s=!1,Frame.hiddenVideo(),this.stopVideoBack()},initSliderForVideo:function(){var a=this;(g=new Slider("sliderVolume","barVolume",{onMove:function(){},showTip:!0})).MinValue=parseInt("0",10),g.MaxValue=parseInt("255",10),g.onMove=function(){var e,t;i&&(1==Video.isVoiceMute&&(Video.setSilenceStatus(0,!1),a.showMuteVoiceCss()),Video.setAdjustVolume(this.GetValue(),!1)||(e=0,!isOldPlugin&&Video.sdk_viewer.isInstalled?(t=Video.sdk_viewer.execFunctionReturnAll("NetSDKGetVolume",0),ResultCode.RESULT_CODE_SUCCEED==t.code&&(e=t.result)):isOldPlugin&&(t=Video.sdk_viewer.ViewerAxGetVolume20(),0==(t=Utils.getSDKParam(t))[0]&&(e=t[1])),isNaN(e)&&(e=0),i=!1,g.SetValue(e),i=!0))},g.SetValue(0)},getTimeZoom:function(){Utils.LAPI_GetCfgData(LAPI_URL.SystemTime,t)&&(f=t.TimeZone,1<Math.abs(f)/100&&(f/=100)),Utils.LAPI_GetCfgData(LAPI_URL.DST_Cfg,e)&&1==e.Enable&&(v=e.OffsetMinute)},getData:function(){var e,t,a,i,s=[],o={},n=0,l=0;if(p){var d=C("#year"),r=C("#month"),c=C("#day"),u=new Date(d.val(),r.val()-1,c.val(),0,0,0).getTime(),h=new Date(d.val(),r.val()-1,c.val(),23,59,59).getTime();u/=1e3,h/=1e3,V=d.val()+"/"+r.val()+"/"+c.val();do{if(Utils.LAPI_GetCfgData(LAPI_URL.RecordSearch+u+"&End="+h+"&Limit=100&Offset="+l,m))for(n=m.Total,l+=e=m.Nums,t=0;t<e;t++)o={},a=new Date(1e3*m.RecordInfos[t].Begin),i=new Date(1e3*m.RecordInfos[t].End),o.StartYear=a.getFullYear(),o.StartMonth=a.getMonth()+1,o.StartDay=a.getDate(),o.StartHour=a.getHours()<10?"0"+a.getHours():a.getHours(),o.StartMinute=a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes(),o.StartSecond=a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds(),o.EndYear=i.getFullYear(),o.EndMonth=i.getMonth()+1,o.EndDay=i.getDate(),o.EndHour=i.getHours()<10?"0"+i.getHours():i.getHours(),o.EndMinute=i.getMinutes()<10?"0"+i.getMinutes():i.getMinutes(),o.EndSecond=i.getSeconds()<10?"0"+i.getSeconds():i.getSeconds(),o.status=0,o.timeslice=Utils.formatTime(o.StartHour,o.StartMinute,o.StartSecond)+" - "+Utils.formatTime(o.EndHour,o.EndMinute,o.EndSecond),o.Begin=new Date(V+" "+o.StartHour+":"+o.StartMinute+":"+o.StartSecond).getTime(),o.End=new Date(V+" "+o.EndHour+":"+o.EndMinute+":"+o.EndSecond).getTime(),s.push(o)}while(l<n)}return 0<s.length?Playback.updateRecordProgressBar(s,V):C("#playback-union-progress").html(""),E=s},run:function(e){var t=C("#barPlay"),a=Number(t.width()),i=Number(C("#sliderPlay").width()),s=e/i*1e3,o=1,n=this;s<50&&(o=i*(s=50)/(1e3*e)),l=i<=a?(clearTimeout(l),null):(1==S&&t.css("width",100*(a+o)/i+"%"),setTimeout(function(){n.run(e)},s))},setPlaySliderPos:function(e){var t,a={},i=this;Utils.getCfgData(0,CMD_TYPE.CMD_PLAYER_POSITION,a)&&(t=Number(a.PlayerPosition),o=e<=t?(clearTimeout(o),null):(1==S&&C("#barPlay").css("width",100*t/e+"%"),setTimeout(function(){i.setPlaySliderPos(e)},1e3*e/10)))},changeBtnStatus:function(){var e=C("#btn_play"),t=C("#btn_stop"),a=C("#btn_prScrn"),i=C("#btn_digitalZoom");0==S?(e.removeClass("pausePlayback").addClass("startPlay"),e.attr("title",C.lang.pub.play),t.removeClass().addClass("stopPlayback_disable"),t.prop("disabled",!0),a.removeClass().addClass("noSnapshot"),a.prop("disabled",!0),i.removeClass().addClass("noDigitalZoom"),i.attr("title",C.lang.pub.startDigitalZoom),i.prop("disabled",!0),Video.isDigitalZoom&&Video.setDigitalZoom()):1==S?(e.removeClass().addClass("pausePlayback"),e.attr("title",C.lang.pub.pause),t.removeClass().addClass("stopPlayback"),t.prop("disabled",!1),a.removeClass().addClass("snapshot"),a.prop("disabled",!1),i.removeClass().addClass("openDigitalZoom"),i.prop("disabled",!1)):2==S&&(e.removeClass().addClass("startPlayback"),e.attr("title",C.lang.pub.play))},startVideoBack:function(e,t){var a,i,s=D.getData(e,"StartHour"),o=D.getData(e,"StartMinute"),n=D.getData(e,"StartSecond"),l=D.getData(e,"EndHour"),d=D.getData(e,"EndMinute"),r=D.getData(e,"EndSecond"),c=ResultCode.RESULT_CODE_SUCCEED,u={},h=3600*Number(l)+60*Number(d)+Number(r)-(3600*Number(s)+60*Number(o)+Number(n)),p="StartYear="+D.getData(e,"StartYear")+"&StartMonth="+D.getData(e,"StartMonth")+"&StartDay="+D.getData(e,"StartDay")+"&StartHour="+s+"&StartMinute="+o+"&StartSecond="+n+"&EndYear="+D.getData(e,"EndYear")+"&EndMonth="+D.getData(e,"EndMonth")+"&EndDay="+D.getData(e,"EndDay")+"&EndHour="+l+"&EndMinute="+d+"&EndSecond="+r;if(isOldPlugin)return(a=this.submitF(CMD_TYPE.CMD_PLAYER_START,p))&&(S=1,this.run(h),Video.isVoiceTalkOpen||Video.isVoiceMute||(Video.setSilenceStatus(0,!1),g.SetValue(128),Video.setAdjustVolume(128,!1))),a;var m,n=new Date(D.getData(e,"StartYear"),D.getData(e,"StartMonth")-1,D.getData(e,"StartDay"),s,o,n).getTime()/1e3,r=new Date(D.getData(e,"EndYear"),D.getData(e,"EndMonth")-1,D.getData(e,"EndDay"),l,d,r).getTime()/1e3;return void 0===t||(n=t+60*f*60-60*v),Utils.LAPI_GetCfgData(LAPI_URL.RecordStream,u),"localhost"==(u=(t=u.Data.URL.split("//"))[1].split(":"))[0]&&(u[0]=Frame.loginServerIp),0!=Frame.rtspPort&&-1!=(m=u[1].indexOf("/"))&&(u[1]=u[1].substring(m),u[1]=Frame.rtspPort+u[1]),t=t[0]+"//"+Frame.loginUserName+":"+Frame.loginUserPwd+"@"+u[0]+":"+u[1],Video.sdk_viewer.execFunctionReturnAll("NetSDKGetLocalPort",0),Video.sdk_viewer.execFunctionReturnAll("NetSDKEnShowVideoInfo",!1),u=Video.sdk_viewer.execFunctionReturnAll("NetSDKGetConfig"),i=C.parseJSON(u.result).VideoTransProto,c=(c=Video.sdk_viewer.execFunctionReturnAll("NetSDKOpenIPCNetStream",0,t,i,n,r,1)).code,ResultCode.RESULT_CODE_SUCCEED==c?(c=(c=Video.sdk_viewer.execFunctionReturnAll("NetSDKStartPlay",0)).code,S=1,this.run(h),Video.isVoiceMute||Video.sdk_viewer.execFunctionReturnAll("NetSDKOpenSound",0,0),Capinfo.isSupportAudio&&(Video.isVoiceTalkOpen||Video.isVoiceMute||(g.setEnable(!0),Video.setSilenceStatus(0,!1),g.SetValue(128),Video.setAdjustVolume(128,!1))),k.setEnable(!0),e=C("#dataview_tbody").find("tr").get(e),C(e).addClass("playing"),y=setTimeout(function(){C("#playbackCursor").hasClass("hidden")&&C("#playbackCursor").removeClass("hidden"),Playback.updatePlaybackTime()},1e3)):Video.sdk_viewer.execFunctionReturnAll("NetSDKFreeLocalPort",0),ResultCode.RESULT_CODE_SUCCEED==c},pauseVideoBack:function(){var e,t=!1;return 1==S?isOldPlugin?(t=this.submitF(CMD_TYPE.CMD_PLAYER_PAUSE,""))&&(S=2):(e=(e=Video.sdk_viewer.execFunctionReturnAll("NetSDKPlayBackCtrl",0,0)).code,(t=ResultCode.RESULT_CODE_SUCCEED==e)&&(S=2)):2==S&&(isOldPlugin?(t=this.submitF(CMD_TYPE.CMD_PLAYER_RESUME,""))&&(S=1):(e=(e=Video.sdk_viewer.execFunctionReturnAll("NetSDKPlayBackCtrl",0,1)).code,(t=ResultCode.RESULT_CODE_SUCCEED==e)&&(S=1))),t},stopVideoBack:function(){var e=!1;return isOldPlugin?((e=this.submitF(CMD_TYPE.CMD_PLAYER_STOP,""))&&(S=0,clearTimeout(l),l=null,clearTimeout(o),o=null,C("#barPlay").css("width","0px")),e):Video.sdk_viewer.isInstalled?(Capinfo.isSupportAudio&&(C("btn_mute").disabled=!0,g.setEnable(!1)),e=(e=Video.sdk_viewer.execFunctionReturnAll("NetSDKStopPlay",0)).code,ResultCode.RESULT_CODE_SUCCEED==e&&(e=(e=Video.sdk_viewer.execFunctionReturnAll("NetSDKCloseStream",0)).code),ResultCode.RESULT_CODE_SUCCEED==e&&(e=(e=Video.sdk_viewer.execFunctionReturnAll("NetSDKFreeLocalPort",0)).code),ResultCode.RESULT_CODE_SUCCEED==e&&(S=0,clearTimeout(l),l=null,clearTimeout(o),o=null,C("#barPlay").css("width","0px"),this.resetCursor(),k.SetValue(3),k.setEnable(!1),n=3,C(".speedTip").text(d[3].speedInfo),c="1900/01/01 00:00:00",C(".playing").removeClass("playing")),Capinfo.isSupportFishIpc&&this.resetFish(),ResultCode.RESULT_CODE_SUCCEED==e):void 0},resetFish:function(){C(".installMode").each(function(){C(this).hasClass("selected")&&(C(this).removeClass("selected"),C(this).removeClass(this.id+"-open").addClass(this.id))}),C("#player-top-installation").removeClass("player-top-installation").addClass("player-top-installation-open").addClass("selected"),C(".playMode").each(function(){C(this).hasClass("selected")&&(C(this).removeClass("selected"),C(this).removeClass(this.id+"-open").addClass(this.id))}),C("#player-original").removeClass("player-original").addClass("player-original-open").addClass("selected")},startOrPauseVideoBack_click:function(){var e,t=!1;if(Capinfo.isSupportFishIpc&&this.resetFish(),0==S){if(-1==D.currectRow)return;e=C("#dataview_tbody").find("tr").get(D.currectRow),C(e).addClass("playing"),t=this.startVideoBack(D.currectRow)}else t=this.pauseVideoBack();t&&this.changeBtnStatus()},stopVideoBack_click:function(){0!=S&&this.stopVideoBack()&&this.changeBtnStatus()},showMuteVoiceCss:function(){Video.isVoiceMute?(C("#btn_mute").removeClass("openAdjustVoice").addClass("closeAdjustVoice"),C("#sliderVolume").removeClass("slider3").addClass("slider4"),C("#barVolume").addClass("bar4"),document.getElementById("btn_mute").title=C.lang.pub.audioOn):(C("#btn_mute").removeClass("closeAdjustVoice").addClass("openAdjustVoice"),C("#sliderVolume").removeClass("slider4").addClass("slider3"),C("#barVolume").removeClass("bar4"),document.getElementById("btn_mute").title=C.lang.pub.audioOff)},muteVoice:function(){var e=Video.isVoiceMute?0:1;Video.setSilenceStatus(e,!1),this.showMuteVoiceCss()},ditigalZoom:function(){!Video.isDigitalZoom&&Video.isOpticsZoom&&this.opticsZoom(),Video.setDigitalZoom(),this.eventSetDigitalZoom()},setVideoWidthAndHeight:function(){var e;Video.isFullScreen||(Frame.changeVideoSize(Video.videoWidth,Video.videoHeight),e=C("#videoType").val(),this.setRenderScale(e))},setRenderScale:function(e){Video.setRenderScale(e,1)},eventSetDigitalZoom:function(){var e=Video.isDigitalZoom?"closeDigitalZoom":"openDigitalZoom",t=Video.isDigitalZoom?C.lang.pub.stopDigitalZoom:C.lang.pub.startDigitalZoom,a=C("#btn_digitalZoom");a.removeClass().addClass(e),a.attr("title",t)},resetVideoWH:function(){var e,t=C("#ptzPresetBody"),a=C("#ctrlPanel");e=a.height()-(t.offset().top-a.offset().top)-20,t.css("height",e),s&&(t=(a=C("#videoTD")).width(),e=a.height(),C("#videoDiv").css({width:t+"px",height:e+"px"}))},initSpeedSlider:function(){k=new Slider("sliderSpeed","barSpeed",{onMove:function(){var e,t;h&&0!=S&&(e=Math.round(this.GetValue()),t=top.sdk_viewer.execFunctionReturnAll("NetSDKPlaySpeed",0,d[e].speedValue),ResultCode.RESULT_CODE_SUCCEED==t.code&&(2==S&&(S=1),n=e,C(".speedTip").text(d[e].speedInfo)))},MinValue:0,MaxValue:5,showTip:!1}),h=!1,k.SetValue(3),h=!0,k.setEnable(!1)},showScale:function(){var e,t={hour:0,minute:0},a=C.extend(!0,{},t),i=0,s=C("#playbackUnionScale");for(s.html();i<=24;){if(a.hour=t.hour+i,e=(i/24).toPercent(2),24===i)return void s.append('<div class="playback-scale-hour" style="left: '+e+';"><p class="playback-scale-txt"></p></div>');s.append('<div class="playback-scale-hour" style="left: '+e+';"><p class="playback-scale-txt">'+function(e){var t="";1==e.hour.toString().length&&(t+="0");t+=e.hour+":",1==e.minute.toString().length&&(t+="0");return t+=e.minute+""}(a)+"</p></div>"),i+=2}},updateRecordProgressBar:function(e,t){var a,i,s=C("#playback-union-progress"),o=new Date(t+" 00:00:00").getTime();if(s.html(""),C("#playbackCursor").addClass("hidden"),y&&(clearInterval(y),y=null),0!=e.length)for(var n=0;n<e.length;n++)i=e[n].End-e[n].Begin,a=((e[n].Begin-o)/864e5).toPercent(2),i=(i/864e5).toPercent(2),s.append('<div class="playback-record" style="left:'+a+"; width:"+i+"; background-color:"+r[0]+';"></div>')},updatePlaybackTime:function(){var e=top.sdk_viewer.execFunctionReturnAll("NetSDKGetPlayTime",0);ResultCode.RESULT_CODE_SUCCEED==e.code&&(e=e.result,this.setCursorPosition(e)),EnumVideoStatus.Stop!=S&&(y=setTimeout(function(){Playback.updatePlaybackTime()},1e3))},setCursorPosition:function(e){var t=new Date(2015,0,1),a=new Date(2015,6,1),i=(Math.min(-t.getTimezoneOffset(),-a.getTimezoneOffset()),new Date(1e3*e)),s=i.getHours(),o=i.getMinutes(),n=i.getSeconds(),l=C("#playback-union-progress"),t=C(".playback-cursor-time"),a=l.width(),e=C(".playback-cursor"),l=(new Date).format("MM/dd hh:mm:ss");c=i.format("yyyy/dd hh:mm:ss"),l=i.format("MM/dd hh:mm:ss"),C(".playback-cursor-time").text(l),e.css("left",(s=s+o/60+n/3600)/24*a+18),s/24*a+t.width()+6>a+20?(t.css("left","auto"),t.css("right","6px")):(t.css("left","6px"),t.css("right","auto"))},clickProgressBarEvent:function(e){e=e||window.event;var t=C("#playback-union-progress"),e=(e.clientX-t.offset().left)/t.width()*24,t={h:Math.floor(e),m:Math.floor(e%1*60),s:Math.floor(60*e%1*60)},e=new Date(b.split("/")[0],b.split("/")[1]-1,b.split("/")[2],t.h,t.m,t.s)/1e3-60*f*60-60*v,t=new Date(b+" "+t.h+":"+t.m+":"+t.s).getTime();this.setRecordTime(t,e)},setRecordTime:function(e,t){var a=E;EnumVideoStatus.Stop!=S&&this.stopVideoBack_click(),0!=a.length&&(isNaN(e)||(e=this.checkCurrentRow(e))!=a.length&&this.startVideoBack(e,t)&&(k.SetValue(n),top.sdk_viewer.execFunctionReturnAll("NetSDKPlaySpeed",0,d[n].speedValue),Playback.changeBtnStatus()))},checkCurrentRow:function(e,t){for(var a=0,i=0;i<E.length&&!(E[i].Begin<=e&&E[i].End>=e);i++)a++;var s=C("#dataview_tbody").find("tr").get(a);return C(".playing").removeClass("playing"),a==E.length?this.resetCursor():(C(s).addClass("playing"),EnumVideoStatus.Stop!==S&&1==t&&(this.updatePlaybackTime(),C("#playbackCursor").hasClass("hidden")&&C("#playbackCursor").removeClass("hidden"))),a},updateScaleInfo:function(e){e=e||window.event;C("#playbackScale").removeClass("hidden");var t=C("#playback-union-progress"),a=C(".playback-scale"),i=C(".playback-scale-time"),s=e.clientX-t.offset().left,o=t.width(),n=s/o*24,e=Math.floor(n),t=Math.floor(n%1*60),n=Math.floor(60*n%1*60);s<0||o<s?this.hideScaleInfo():(s+i.outerWidth()/2>o+20?i.css("left","-"+(i.outerWidth()-(o+20-s))+"px"):20+s<i.outerWidth()/2?i.css("left","-"+(20+s)+"px"):i.css("left","-"+i.outerWidth()/2+"px"),a.css("left",18+s),u=new Date(b+" "+e+":"+t+":"+n).format("MM/dd hh:mm:ss"),C(".playback-scale-time").text(u))},showScaleInfo:function(){C("#playbackScale").removeClass("hidden")},hideScaleInfo:function(){C("#playbackScale").addClass("hidden")},resetCursor:function(){C("#playbackCursor").addClass("hidden"),y&&(clearInterval(y),y=null)},getDstDateToUTC:function(e,t,a,i,s){var o=new Date(e,t,1).getDay(),n=0,l=0,d=[31,28,31,30,31,30,31,31,30,31,30,31];(0==e%400||0!=e%100&&0==e%4)&&(d[1]=29);for(var r=1;r<=d[t]&&(o!==i||(l=r,++n!==a));r++)o=(o+1)%7;return new Date(e,t,l,s).getTime()},dstIsEnable:function(e,t){var a=e.getFullYear(),i=(e.getMonth(),e.getTime()),e=this.getDstDateToUTC(a,t.BeginTime.Month,t.BeginTime.WeekNum,t.BeginTime.WeekDay,t.BeginTime.Hour),t=this.getDstDateToUTC(a,t.EndTime.Month,t.EndTime.WeekNum,t.EndTime.WeekDay,t.EndTime.Hour);return t<e?i<t||e<i:e<i&&i<t}}))}(jQuery),Frame.currentNameSpace=Playback;