Utils.$package("Config"),Utils.$package("Frame"),Frame=function(h){var d,r=null,t=0,n=null,l={},m={};top.gunBallPort=80,top.gunBallIpAddress=null;var a=window.location.href;parent.StreamID=0,parent.VideoType=VideoType.LIVE,parent.userType=UserType.Operator,Capinfo.getCapInfo(),Capinfo.isSupportFishEye&&(parent.StreamID=10),parent.IsRemote=top.IsRemote,top.IsTempCert=0,top.IsPasswordChanged=!1;var e=parent.window.location.search;-1<e.indexOf("style=")&&(e=e.substring(e.indexOf("style=")),parent.style=e.substring(0,e.indexOf("&")).replace("style=",""));e=80,e="https:"==document.location.protocol?""==window.location.port?443:window.location.port:""==window.location.port?80:window.location.port;return top.isAlertPwdChanged=!1,new(Class.extend({autoSnapStream:!1,enhanceMode:0,startPresetID:1,kakou2Map:{Enabled:0,Time:1,OpenNum:0},endPresetID:Capinfo.PresetNum,isShowPtzForHTS:!1,IVAType:IVAMode.TG,IVACommonType:IVACommonMode.PERIMETER,StartVideoTimeID:null,DefaultStreamID:0,LiveMode:-1,IsAutoStartVideo:!0,PageBlockType:BlockType.UNCONNECTED,isShowIVASpecialParam:!1,titleDeviceType:"",prototypeName:"",prototypeCfg:"",exportLog:!1,loginType:top.loginType,loginUserName:top.loginUserName,loginUserPwd:top.loginUserPwd,loginServerIp:top.loginServerIp,loginClientIp:top.loginClientIp,sdkPort:top.SDKPort,httpPort:e,rtspPort:top.RTSPPort,menuType:top.menuType,eventMsgList:[],updateTime:null,updateStatus:!1,updateMsg:!1,currentNameSpace:"",openWinNameSpace:"",opener:null,versionInfo:"",IVAZoomMark:"",type:1,userMap:{},isFriendPasswordEnable:!1,RSAPublicKeyE:"",RSAPublicKeyN:"",RSAKey:{},auzType:0,RegSubID:-1,RegSubIP:"",RegSubPort:0,RegSubUrl:LAPI_URL.Subscription,RegSubUrlID:"",RegSubTimerID:null,smartMapping:{0:h.lang.pub.faceDetectTitle,1:h.lang.pub.peopleCountMenu,2:h.lang.pub.twCapture,3:h.lang.pub.smartTrackLink,4:h.lang.pub.Chain_Calculation,100:h.lang.pub.crossBorderTitle,101:h.lang.pub.ruleType_stay,102:h.lang.pub.enterArea,103:h.lang.pub.leaveArea,104:h.lang.pub.wanderDetect,105:h.lang.pub.fastMove,106:h.lang.pub.GunBallLink,199:h.lang.pub.alarmMenu,200:h.lang.pub.peopleGather,201:h.lang.pub.parkDetect,202:h.lang.pub.leftGood,203:h.lang.pub.handleGood,204:h.lang.pub.virtualFocusTitle,205:h.lang.pub.sceneChangeTitle,206:h.lang.pub.heatMap,299:h.lang.pub.alarmAbnorMenu},init:function(){},init2:function(){var e;Utils.GlobalInvoke(window),LoginType.VM_LOGIN!=this.loginType&&top.defaultUserName!=this.loginUserName||!Capinfo.isSupportHorizontalMenu||(parent.userType=UserType.Administrator),"undefined"!=typeof showDeviceType&&(this.titleDeviceType=showDeviceType.split("@")[0]),"undefined"!=typeof showDeviceName&&(e=showDeviceName.split("@"),this.prototypeName=e[0],this.prototypeCfg=1==e.length?"":e[1]),Capinfo.isSupportIVAZoomMark&&(e={},Utils.LAPI_GetCfgData(LAPI_URL.IVAZoomMarkFlag,e),this.IVAZoomMark=e.Enable),Utils.beforeDataLoad(),this.initPage(),this.lisenceEvent(),this.keepAlive(),Utils.afterDataLoad()},initPage:function(){var e=ResultCode.RESULT_CODE_SUCCEED,t=[],a=this,i=h("#homePage"),s=[];if(h("#logoImg").attr("src","/skin/default_1/images/logo.png?t="+(new Date).getTime()),SkinStyle.Gray==top.style?s.push("/skin/gray/gray.75b11240.css"):SkinStyle.Black==top.style&&(s.push("/skin/black/dataview.f7292420.css"),s.push("/skin/black/black.16395270.css")),h("#warningImg").attr("src",warningSrc[Capinfo.skinType]),Capinfo.isUniarch&&s.push("/skin/uniarch/css/customized.56726c6e.css"),s.push("/skin/static/css/customized.css"),Utils.loadCss("skinCss",s),Utils.loadHtml("video","/page/common/sdkviewer.00b1d26a.htm"),LoginType.EZS_LOGIN==this.loginType)h("#titleTR").addClass("hidden"),i.css("background",""),h("#bodyDiv").removeClass("content"),7==this.menuType&&(h("#configTitle").addClass("hidden"),h("#menu").addClass("hidden"));else if(LoginType.VM_LOGIN==this.loginType){if(h("#titleTR").addClass("hidden"),i.css("background",""),h("#configTitle").addClass("hidden"),h("#menu").addClass("hidden"),i.removeClass("mainDiv"),i.css({width:"100%",height:"100%"}),h("#configContainer").addClass("VM_top"),h("#bodyDiv").removeClass("content"),h("body").append("<object classid='clsid:C94369C1-B0E4-43d8-893A-2DE60804600A' id='recordManager_activeX' events='true' style='width: 0;height: 0;position:absolute;'></object>"),n=document.getElementById("recordManager_activeX"),i=null==Utils.getparastr("IsVMNB",location.href)?0:Utils.getparastr("IsVMNB",location.href),n.ViewerAxSetLocalCfgEx(i="IsVMNB="+i),e=n.ViewerAxGetVMUserInfo20(),t=Utils.getSDKParam(e),!(ResultCode.RESULT_CODE_SUCCEED==t[0]))return void this.pageLogout(h.lang.tip.tipOcxInitInvalidUser);t=t[1].split("&");if(this.loginUserName=t[0],this.loginUserPwd=t[1],!Utils.LAPI_SetCfgData(LAPI_URL.webLoginCfg,{},!1,function(e){a.queryStatus(e)}))return}this.afterPlugInit(),!this.isShowPtzForHTS&&Capinfo.isSupportRealtimeStatus&&LoginType.VM_LOGIN!=this.loginType&&7!=this.menuType&&h("#RTStatus").removeClass("hidden"),Capinfo.isSupportIpcCapture&&(document.getElementById("TmsReg").innerText=h.lang.pub.smartServerTip),Capinfo.isSupportVM||h("#VmRegStatusDiv").addClass("hidden"),Capinfo.isSupportCustomerService&&h("#help").removeClass("hidden")},initData:function(){},initEvent:function(){var i=this,s=h(".fixLine");document.onkeydown=this.showVersion,h("#modifyPwd").bind("click",function(){i.modifyPwd()}),h("#cancelBar").bind("click",function(){i.cancelBar()}),h("#nav_live").bind("click",function(){i.nav_click("nav_live")}),h("#nav_photo").bind("click",function(){i.nav_click("nav_photo")}),h("#nav_playback").bind("click",function(){i.nav_click("nav_playback")}),h("#nav_config").bind("click",function(){i.nav_click("nav_config")}),h("#nav_maintain").bind("click",function(){i.nav_click("nav_maintain")}),h("#logout").bind("click",function(){confirm(h.lang.tip.tipCfmLogout)&&i.logout()}),h("#help").bind("click",function(){Utils.openWin(h.lang.pub.service,"/page/common/help_page.42313445.htm?id=help",658,277,!0,"25%","30%",!0,"body")}),h(window).scroll(function(){var e=0,t=h(window).scrollLeft(),a=h(window).scrollTop();if(Config.alarmMotion)e=Config.alarmMotion.menuTop;else{if(!Config.smart_areadetect)return;e=Config.smart_areadetect.menuTop}LoginType.VM_LOGIN==i.loginType?(s.css("left",35-t),s.css("top","0px")):(s.css("left",h("#menu").width()+35-t),s.css("top",e-a))}),h(window).resize(function(){var e=0,t=h(window).scrollLeft(),a=h(window).scrollTop();if(Config.alarmMotion)e=Config.alarmMotion.menuTop;else{if(!Config.smart_areadetect)return;e=Config.smart_areadetect.menuTop}LoginType.VM_LOGIN==i.loginType?(s.css("left",35-t),s.css("top","0px")):(s.css("left",h("#menu").width()+35-t),s.css("top",e-a))}),h("#mainIframe").bind("load",function(){top.status=""})},release:function(){LoginType.VM_LOGIN==this.loginType?n.ViewerAxUnreg():top.sdk_viewer&&top.sdk_viewer.isInstalled&&(Video.NetSDKStopPlay(top,0),Video.NetSDKUnRegSubscription(top),top.IsPasswordChanged||(Utils.LAPI_DelCfgData(Frame.RegSubUrlID,{},!1),this.RegSubID=-1,clearTimeout(Frame.RegSubTimerID)),(Capinfo.isSupportCapture||Capinfo.isSupportIpcCapture)&&(Video.NetSDKStopPlay(top,2),Video.NetSDKStopPlayLocalJPG(top,1)),top.sdk_viewer.unInit())},modifyPwd:function(){this.opener=this,Utils.openWin(h.lang.pub.changePwdTitle,"/page/common/userinfo_edit.2b99b596.htm?id=userInfo",520,450,!1,"10%","10%",!0,"body")},getIVAType:function(){this.IVAType=IVAMode.ILLEGAL,this.isShowPtzForHTS=!0},saveHerfParam:function(){var e="?langinfo="+top.language;return 0!=this.rtspPort&&(e+="&SDKPort="+this.sdkPort+"&RTSPPort="+this.rtspPort),e},pageLogout:function(e){LoginType.WEB_LOGIN==this.loginType?(undefined!=e&&alert(e),a=a.substring(0,a.indexOf(window.location.pathname)),top.window.location=a+this.saveHerfParam()):(undefined==e&&(e=h.lang.pub.tipReboot),top.window.location="/page/common/error.ed862bc7.htm?langinfo="+top.language+"&ErrorMsg="+e)},userLogout:function(){confirm(h.lang.tip.tipCfmLogout)&&this.pageLogout()},showMsg:function(e,t,a){null!==r&&(clearTimeout(r),r=null);var i="black",s=2e3,n=h("#msgDiv"),o=h("#msg");n.find("a").removeClass(),n.find("a").addClass("icon"),e?"undefined"!=a&&0==a?n.find("a").addClass("warn"):n.find("a").addClass("success"):(i="red",s=5e3,n.find("a").addClass("fail")),n.css("color",i),LoginType.WEB_LOGIN!=this.loginType&&LoginType.DDNS_LOGIN!=this.loginType&&(n.css({top:"10px",width:"380px"}),i=(i=h("#contentDiv")).position().left+(i.width()-n.width())/2,LoginType.VM_LOGIN!=this.loginType||2!=this.menuType&&5!=this.menuType&&6!=this.menuType||(i+=200),n.css("left",i+"px")),t?o.html(t):e?o.html(h.lang.tip.tipSetCfgSucceeded):o.html(h.lang.tip.tipSetCfgFail),n.is(":visible")?(n.stop(),1==n.css("opacity")&&n.fadeTo(100,0),n.fadeTo(200,1)):(n.removeClass("hidden"),n.fadeIn(300)),r=setTimeout(function(){h("#msgDiv").fadeOut(700,function(){h("#msgDiv").addClass("hidden"),r=null})},s)},updateBlock:function(e,t){e?(void 0===t?h("#statusInfo").addClass("hidden"):(h("#statusInfo").text(t),h("#statusInfo").removeClass("hidden")),h("#statusInfo").text(t),h.blockUI({message:h("#boxImg"),css:{border:"none",backgroundColor:""}}),document.onkeydown=""):(h.unblockUI(),document.onkeydown=this.showVersion),window.focus()},initLoginType:function(e){var t=e||this.menuType;if(top.IsTempCert)this.opener=this,Utils.openWin(h.lang.pub.changePwdTitle,"/page/common/userinfo_edit.2b99b596.htm?id=userInfo",520,495,!1,"10%","10%",!0,"body");else if(this.opener=this,parent.userType!=UserType.Administrator||!Capinfo.isUN||"admin"!=this.loginUserPwd&&"123456"!=this.loginUserPwd){if(0==Utils.checkStrong(this.loginUserPwd)||1==Utils.checkStrong(this.loginUserPwd)){var a={};if(Utils.LAPI_GetCfgData(LAPI_URL.DeviceWorkMode,a),!this.isFriendPasswordEnable&&2!=a.Mode)return Utils.openWin(h.lang.pub.changePwdTitle,"/page/common/userinfo_edit.2b99b596.htm?id=userInfo",520,495,!1,"32.5%","30%",!0,"body"),h("#titleBar a").addClass("hidden"),void h(h(".button").get(1)).addClass("hidden");h("#changePwd").attr("data-lang","changeWeakPwd"),h("#confirmDiv").slideDown(),setTimeout(this.cancelBar,6e3)}else if(VersionType.IN==Capinfo.versionType&&(0==Utils.checkStrong(this.loginUserPwd)||1==Utils.checkStrong(this.loginUserPwd)||2==Utils.checkStrong(this.loginUserPwd))){if(!this.isFriendPasswordEnable)return Utils.openWin(h.lang.pub.changePwdTitle,"/page/common/userinfo_edit.2b99b596.htm?id=userInfo",520,495,!1,"32.5%","30%",!0,"body"),h("#titleBar a").addClass("hidden"),void h(h(".button").get(1)).addClass("hidden");h("#changePwd").attr("data-lang","changeWeakPwd"),h("#confirmDiv").slideDown(),setTimeout(this.cancelBar,6e3)}}else{if(!this.isFriendPasswordEnable)return Utils.openWin(h.lang.pub.changePwdTitle,"/page/common/userinfo_edit.2b99b596.htm?id=userInfo",520,495,!1,"32.5%","30%",!0,"body"),h("#titleBar a").addClass("hidden"),void h(h(".button").get(1)).addClass("hidden");h("#changePwd").attr("data-lang","changePwd"),h("#confirmDiv").slideDown()}if(h("#homePage").removeClass("hidden"),LoginType.WEB_LOGIN!=this.loginType||e)"nav_playback"==Menu.menuDefaultPage[t]?h("#nav_playback").trigger("click",["nav_playback"]):"nav_photo"==Menu.menuDefaultPage[t]?h("#nav_photo").trigger("click",["nav_photo"]):(e=Menu.menuDefaultPage[t],t=Menu.getModuleNameByTabID(e),h("#"+t).attr("data-defaultLink",e),Menu.selectItem(e),Menu.menuLink_click(t));else{try{parent.moveTo(0,0),parent.resizeTo(screen.availWidth,screen.availHeight)}catch(i){}h("#nav_live").trigger("click",["nav_live"])}},showUpdateResult:function(e){var t,a="",i=!0;switch(e=parseInt(e)){case UpdateResult.FILEFINISH:case UpdateResult.INPROCESS:a=h.lang.tip.tipSysUpdating;break;case UpdateResult.SUCCESS:a=h.lang.tip.tipSysUpdateSuccess;break;case UpdateResult.FAIL:a=h.lang.tip.tipSysUpdateCheckFileErr;break;case UpdateResult.NOMEMORY:i=!1,a=h.lang.tip.tipSysUpdateMemoryErr;break;case UpdateResult.FILE_OPEN_ERR:a=h.lang.tip.tipSysUpdateFileOpenErr;break;case UpdateResult.FILE_TYPE_ERR:a=h.lang.tip.tipSysUpdateFileMatchErr;break;case UpdateResult.VERSION_ERR:a=h.lang.tip.tipSysUpdateVerMatchErr;break;case UpdateResult.DEVICE_ERR:i=!1,a=h.lang.tip.tipSysUpdateWriteErr;break;case UpdateResult.BUSY:a=h.lang.tip.tipSysUpdateConfictErr;break;case UpdateResult.CRC_ERR:a=h.lang.tip.tipSysUpdateCrcCheckErr;break;case UpdateResult.INIT_ERR:a=h.lang.tip.tipSysUpdateInitErr;break;case UpdateResult.MD5_ERR:a=h.lang.tip.tipSysUpdateMd5CheckErr;break;case UpdateResult.SUCCESS_REBOOT:a=h.lang.tip.tipSysUpdateSuccess;break;default:a=1001<=e&&e<=1100||UpdateResult.WAIT_RECEIVE_DATA==e?h.lang.tip.tipSysUpdating:(i=!1,h.lang.tip.tipSysUpdateUploadErr)}UpdateResult.INPROCESS==e||1001<=e&&e<=1100||UpdateResult.WAIT_RECEIVE_DATA==e||UpdateResult.FILEFINISH==e||(clearTimeout(this.updateTime),this.updateMsg=!0,Config.configManage&&Config.configManage.showResult("updateStatusDiv",UpdateResult.SUCCESS==e||UpdateResult.SUCCESS_REBOOT==e,a)),UpdateResult.SUCCESS!=e&&UpdateResult.SUCCESS_REBOOT!=e||(this.updateStatus=!0,a=h.lang.tip.tipSysUpdateSuccessII),i?(0<(t=h("#statusInfo")).length&&t.text(a),h("#videoDiv").hasClass("waiting")&&h("#waitingImg").addClass("hidden")):this.updateBlock(!1)},showUpdateCloudResult:function(e){var t,a="",i=!0;switch(e=parseInt(e)){case UpdateCloudResult.FILEFINISH:case UpdateCloudResult.INPROCESS:a=h.lang.tip.tipSysUpdating;break;case UpdateCloudResult.SUCCESS:a=h.lang.tip.tipSysUpdateSuccess;break;case UpdateCloudResult.FAIL:a=h.lang.tip.tipSysUpdateCheckFileErr;break;case UpdateCloudResult.NOMEMORY:i=!1,a=h.lang.tip.tipSysUpdateMemoryErr;break;case UpdateCloudResult.FILE_OPEN_ERR:a=h.lang.tip.tipSysUpdateFileOpenErr;break;case UpdateCloudResult.FILE_TYPE_ERR:a=h.lang.tip.tipSysUpdateFileMatchErr;break;case UpdateCloudResult.VERSION_ERR:a=h.lang.tip.tipSysUpdateVerMatchErr;break;case UpdateCloudResult.DEVICE_ERR:i=!1,a=h.lang.tip.tipSysUpdateWriteErr;break;case UpdateCloudResult.BUSY:a=h.lang.tip.tipSysUpdateConfictErr;break;case UpdateCloudResult.CRC_ERR:a=h.lang.tip.tipSysUpdateCrcCheckErr;break;case UpdateCloudResult.INIT_ERR:a=h.lang.tip.tipSysUpdateInitErr;break;case UpdateCloudResult.MD5_ERR:a=h.lang.tip.tipSysUpdateMd5CheckErr;break;case UpdateCloudResult.WAIT_RECEIVE_DATA:a=h.lang.tip.tipSysUpdating;break;default:a=1001<=e&&e<=1100?h.lang.tip.tipSysUpdating:(i=!1,h.lang.tip.tipSysUpdateUploadErr)}UpdateCloudResult.INPROCESS==e||1001<=e&&e<=1100||UpdateCloudResult.FILEFINISH==e||UpdateCloudResult.WAIT_RECEIVE_DATA==e||Config.configManage.showResult("cloudUpdateStatus",UpdateCloudResult.SUCCESS==e,a),UpdateCloudResult.SUCCESS==e&&(this.updateStatus=!0,a=h.lang.tip.tipSysUpdateSuccessII),top.showedFlag=!0,i?(0<(t=h("#statusInfo")).length&&t.text(a),h("#videoDiv").hasClass("waiting")&&h("#waitingImg").addClass("hidden")):this.updateBlock(!1)},keepAlive:function(){this.GetKeepAliveData(LAPI_URL.KeepAlive,{},"",!1,function(e){Frame.keepAliveCallback(e)},{"async":!0})},keepAliveCallback:function(e){this.exportLog&&(e=ResultCode.RESULT_CODE_SUCCEED),ResultCode.RESULT_CODE_SUCCEED==e?(0<t&&BlockType.UNCONNECTED!=this.PageBlockType&&Frame.autoLogin(),t=0):3===++t&&(top.sdk_viewer&&top.sdk_viewer.isInstalled&&(Utils.LAPI_DelCfgData(Frame.RegSubUrlID,{},!1),Frame.RegSubID=-1,clearTimeout(Frame.RegSubTimerID)),Video.isSleepReplay=!0,20<h("#videoDiv").width()&&(h("#waitingImg").addClass("hidden"),h("#video").addClass("video_hidden")),BlockType.UNCONNECTED==this.PageBlockType&&this.updateBlock(!0,h.lang.tip.tipDisconnection2),setTimeout(function(){Frame.autoLogin()},3e4)),t<3&&setTimeout(function(){Frame.keepAlive()},1e4)},GetKeepAliveData:function(i,s,n,o,r,l){var e=(new Date).getTime();""==Utils.getCookie("WebLoginHandle")&&Utils.setCookie("WebLoginHandle",e);var p=s.authorization;void 0!==p&&delete s.authorization,null!=top.responseAuthInfo&&(p=Utils.web_Digest(top.responseAuthInfo,i,"GET"));var t=void 0===n?"":n,d=!0,e=!1,u=this;return i=0<=i.indexOf("?")?i+"&randomKey="+(new Date).getTime():i+"?randomKey="+(new Date).getTime(),void 0!==l&&"undefined"!=typeof l["async"]&&(e=l["async"]),h.ajax({type:"GET","async":e,url:i,data:t,dataType:"json",timeout:5e3,beforeSend:function(e){void 0!==p&&e.setRequestHeader("Authorization",p)},success:function(e,t,a){d=ResultCode.RESULT_CODE_SUCCEED==e.Response.StatusCode,3==e.Response.ResponseCode?(e.Response.SubResponseCode,"200"==a.status&&(top.responseAuthInfo=a.getResponseHeader("WWW-Authenticate")),p=Utils.web_Digest(top.responseAuthInfo,i,"GET"),"false"!=top.stale?(s.authorization=p,d=u.GetKeepAliveData(i,s,n,o,r,l)):(a=h.lang.tip.tipUserInfoChanged,top.isAlertPwdChanged||(Frame.pageLogout(a),top.isAlertPwdChanged=!0))):r&&r instanceof Function&&r(e.Response.StatusCode,s,l)},error:function(){d=!1,r&&r instanceof Function&&r(ResultCode.RESULT_CODE_KEEPALIVEFAIL,{},l)}}),d},startVideoCallback:function(e,t,a){var i=!1,s=a.wndID,n=0,o=0,a=!1,r=this,n=2==s&&(Capinfo.isSupportHorizontalMenu||Capinfo.isSupportIpcCapture)?Capinfo.maxStreamNum+1:(Capinfo.isSupportPersonPhoto?Video.statusList[0]:Video.statusList[s]).streamID;Capinfo.isSupportPTZ&&(o=1),this.currentNameSpace.startstopVideo&&(a=!0),(i=ResultCode.RESULT_CODE_SUCCEED==e&&!Video.isSleepReplay?2==s&&(Capinfo.isSupportHorizontalMenu||Capinfo.isSupportIpcCapture||Capinfo.isSupportPersonPhoto&&Frame.autoSnapStream&&Frame.isLivePageStartVideo)?Video.startJpeg():Video.startVideo(n,!1,s,o,a):i)?(h("#videoDiv").removeClass("waiting"),h("#videoMsg").addClass("hidden"),Video.statusList[s]&&Video.statusList[s].bRecEnabled&&(Video.statusList[s].bRecEnabled=!1,Live.startStopRecord()),Live&&h("#blockDiv").css("display","none")):setTimeout(function(){r.autoStartStream(n,s)},3e3)},autoStartStream:function(e,t){var i=this;this.GetKeepAliveData(LAPI_URL.KeepAlive,{},"",!1,function(e,t,a){i.startVideoCallback(e,t,a)},{"async":!0,wndID:t})},subscriptionCallback:function(e,t){ResultCode.RESULT_CODE_SUCCEED==e&&(Frame.RegSubID=t.CreatedID,Frame.RegSubUrlID=t.ResponseURL)},InfoSubscription:function(){var e=this,t={Index:e.RegSubID,IP:e.RegSubIP,Port:e.RegSubPort,Type:8,Duration:3600};-1==t.Index?Utils.LAPI_CreateCfgData(e.RegSubUrl,t,!1,e.subscriptionCallback):Utils.LAPI_SetCfgData(e.RegSubUrlID,t,!1,e.subscriptionCallback),null!=this.StartVideoTimeID&&clearTimeout(this.RegSubTimerID),this.StartVideoTimeID=setTimeout(function(){e.InfoSubscription()},35e5)},autoLogin:function(){var e="";if(t=this.GetKeepAliveData(LAPI_URL.KeepAlive,{})){if(BlockType.UPDATE==this.PageBlockType&&this.updateStatus||BlockType.PRODUCT_SWITCH==this.PageBlockType||BlockType.RELOGIN==this.PageBlockType||BlockType.CUSTOM_UPDATE==this.PageBlockType)return e=(BlockType.CUSTOM_UPDATE==this.PageBlockType?h.lang.tip.tipCustomUpdate:BlockType.UPDATE==this.PageBlockType?h.lang.tip.tipSysUpdateSuccessIII:BlockType.RELOGIN==this.PageBlockType?h.lang.tip.tipCustomModelRelogin:h.lang.tip.tipProductSwitchSuccess).replace("%s1","<a href='#' onclick='Frame.pageLogout()'>").replace("%s2","</a>"),void h("#statusInfo").html(e);top.sdk_viewer.isInstalled&&(e=Utils.getIpType1(window.location.hostname),t=Video.NetSDKGetLocalIP(top),ResultCode.RESULT_CODE_SUCCEED==t.code&&(this.RegSubIP=t.result),t=Video.NetSDKGetRegSubPort(top,e),ResultCode.RESULT_CODE_SUCCEED==t.code&&(this.RegSubPort=t.result,null!==this.RegSubTimerID&&clearTimeout(this.RegSubTimerID),this.InfoSubscription())),this.updateBlock(!1),clearTimeout(this.updateTime),this.updateMsg||BlockType.UPDATE!=this.PageBlockType||this.currentNameSpace.showResult("updateStatusDiv",!1,h.lang.tip.tipSysUpdateTimeout),this.PageBlockType=BlockType.UNCONNECTED;var t=h("#videoDiv");Capinfo.isSupportHorizontalMenu?t.hasClass("waiting")?h("#waitingImg").removeClass("hidden"):t.is(":visible")&&h("#video").removeClass("hidden"):20<t.width()&&(h("#waitingImg").removeClass("hidden"),h("#video").removeClass("video_hidden")),Video.isVoiceTalkOpen&&(Video.stopVoiceTalk(),window.frames.mainIframe.startstopTalk?window.frames.mainIframe.startstopTalk():Video.startVoiceTalk()),Video.isSleepReplay=!1,Capinfo.isSupportRealtimeStatus&&!Capinfo.isMac&&this.getRealtimeStatusInfo(),this.currentNameSpace.onCruiseStatus&&!Capinfo.isSupportHorizontalMenu&&(t={},Utils.LAPI_GetCfgData(LAPI_URL.PTZStatus,t)&&7==t.StatusID&&this.currentNameSpace.onCruiseStatus(t.StatusParam)),this.keepAlive()}else setTimeout(function(){Frame.autoLogin()},5e3)},showVersion:function(e){var t,a,i={},s={};if("block"!=h("#blockDiv").css("display")){var n,o=Utils.getEvent(),r=(e=e||o).keyCode||e.which||e.charCode,l=h("#debuggerCfgIVABallLink"),p=h("#manualbackfocusBtns"),o=h("#manualbackfocusBtns_live");if(Capinfo.isSupportMBF&&KEY_CODE.keyM==r&&e.shiftKey&&e.ctrlKey&&e.altKey&&(p.is(":hidden")?p.removeClass("hidden"):p.addClass("hidden"),0<o.length&&(o.is(":hidden")?o.removeClass("hidden"):o.addClass("hidden"))),Capinfo.isSupportDebugger){if(KEY_CODE.keyD==r&&e.shiftKey&&e.ctrlKey&&e.altKey&&(Capinfo.isSupportCapture?((n=h("#debuggerCfgLink")).is(":hidden")?n.parent().removeClass("hidden"):(n.parent().hasClass("navigation-active")&&h("#systemCfgLink").trigger("click"),n.parent().addClass("hidden")),l.is(":hidden")?l.parent().removeClass("hidden"):(l.parent().hasClass("navigation-active")&&h("#systemCfgLink").trigger("click"),l.parent().addClass("hidden"))):(n=h("#debuggerOthersLink")).parent().prev("div").is(":hidden")?n.parent().prev("div").removeClass("hidden"):(0<n.parent().children(".menu-active").length&&h("#navigationLink").trigger("click"),n.parent().prev("div").addClass("hidden"),n.parent().slideUp(0),n.parent().prev("div").children("a").removeClass("menu-image-up"))),Capinfo.isSupportLowDelay){if(KEY_CODE.keyN==r&&e.shiftKey&&e.ctrlKey&&e.altKey&&(top.sdk_viewer&&top.sdk_viewer.isInstalled&&0==(t=Video.sdk_viewer.execFunctionReturnAll("NetSDKGetConfig")).code&&(i=h.parseJSON(t.result)),demoLDelay.LAPI_GetCfgNoTip(LAPI_URL.LowDelay,s)&&0==t.code)){if(1==s.Enabled&&2==i.Fluency&&0==i.VideoTransProto)return;i.Fluency=2,i.VideoTransProto=0,s.Enabled=1,a=Video.NetSDKSetConfig(Video,i),demoLDelay.LAPI_SetCfgNoTip(LAPI_URL.LowDelay,s)&&a?(h("#keyTip").addClass("keyBoardRight-tip"),setTimeout(function(){h("#keyTip").removeClass("keyBoardRight-tip")},1e3)):(h("#keyTip").addClass("keyBoardError-tip"),setTimeout(function(){h("#keyTip").removeClass("keyBoardError-tip")},1e3))}if(KEY_CODE.keyF==r&&e.shiftKey&&e.ctrlKey&&e.altKey&&(top.sdk_viewer&&top.sdk_viewer.isInstalled&&0==(t=Video.NetSDKGetConfig(Video)).code&&(i=h.parseJSON(t.result)),demoLDelay.LAPI_GetCfgNoTip(LAPI_URL.LowDelay,s)&&0==t.code)){if(0==s.Enabled)return;s.Enabled=0,demoLDelay.LAPI_SetCfgNoTip(LAPI_URL.LowDelay,s)?(h("#keyTip").addClass("keyBoardRight-tip"),setTimeout(function(){h("#keyTip").removeClass("keyBoardRight-tip")},1e3)):(h("#keyTip").addClass("keyBoardError-tip"),setTimeout(function(){h("#keyTip").removeClass("keyBoardError-tip")},1e3))}}if(KEY_CODE.keyH==r&&e.shiftKey&&e.ctrlKey&&e.altKey){if(Frame.enhanceMode)return;d.Enabled=1,demoLDelay.LAPI_SetCfgNoTip(LAPI_URL.EnhanceMode,d)?(Frame.enhanceMode=1,h("#keyTip").addClass("keyBoardRight-tip"),setTimeout(function(){h("#keyTip").removeClass("keyBoardRight-tip")},1e3)):(h("#keyTip").addClass("keyBoardError-tip"),setTimeout(function(){h("#keyTip").removeClass("keyBoardError-tip")},1e3))}if(KEY_CODE.keyU==r&&e.shiftKey&&e.ctrlKey&&e.altKey){if(!Frame.enhanceMode)return;d.Enabled=0,demoLDelay.LAPI_SetCfgNoTip(LAPI_URL.EnhanceMode,d)?(this.enhanceMode=0,h("#keyTip").addClass("keyBoardRight-tip"),setTimeout(function(){h("#keyTip").removeClass("keyBoardRight-tip")},1e3)):(h("#keyTip").addClass("keyBoardError-tip"),setTimeout(function(){h("#keyTip").removeClass("keyBoardError-tip")},1e3))}}if(!Capinfo.isSupportDemo&&VersionType.PRJ!=Capinfo.versionType||(Capinfo.isSupportIvaPark&&KEY_CODE.keyD==r&&e.shiftKey&&e.ctrlKey&&e.altKey&&(l.is(":hidden")?l.parent().removeClass("hidden"):(l.parent().hasClass("navigation-active")&&h("#systemCfgLink").trigger("click"),l.parent().addClass("hidden"))),KEY_CODE.keyY==r&&e.shiftKey&&e.ctrlKey&&e.altKey&&((l=h("#demoFuncLink")).parent().prev("div").is(":hidden")?l.parent().prev("div").removeClass("hidden"):(l.hasClass("menu-active")&&h("#navigationLink").trigger("click"),l.parent().prev("div").addClass("hidden"),l.parent().slideUp(0),l.parent().prev("div").children("a").removeClass("menu-image-up")))),Capinfo.isSupportDemo){if(Capinfo.isSupportLowDelay){if(KEY_CODE.keyN==r&&e.shiftKey&&e.ctrlKey&&e.altKey&&(top.sdk_viewer&&top.sdk_viewer.isInstalled&&0==(t=Video.NetSDKGetConfig(top)).code&&(i=h.parseJSON(t.result)),demoLDelay.LAPI_GetCfgNoTip(LAPI_URL.LowDelay,s)&&0==t.code)){if(1==s.Enabled&&2==i.Fluency&&0==i.VideoTransProto)return;i.Fluency=2,i.VideoTransProto=0,s.Enabled=1,a=Video.NetSDKSetConfig(top,i),demoLDelay.LAPI_SetCfgNoTip(LAPI_URL.LowDelay,s)&&a?(h("#keyTip").addClass("keyBoardRight-tip"),setTimeout(function(){h("#keyTip").removeClass("keyBoardRight-tip")},1e3)):(h("#keyTip").addClass("keyBoardError-tip"),setTimeout(function(){h("#keyTip").removeClass("keyBoardError-tip")},1e3))}if(KEY_CODE.keyF==r&&e.shiftKey&&e.ctrlKey&&e.altKey&&(top.sdk_viewer.isInstalled&&(t=Video.NetSDKGetConfig(top)),demoLDelay.LAPI_GetCfgNoTip(LAPI_URL.LowDelay,s)&&0==t.code)){if(0==s.Enabled)return;s.Enabled=0,demoLDelay.LAPI_SetCfgNoTip(LAPI_URL.LowDelay,s)?(h("#keyTip").addClass("keyBoardRight-tip"),setTimeout(function(){h("#keyTip").removeClass("keyBoardRight-tip")},1e3)):(h("#keyTip").addClass("keyBoardError-tip"),setTimeout(function(){h("#keyTip").removeClass("keyBoardError-tip")},1e3))}}if(KEY_CODE.keyH==r&&e.shiftKey&&e.ctrlKey&&e.altKey){if(Frame.enhanceMode)return;d.Enabled=1,demoLDelay.LAPI_SetCfgNoTip(LAPI_URL.EnhanceMode,d)?(this.enhanceMode=1,h("#keyTip").addClass("keyBoardRight-tip"),setTimeout(function(){h("#keyTip").removeClass("keyBoardRight-tip")},1e3)):(h("#keyTip").addClass("keyBoardError-tip"),setTimeout(function(){h("#keyTip").removeClass("keyBoardError-tip")},1e3))}KEY_CODE.keyU==r&&e.shiftKey&&e.ctrlKey&&e.altKey&&Frame.enhanceMode&&(d.Enabled=0,demoLDelay.LAPI_SetCfgNoTip(LAPI_URL.EnhanceMode,d)?(Frame.enhanceMode=0,h("#keyTip").addClass("keyBoardRight-tip"),setTimeout(function(){h("#keyTip").removeClass("keyBoardRight-tip")},1e3)):(h("#keyTip").addClass("keyBoardError-tip"),setTimeout(function(){h("#keyTip").removeClass("keyBoardError-tip")},1e3)))}KEY_CODE.keyQ==r&&e.shiftKey&&e.ctrlKey&&e.altKey&&(Config.iva_scene_cruise&&h("#quickCruiseTR").removeClass("hidden"),IVAMode.ILLEGAL==Frame.IVAType&&Config.iva_scene_manager&&1==Config.iva_scene_manager.pageType&&(Frame.isShowIVASpecialParam=!Frame.isShowIVASpecialParam,Frame.isShowIVASpecialParam&&!Capinfo.isSupportIVAZoomMark?h("#specialParamFs").removeClass("hidden"):h("#specialParamFs").addClass("hidden"))),Utils.shieldEsc()}},changeVideoSize:function(e,t){var a,i,s=h("#activeX_obj"),n=h("#videoDiv");2==Video.cur_scale?(a=n.width(),i=n.height(),a<e?(n.css("overflow-x","auto"),s.css("width",e+"px")):(n.css("overflow-x","hidden"),s.css("width","100%")),i<t?(n.css("overflow-y","auto"),s.css("height",t+"px")):(n.css("overflow-y","hidden"),s.css("height","100%")),n.removeClass("overhidden")):s.css({width:"100%",height:"100%"})},showVideo:function(e,t,a,i,s){document.getElementById("mainIframe");var n=h("#videoDiv"),o=0,r=0;a=parseInt(a)+parseInt(r),i=parseInt(i)+parseInt(o),Video.changeVideoType(s,e,t),Video.resetCombox(),1==s&&(t+=parseInt(document.getElementById("ctrlTR").offsetHeight)),n.addClass("overhidden"),n.css({left:i+"px",top:a+"px",zIndex:1e3,width:e+"px",height:t+"px"})},hiddenVideo:function(){var e=h("#videoDiv"),e=h("#videoDiv");if(Video.isShowPtz&&Video.changeVideoType(!1),h("#editPreset").addClass("hidden"),null!==this.StartVideoTimeID&&(clearTimeout(this.StartVideoTimeID),this.StartVideoTimeID=null),top.sdk_viewer&&top.sdk_viewer.obj)for(var t=0;t<Video.statusList.length;t++)Video.statusList[t].isVideoOpen&&Video.stopVideo(StreamType.LIVE,t);this.DefaultStreamID==Video.statusList[0].streamID||Capinfo.isSupport4KFishEye||(Video.statusList[0]=Utils.objectClone(Video.statusMap),Video.statusList[0].streamID=this.DefaultStreamID),Video.StreamInfoChangeList=[],Video.streamNum=0,Video.isLiveReplay=!1,e.css({width:"1px",height:"1px",zIndex:"-1"}),top.sdk_viewer&&!Capinfo.isNoPlugin&&Video.NetSDKSetPlayDlgSize(top,1,1)},getRealtimeStatusInfo:function(){var e,t={},a={};if(Utils.LAPI_GetCfgData(LAPI_URL.LAPI_ManagerServerInfo,a)&&(m.VmRegStatus=a.StatusParam.VMServerOnline),Utils.LAPI_GetCfgData(LAPI_URL.LAPI_PhotoServer,a)&&(m.TmsRegStatus=a.StatusParam.PhotoServerOnline),Capinfo.isSupportIvaPark){var i,s={},n=Capinfo.carportCount;1==n&&h("#ParkingInfoName").html(h.lang.pub.parkingInfo),Utils.LAPI_GetCfgData(LAPI_URL.IVAParkStatusAll,t),Utils.LAPI_GetCfgData(LAPI_URL.ParkingDetection,s);for(var o=0;o<n;o++)i=s.ParkingSpaces[o].Status,m["ParkingInfo"+(o+1)]=t.ParkStatus[o].ParkingLotStatus,m["ParkingPlate"+(o+1)]=t.ParkStatus[o].CarPlate,1==i&&h("#ParkingInfo"+Number(o+1)).parent().removeClass("hidden")}if(Capinfo.isSupportTrafficFlow){var r,l={};Utils.LAPI_GetCfgData(LAPI_URL.VehQueueLen,l),r=l.StatusParam.VehQueueLen.DriveWayNum,m.DriveWayNum=r;for(o=0;o<r;o++)m["DrivewayID"+o]=o+1,m["VehQueueLen"+o]=l.StatusParam.VehQueueLen["QueueLen"+(o+1)].toFixed(2)}if(Utils.LAPI_GetCfgData(LAPI_URL.DRIVEWAY_CFG,a),e=a.Num,Utils.LAPI_GetCfgData(LAPI_URL.IVACoilAll,t))for(o=0;o<2*e;o++)m["CoilStatus0-"+o]=t.StatusParam.CoilStatus[o].Status;Utils.LAPI_GetCfgData(LAPI_URL.IVARadarAll,a)&&(m.RadarStatus=a.StatusParam.RadarStatus),Utils.LAPI_GetCfgData(LAPI_URL.IVAPolarizer,a)&&(m.PolarizerStatus=a.StatusParam.PolarizerStatus),Utils.LAPI_GetCfgData(LAPI_URL.IVANDFilter,a)&&(m.NDFilterStatus=a.StatusParam.NDFilterStatus),Utils.LAPI_GetCfgData(LAPI_URL.IVALEDStrobe,a)&&(m.LEDStatus=a.StatusParam.LEDStrobeStatus),Utils.LAPI_GetCfgData(LAPI_URL.TrafficLightStatus,a)&&(m.TrafficLightStatus=a.StatusParam.TrafficLightStatus),Capinfo.isSupportLEDCtrl&&Utils.LAPI_GetCfgData(LAPI_URL.OutLedStatus,a)&&(m.CarportLEDCtrlStatus=a.StatusParam.OutLedStatus),Capinfo.isSupportTrafficDataServerStatus&&Utils.LAPI_GetCfgData(LAPI_URL.TraServiceStatus,a)&&(m.TrafficDataServerStatus=a.StatusParam.TraServiceStatus),Utils.LAPI_GetCfgData(LAPI_URL.LAPI_SD,a)&&(m.SDStatus=a.StatusParam.SDStatus),this.changeStatusText(),this.showRealStatus(m)},eventStatusReport:function(e,t){if(m={},"CoilStatus"==e){var a={};Utils.LAPI_GetCfgData(LAPI_URL.DRIVEWAY_CFG,a);for(var i=a.Num,s=0;s<2*i;s++)m["CoilStatus0-"+s]=t.StatusInfo.CoilStatus[s].Status}else if("ParkingInfo"==e){a=Number(t.StatusInfo.ParkStatus.ParkID);m["ParkingInfo"+a]=t.StatusInfo.ParkStatus.ParkingLotStatus,m["ParkingPlate"+a]=t.StatusInfo.ParkStatus.CarPlate}else if("VehQueueLenStatus"==e){var n=t.StatusInfo.VehQueueLen.DriveWayNum;m.DriveWayNum=n;for(s=0;s<n;s++)m["DrivewayID"+s]=s+1,m["VehQueueLen"+s]=t.StatusInfo.VehQueueLen["QueueLen"+(s+1)].toFixed(2)}else m[e]=t;this.changeStatusText(),this.showRealStatus(m)},changeStatusText:function(){var e,t,a,i={CoilStatus:[h.lang.pub.unConnect,h.lang.pub.connect,h.lang.pub.untapped],VmRegStatus:[h.lang.pub.regFail,h.lang.pub.regSucceed,h.lang.pub.untapped],TmsRegStatus:[h.lang.pub.regFail,h.lang.pub.regSucceed,h.lang.pub.untapped],RadarStatus:[h.lang.pub.unConnect,h.lang.pub.connect,h.lang.pub.untapped],PolarizerStatus:[h.lang.pub.using,h.lang.pub.untapped,h.lang.pub.goDown,h.lang.pub.goUp,h.lang.pub.unconventionality,h.lang.pub.switching],LEDStatus:[h.lang.pub.open,h.lang.pub.close],OpenDetectStatus:[h.lang.pub.conventionality,h.lang.pub.unconventionality],TrafficLightStatus:[h.lang.pub.regFail,h.lang.pub.regSucceed,h.lang.pub.untapped],NDFilterStatus:[h.lang.pub.using,h.lang.pub.untapped,h.lang.pub.goDown,h.lang.pub.goUp,h.lang.pub.unconventionality,h.lang.pub.switching],SDStatus:[h.lang.pub.noexist,h.lang.pub.fault,h.lang.pub.checking,h.lang.pub.normal,h.lang.pub.exist],ParkingInfo1:[h.lang.pub.freeCarport,h.lang.pub.usedCarport,h.lang.pub.faultCarport],ParkingPlate1:"",ParkingInfo2:[h.lang.pub.freeCarport,h.lang.pub.usedCarport,h.lang.pub.faultCarport],ParkingPlate2:"",ParkingInfo3:[h.lang.pub.freeCarport,h.lang.pub.usedCarport,h.lang.pub.faultCarport],ParkingPlate3:"",CarportLEDCtrlStatus:[h.lang.pub.regFail,h.lang.pub.regSucceed,h.lang.pub.untapped],TrafficDataServerStatus:[h.lang.pub.regFail,h.lang.pub.regSucceed,h.lang.pub.untapped]},s={CoilStatus:["incorrect","correct","untapped"],VmRegStatus:["incorrect","correct","untapped"],TmsRegStatus:["incorrect","correct","untapped"],RadarStatus:["incorrect","correct","untapped"],PolarizerStatus:["correct","untapped","godown","goup","incorrect","switching"],LEDStatus:["correct","untapped"],OpenDetectStatus:["correct","incorrect"],TrafficLightStatus:["incorrect","correct","untapped"],NDFilterStatus:["correct","untapped","godown","goup","incorrect","switching"],SDStatus:["untapped","incorrect","switching","correct"],ParkingInfo1:["correct","incorrect","untapped"],ParkingInfo2:["correct","incorrect","untapped"],ParkingInfo3:["correct","incorrect","untapped"],CarportLEDCtrlStatus:["incorrect","correct","untapped"],TrafficDataServerStatus:["incorrect","correct","untapped"]},n="",o=!1,r="",l=!1,p=!1,d="",u=0,c=h("#vehQueueLenStatusID");for(a in m)if(t=a,Capinfo.isSupportCoil&&-1<t.indexOf("CoilStatus")){var o=!0,g=t.substring("CoilStatus".length,t.length);if(255!=g&&2!=Number(m[a])){switch(g=0!=g?g:"",Number(m[a])){case 0:n+="<div class='icon untapped'";break;case 1:n+="<div class='icon correct'"}n+="title='"+g+"("+i.CoilStatus[m[a]]+")'></div>",u++}}else if(Capinfo.isSupportRadar&&-1<t.indexOf("RadarStatus")){for(var l=!0,C=0;C<4;C++){var S=Number(m.RadarStatus);S>>=4*C,1==(S&=15)?r+="<div class='icon correct' title='"+(C+1)+"("+i.RadarStatus[S]+")'></div>":0==S&&(r+="<div class='icon untapped' title='"+(C+1)+"("+i.RadarStatus[S]+")'></div>")}m[a]=r}else if(Capinfo.isSupportCapture&&!this.isShowPtzForHTS&&"DriveWayNum"==t){for(var f=m[t],C=0;C<f;C++)d+="<div class='contentLine'><span class='labelSpan strLimit'>"+h.lang.pub.roadway+m["DrivewayID"+C]+h.lang.pub.queuelength+"</span><span class='contentSpan'>"+m["VehQueueLen"+C]+h.lang.pub.miles+"</span></div>";p=!0}else-1==t.indexOf("ParkingPlate")&&undefined!=i[t]&&(m[a]="<div class='icon "+s[t][m[a]]+"' title='"+i[t][m[a]]+"'></div>");o&&(0<n.length?(h("#CoilStatusTbl").removeClass("hidden"),h("#coilStatusSignTd").html(n),2<u?h("#CoilLabelSpan").removeClass("labelSpan strLimit"):h("#CoilLabelSpan").addClass("labelSpan strLimit")):(h("#CoilStatusTbl").addClass("hidden"),h("#coilStatusSignTd").html(""))),l&&(e=m.RadarStatus.split("title").length-1,0<r.length?h("#radarID").removeClass("hidden"):h("#radarID").addClass("hidden"),2<e?h("#RadarLabelSpan").removeClass("labelSpan strLimit"):h("#RadarLabelSpan").addClass("labelSpan strLimit")),p&&(0<d.length?(c.html(d),c.removeClass("hidden")):c.addClass("hidden"))},showRealStatus:function(e){var t,a;for(t in e)(a=document.getElementById(t))&&"SPAN"==a.tagName&&(a.innerHTML=e[t],-1<t.indexOf("ParkingPlate")&&("-"==e[t]?a.innerHTML=h.lang.pub.unIdentify:"#"==e[t]?a.innerHTML=h.lang.pub.recognizing:"*"==e[t]?a.innerHTML=h.lang.pub.freeCarPort:"!"==e[t]&&(a.innerHTML=h.lang.pub.abnormalOccupation)))},blockDiv:function(e){h(".blockDiv").width(h("#contentDiv").width()-8),h(".blockDiv").height(h("#contentDiv").height()-8);e=e?"block":"none";h("#blockDiv").css("display",e),h("#blockDiv2").css("display",e),h("#blockDiv3").css("display",e)},nav_click:function(e){var t="",a=e,i="",s=h("#configContainer"),n="",o=h("#RTStatus");s.empty(),Capinfo.isSupportTrafficFlow&&h("#TmsRegStatusDiv").addClass("hidden"),"nav_live"==e||"nav_playback"==e||"nav_photo"==e?("nav_playback"==e||"nav_photo"==e||Capinfo.isSupportHISIParam?o.addClass("hidden"):Capinfo.isSupportRealtimeStatus&&(this.isShowPtzForHTS?o.addClass("hidden"):(o.find(".contentLine").removeClass("RTStatusHeight"),o.removeClass("hidden"))),Menu.selectItem(a),this.currentNameSpace&&this.currentNameSpace.release&&(Utils.closeWin(),this.currentNameSpace.release()),"nav_playback"==e?n="/skin/default_1/css/playback.0b452c89.css":"nav_photo"==e&&(n=["/skin/default_1/css/storage_status.95522c2c.css","/skin/default_1/css/zTreeStyle.1edcf0c8.css"]),"nav_live"==e&&Capinfo.isSupportHISIParam&&h("#"+e).attr("data-href","/page/ITS/live_video.145d45f7.htm"),Utils.loadCss("cfgCss",n),n=h("#"+e).attr("data-href"),Utils.loadHtml("configContainer",n)):(Capinfo.isSupportHorizontalMenu?(Capinfo.isSupportHISIParam&&o.removeClass("hidden"),Menu.cfgLink(),"nav_config"==e?(Menu.cfgLinkChange(),t="LocalCfgLink"):"nav_maintain"==e&&(Menu.maintainLinkChange(),t="deviceStatusLink"),0<(i=h(".navigation-active a").filter(function(){return!h(this).parent().is(":hidden")})).length&&(t=i.attr("id"))):(t=h(".menu-content a").first().attr("id"),0<(i=h(".menu-content a.menu-active")).length&&(t=i.attr("id"))),a=Menu.getDefaultTabF(t),Menu.selectItem(a),h("#"+t).trigger("click"))},lisenceEvent:function(){for(var e=!1,t=this,a=this.eventMsgList.length;0<a;a--){var i=this.eventMsgList.shift(),s=i;if("object"==typeof i&&(e=i.isReboot,s=i.msg),alert(s),e)return void this.pageLogout();a=this.eventMsgList.length}setTimeout(function(){t.lisenceEvent()},1e3)},getPearEyeCommonCfg:function(e){e=void 0===e?{}:e;return!!Utils.LAPI_GetCfgData(LAPI_URL.PearlEyeCommonCfg,e)&&(this.LiveMode=Number(e.LiveMode),!0)},getDefaultStreamID:function(){if(this.DefaultStreamID=0,Capinfo.isSupportFishEye)switch(this.LiveMode){case PearlEyeLiveMode.PearlEye_Full_3PTZ:case PearlEyeLiveMode.PearlEye_4PTZ:case PearlEyeLiveMode.PearlEye:this.DefaultStreamID=10;break;case PearlEyeLiveMode.Full_4PTZ:case PearlEyeLiveMode.Full:this.DefaultStreamID=11;break;case PearlEyeLiveMode.PTZ4:this.DefaultStreamID=12}},getEnhanceMode:function(){d={},Utils.LAPI_GetCfgData(LAPI_URL.EnhanceMode,d)&&(this.enhanceMode=d.Enabled),this.startPresetID=0==this.enhanceMode?1:0},queryStatus:function(e){ResultCode.RESULT_CODE_SUCCEED!=e&&(e=ResultCode.RESULT_CODE_USERFULL==e?h.lang.tip.tipOcxInitFullUser:ResultCode.RESULT_CODE_USERNONEXIST==e||ResultCode.RESULT_CODE_PASSWD_INVALID==e?h.lang.tip.tipOcxInitInvalidUser:ResultCode.RESULT_CODE_TIMEOUT==e?h.lang.tip.tipOcxInitWaiting:ResultCode.ERR_SDK_COMMON_LOCK_USER==e?h.lang.tip.tipLockUser:ResultCode.ERR_SDK_REMOTE_USER_WITH_WEAK_PASSWD==e?h.lang.tip.tipLockUserPassword:h.lang.tip.tipOcxInitFail,this.pageLogout(e))},afterPlugInit:function(){var e={};Utils.LAPI_GetCfgData(LAPI_URL.FriendPwd,e,!1)&&(this.isFriendPasswordEnable=e.FriendlyPassword.Enabled);var t={};if(Utils.LAPI_GetCfgData(LAPI_URL.Users_Cfg,t))for(var a=0,i=t.Users.length;a<i;a++)if(this.loginUserName==t.Users[a].Name){this.userMap=t.Users[a];break}0==this.userMap.Level&&(parent.userType=UserType.Administrator,this.userMap.UserName=this.loginUserName),Utils.LAPI_GetCfgData(LAPI_URL.SecurityRSA,l)&&(setMaxDigits(130),this.RSAPublicKeyE=l.RSAPublicKeyE,this.RSAPublicKeyN=l.RSAPublicKeyN,this.RSAKey=new RSAKeyPair(this.RSAPublicKeyE,"",this.RSAPublicKeyN));var s,n,o={};if(Utils.LAPI_GetCfgData(LAPI_URL.HttpAuth,o),this.auzType=Number(o.Mode),"https:"==document.location.protocol)switch(this.auzType){case 0:this.auzType=10;break;case 1:this.auzType=11;break;case 2:this.auzType=12}if(Video.initOcx(),Capinfo.isNoPlugin?"0"==Utils.getCookie("isAutoStartVideo")&&(this.IsAutoStartVideo=!1):(s=top.sdk_viewer.checkVersion(),e=(n=h("#ieVersion")).find(".activeXDiv"),o=n.find(".downloadTip"),null===s?(this.IsAutoStartVideo=!1,Capinfo.isMac||top.is64Platform?e.html(h.lang.tip.tipInstallPlugin):o.html(h.lang.pub.downloadTip3+" "),n.slideDown()):("0"==Utils.getCookie("isAutoStartVideo")&&(this.IsAutoStartVideo=!1),s||(Capinfo.isMac||top.is64Platform?e.html(h.lang.tip.tipInstallPlugin):o.html(h.lang.pub.downloadTip3+" "),n.slideDown()),Video.NetSDKEnDblClkFull(top,1),n=Utils.getIpType1(window.location.hostname),r=Video.NetSDKGetLocalIP(top),ResultCode.RESULT_CODE_SUCCEED==r.code&&(this.RegSubIP=r.result),r=Video.NetSDKGetRegSubPort(top,n),ResultCode.RESULT_CODE_SUCCEED==r.code&&(this.RegSubPort=r.result,null!==this.RegSubTimerID&&clearTimeout(this.RegSubTimerID),this.InfoSubscription()),Video.NetSDKSetTrustSiteEnable(top,0),top.sdk_viewer.execFunctionReturnAll("NetSDKSetTrustSite",window.location.hostname))),CssMapping.init2(),this.getEnhanceMode(),Capinfo.isSupportFishEye&&this.getPearEyeCommonCfg(),this.getDefaultStreamID(),parent.showedFlag=!0,Capinfo.isSupportRecordPlayback&&!Capinfo.isNoPlugin&&h("#nav_playback").removeClass("hidden"),Capinfo.isSupportRealtimeStatus&&(this.getRealtimeStatusInfo(),Capinfo.isSupportPolarizer&&h("#polarizerID").removeClass("hidden"),Capinfo.isSupportTrafficLight&&h("#trafficLightStatusID").removeClass("hidden"),(Capinfo.isSupportLEDStatus&&Capinfo.isSupportHorizontalMenu||Capinfo.isSupportFilllightTab&&!Capinfo.isSupportHorizontalMenu)&&h("#ledStatusID").removeClass("hidden"),Capinfo.isSupportNDFilter&&h("#NDFilterStatusID").removeClass("hidden"),Capinfo.isSupportOpenDetect&&h("#openDetectID").removeClass("hidden"),Capinfo.isSupportStorage&&!Capinfo.isSupportTrafficFlow&&h("#SDCardStatusID").removeClass("hidden"),Capinfo.isSupportLEDCtrl&&h("#CarportLEDCtrlStatusID").removeClass("hidden"),Capinfo.isSupportTrafficDataServerStatus&&h("#TrafficDataServerStatusDiv").removeClass("hidden")),!Capinfo.isSupportCapture&&Capinfo.isSupportAlarm&&h("#alarmMenu").removeClass("hidden"),(Capinfo.isSupportCapture&&!Capinfo.isSupportTrafficFlow||Capinfo.isSupportIpcCapture||"-1"!=Utils.isContainsElement("0",Capinfo.storTypeArr)?h("#nav_photo"):h("#navigationLink")).removeClass("hidden"),Capinfo.isSupportHorizontalMenu&&h("#nav_maintain").removeClass("hidden"),Capinfo.isSupportIVA&&(this.getIVAType(),Capinfo.updateCapInfo()),(Capinfo.isSupportLens||Capinfo.isSupportABF)&&(h("#LENSDiv").removeClass("hidden"),Capinfo.isSupportLens&&!Capinfo.isUnSupportImmutableLens&&(h("#focusBtns").removeClass("hidden"),h("#becomeBtns").removeClass("hidden"),Capinfo.isSupportIRIS&&h("#apertureBtns").removeClass("hidden")),Capinfo.isSupportABF&&h("#autobackfocusBtns").removeClass("hidden")),Capinfo.isSupportPeripheralPTZ&&(Capinfo.isSupportInfrare&&h("#infrareBtns").removeClass("hidden"),Capinfo.isSupportHeatup&&h("#heatupBtns").removeClass("hidden"),Capinfo.isSupportRainbrush&&h("#rainbrushBtns").removeClass("hidden"),Capinfo.isSupportIlluminate&&h("#illuminateBtns").removeClass("hidden")),Capinfo.isSupportClearSnow&&(Video.getSweepSnowInfo(),h("#clearsnowBtns").removeClass("hidden")),Capinfo.isSupport4KFishEye&&Variables.get4KFishModeData(),Capinfo.isSupportHorizontalMenu)if(Capinfo.isSupportCapture){var r={};if(!Utils.LAPI_GetCfgData(LAPI_URL.EpExtendDebug,r))return Utils.disableAll(),!1;0}Menu.initMenu(),UserType.Administrator!=parent.userType&&(h("#nav_playback").remove(),h("#playback").remove(),h("#nav_maintain").remove()),h("#devType").text(this.titleDeviceType),this.initEvent(),this.initLoginType(),Utils.initLang(),Utils.strLimit()},logout:function(){a=a.substring(0,a.indexOf(window.location.pathname)),this.release(),top.window.location=a+this.saveHerfParam()},cancelBar:function(){h("#confirmDiv").slideUp(0)},initMaxPresetNum:function(){var e={};Utils.LAPI_GetCfgData(LAPI_URL.ExPtzSpecFunc,e),this.endPresetID=1==e.Enabled?65535:Capinfo.PresetNum}}))}(jQuery),Frame.init2();