Config.alarmAudioDetect=function(n){var a=null,o={},l={},s={},t=0,r=[],d=0,i=!0,u=["switchOutLi","presetLi","ftpLi","emailLi","storLi","picLi"],c=0,m=0,f=!1,p=document.onmousemove,h=document.onmouseup,g=document.onselectstart;return new(Class.extend({init:function(){LoginType.VM_LOGIN!=Frame.loginType&&Utils.loadHtml("smartLinkOutIFrameDiv","/page/common/smart_linkout.76e56953.htm"),Utils.beforeDataLoad(),Utils.initLang(),this.initPage(),this.initValidator(),this.initEvent(),this.initData(),Utils.afterDataLoad()},initPage:function(){LoginType.VM_LOGIN!=Frame.loginType&&smartLinkOutIframe.initPage(u),LoginType.VM_LOGIN==Frame.loginType&&(n("#linkOutIFrame").addClass("hidden"),n("#planDiv").addClass("hidden"),n("#submitBtn").remove());for(var e=0;e<212;e++)n("#alarmView").append("<div class='activity' style='height: 0;margin-top: 400px;background-color: black'></div>")},initData:function(){if(o={},s={},!Utils.LAPI_GetCfgData(LAPI_URL.AudioDetect,o))return this.disablePage(),void Frame.showMsg(!1,n.lang.tip.tipGetCfgFail);Utils.LAPI_CfgToForm("frmSetup",o,s),l=Utils.objectClone(o),LoginType.VM_LOGIN!=Frame.loginType&&(smartLinkOutIframe.initData(LAPI_URL.AudioDetectLink)||(this.disablePage(),Frame.showMsg(!1,n.lang.tip.tipGetCfgFail)),Plan.init(LAPI_URL.WeekPlan+"AudioDetect")),this.enableAudioDetect(),this.DetectType_change()},initEvent:function(){var e=this;LoginType.VM_LOGIN==Frame.loginType?(n("input[name='Enabled']").bind("click",function(){e.enableAudioDetect(),e.submitF()}),n("#DetectType").change(function(){e.DetectType_change(),e.submitF()}),n("#Threshold").change(function(){e.submitF()}),n("#DiffValue").change(function(){e.submitF()})):(n("input[name='Enabled']").bind("click",function(){e.enableAudioDetect()}),n("#DetectType").change(function(){e.DetectType_change()})),n("#thresholdHR").bind("mousedown",function(){e.moveThresholdHR()}),n("#thresholdHR_staff").bind("mousedown",function(){e.moveThresholdHR()}),n("#stopStart").bind("click",function(){e.stopStart_click()})},submitF:function(){var e=!1,t=!1,i=!1;a.form()&&(Utils.LAPI_FormToCfg("frmSetup",o,s),e=!Utils.isObjectEquals(o,l),LoginType.VM_LOGIN!=Frame.loginType&&(t=smartLinkOutIframe.IsChanged(),i=Plan.IsChanged()),e||t||i?(i&&Plan.submitF(LAPI_URL.WeekPlan+"AudioDetect"),t&&smartLinkOutIframe.submitF(LAPI_URL.AudioDetectLink),e&&Utils.LAPI_SetCfgData(LAPI_URL.AudioDetect,o)&&(l=Utils.objectClone(o))):Frame.showMsg(!0,n.lang.tip.tipAnyChangeInfo,0))},release:function(){t&&this.clearTimeId(t),delete Config.alarmAudioDetect},enableAudioDetect:function(){var e=n("#audioDetectOpen").is(":checked"),o=this;n("#DetectType").prop("disabled",!e),n("#DiffValue").prop("disabled",!e),n("#Threshold").prop("disabled",!e),e?t=setInterval(function(){var e={};if(Utils.LAPI_GetCfgData(LAPI_URL.AudioVolume,e)){r.splice(0,r.length);for(var t=0;t<e.Nums;t++){var i={},n=e.Volumes[t].Volume,a=e.Volumes[t].IsAbnormal;i.Volume=undefined==n?0:n,i.AlarmOn=undefined==a?0:a,r.push(i)}for(d=0;d<e.Nums;d++)o.drawAudioActivity()}else Utils.disableAll()},1e3):(this.clearTimeId(t),n("#alarmView").children().css({height:"0px",marginTop:"400px"}))},DetectType_change:function(){3==n("#DetectType").val()?(n("#diffValueDL").addClass("hidden"),n("#DiffValue").val(s.DiffValue),n("#thresholdDL").removeClass("hidden")):(n("#diffValueDL").removeClass("hidden"),n("#thresholdDL").addClass("hidden"),n("#Threshold").val(s.Threshold)),a.init()},moveThresholdHR:function(){document.onselectstart=function(){return!1};var e=Utils.getEvent();f=!0,c=e.clientY,m=parseInt(n("#thresholdHR").css("marginTop")),n("#frontDiv").css("display","block"),document.onmousemove=function(){var e,t=Utils.getEvent();1==(document.all?1==t.button:0==t.button)&&f&&(e=400<(e=(e=m+t.clientY-c)<0?0:e)?400:e,n("#thresholdHR").css("marginTop",e),(t=n("#thresholdHR_label")).text(400-e),t.css("marginTop",e-6),n("#thresholdHR_staff").css("marginTop",e-6))},f&&(document.onmouseup=function(){document.onmousemove=p,document.onmouseup=h,document.onselectstart=g,n("#frontDiv").css("display","none"),f=!1,m=c=0})},stopStart_click:function(){var e=(i=!i)?n.lang.pub.stop:n.lang.pub.start;n("#stopStart").text(e)},initValidator:function(){n("#DiffValue").attr("tip",n.validator.format(n.lang.tip.tipIntRange,0,400)),n("#Threshold").attr("tip",n.validator.format(n.lang.tip.tipIntRange,0,400)),(a=n("#frmSetup").validate({debug:!1,focusInvalid:!1,errorElement:"span",errorPlacement:function(e,t){Utils.showJqueryErr(e,t,"div")},success:function(e){},rules:{DiffValue:{integer:!0,required:!0,range:[0,400]},Threshold:{integer:!0,required:!0,range:[0,400]}}})).init()},disablePage:function(){Utils.disableAll(),smartLinkOutIframe.disableAll()},drawAudioActivity:function(){var e,t;i&&(e="<div class='activity' style='height: "+(t=parseInt(r[d].Volume))+"px;margin-top: "+(400-t)+"px;background-color: "+(1==r[d].AlarmOn?"red":"gray")+"'></div>",212==(t=n("#alarmView")).children().length&&t.find(":first-child").remove(),t.append(e))},clearTimeId:function(e){e&&(clearInterval(e),e==t&&(t=0))}}))}(jQuery),Frame.currentNameSpace=Config.alarmAudioDetect;