Utils.$package("FirstLogin"),FirstLogin=function(r){var i=null,l={},t={};return top.loginUserPwd="",new(Class.extend({init:function(){Utils.beforeDataLoad(),this.initPage(),Utils.initLang(),this.initEvent(),this.initValidator(),this.initData(),Utils.afterDataLoad()},initPage:function(){r(".cancelBtn").remove(),r("#titleBar").find(".icon").remove()},initEvent:function(){var e=this,i=r("#userPwd");i.bind("keyup",function(){e.pwStrength(this.value)}),i.bind("blur",function(){""!=r(this).val()&&e.pwStrength(this.value)}).bind("blur",function(){e.userConfirmPwdCheck()})},initData:function(){Utils.LAPI_GetCfgData(LAPI_URL.SecurityRSA,t)&&(setMaxDigits(260),t.RSAKey=new RSAKeyPair(t.RSAPublicKeyE,"",t.RSAPublicKeyN))},release:function(){},initValidator:function(){r("#userPwd").attr("tip",r.lang.tip.tipENPwsStrong),r("#userConfirmPwd").attr("tip",r.lang.tip.tipENPwsStrong),r.validator.addMethod("checkPwd",function(e){var i=!0;return i=i&&""!=e?!r("#pwdLevelPic_3").hasClass("level0"):i},r.lang.tip.tipENPwsStrong),r.validator.addMethod("userDefinedConfirmPwd",function(){return r("#userPwd").val()==r("#userConfirmPwd").val()},r.lang.tip.tipUnequalUserPwd),i=r("#frmSetup0").validate({focusInvalid:!1,errorElement:"div",errorPlacement:function(e,i){e.css({width:"242px",height:"100%"}),e.appendTo(i.parent())},success:function(){},rules:{userPwd:{required:!0,checkPwd:""},userConfirmPwd:{userDefinedConfirmPwd:""}}})},pwStrength:function(e){var i,l,t,a,s,n;if(""==e)l=t=i="level0",s=n=a="levelT0";else switch(Utils.checkStrong(e)){case 0:case 1:i="level1",l=t="level0",a="levelT1",s=n="levelT0";break;case 2:i=l="level2",t="level0",s="levelT2",a=n="levelT0";break;default:i=l=t="level3",n="levelT3",a=s="levelT0"}r(".levelPic").removeClass("level0").removeClass("level1").removeClass("level2").removeClass("level3"),r(".levelText").removeClass("levelT0").removeClass("levelT1").removeClass("levelT2").removeClass("levelT3"),r("#pwdLevelPic_1").addClass(i),r("#pwdLevelPic_2").addClass(l),r("#pwdLevelPic_3").addClass(t),r("#pwdLevelText_1").addClass(a),r("#pwdLevelText_2").addClass(s),r("#pwdLevelText_3").addClass(n)},userConfirmPwdCheck:function(){var e=r("#userConfirmPwd");""!=e.val()&&e.valid()},submitData:function(){var e=r("#userPwd");i.form()&&(l.RSAPublicKey={},l.RSAPublicKey.RSAPublicKeyE=t.RSAPublicKeyE,l.RSAPublicKey.RSAPublicKeyN=t.RSAPublicKeyN,l.Passwd=Utils.encrypting(e.val(),t.RSAKey),l.Name="admin",l.ID=0,Utils.LAPI_SetCfgData(LAPI_URL.Users_Cfg+"/Users/"+l.ID,l,!1,this.callback)&&(Utils.LAPI_SetCfgData("/LAPI/V1.0/System/FirstLogin",{IsFirstLogin:0},!1),Utils.closeWin()))},callback:function(e){ResultCode.RESULT_CODE_SUCCEED==e?Utils.closeWin():alert(r.lang.tip.tipSetCfgSucceeded)}}))}(jQuery),top=Utils.GetTopWindow();