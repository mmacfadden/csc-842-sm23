Config.softAP_config=function(p){var u,o=!1,l=!1,d="@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@",f={},t={},i={},a={},c={},I={},S={wifiModeType:["Mode"],SSIDname:["NormalCfg","SSID"],EncryptionMode:["NormalCfg","EncryptType"],SafeType:["NormalCfg","AuthMode"],SSID:["SoftAPCfg","SSID"],Channel:["SoftAPCfg","Channel"],IpGateway:["SoftAPCfg","Gateway"]},n={},r={},s={IPGetType:["IPGetType"],WifiIpAddress:["Address"],IpNetmask:["Netmask"],WifiIpGateway:["Gateway"]},m={wifiBiteAutoSwitch:["Enabled"]},h=null,P=null,g=[p.lang.pub.none,"WEP","CCMP","TKIP","CCMP-TKIP"],C=["OPEN","SHARED","WPA-PSK WPA2-PSK"],A=[{fieldId:"SSID"},{fieldId:"Channel"},{fieldId:"BSSID"},{fieldId:"AuthMode"},{fieldId:"EncryptType"},{fieldId:"RSSOnPCT",fieldType:"define",contentFn:function(e,t){return Config.softAP_config.strengthFun(e,t)}},{fieldId:"RSSOnNum"}];return new(Class.extend({init:function(){},init2:function(){Utils.beforeDataLoad(),Utils.initLang(),this.initPage(),this.initValidator(),this.initEvent(),this.initData(document.frmSetup),Utils.afterDataLoad()},initPage:function(){Capinfo.isSupportNormalWiFi&&p("#wifiModeType").append("<option value='0'>"+p.lang.pub.wifiConfigTitle+"</option>"),Capinfo.isSupportSoftAPWiFi&&p("#wifiModeType").append("<option value='1'>"+p.lang.pub.softAPTitle+"</option>"),Capinfo.isSupportSnifferWIFI&&(p("#wifiModeType").append("<option value='2'>"+p.lang.pub.snifferMode+"</option>"),p(".snifferWifi").removeClass("hidden"))},initValidator:function(){p("#SSID").attr("tip",p.lang.tip.tipDeviceID),p("#SSIDname").attr("tip",p.lang.tip.tipSSIDName),p("#IpGateway").attr("tip",p.lang.tip.tipWifiGatewayInfo),p("#Key").attr("tip",p.lang.tip.tipCommonName.replace("%s","8~32")),p("#password").attr("tip",p.lang.tip.tipCommonName.replace("%s","0~63")),p("#WifiIpAddress").attr("tip",p.lang.tip.tipIPInfo),p("#IpNetmask").attr("tip",p.lang.tip.tipSubnetMaskInfo),p("#WifiIpGateway").attr("tip",p.lang.tip.tipGatewayInfo),p.validator.addMethod("isIPAddress",function(e){return Utils.isIPAddress(e)},p.lang.tip.tipIPErr),p.validator.addMethod("checkIP1To223",function(e){return Utils.checkIP1To223(e)},p.lang.tip.tipIPRangeErr),p.validator.addMethod("checkIPUnequalGW",function(e){return Config.softAP_config.checkIPUnequalGW(e)},p.lang.tip.tipIPAndGWNotEqual),p.validator.addMethod("checkSubnetMask",function(e){return Config.softAP_config.checkSubnetMask(e)},p.lang.tip.tipSubnetMaskErr),p.validator.addMethod("checkServerID",function(e){return Utils.checkServerID(e)},p.lang.tip.tipCharFmtErr),p.validator.addMethod("checkIPAddrOrEmpty",function(e){return Utils.checkIPAddrOrEmpty(e)},p.lang.tip.tipIPErr),p.validator.addMethod("checkWifiIPAddr",function(e){return Utils.checkWifiIPAddrOrEmpty(e)},p.lang.tip.tipIPErr),p.validator.addMethod("checkIP1To223OrEmpty",function(e){return Utils.checkIP1To223OrEmpty(e)},p.lang.tip.tipIPRangeErr),p.validator.addMethod("checkCommonNamePwd",function(e){return Utils.checkCommonNamePwd(e)},p.lang.tip.tipCharFmtErr),p.validator.addMethod("validStrNoNull",function(e){return Utils.validStrNoNull(e)},p.lang.validate.valRequired),(h=p("#frmSetup").validate({focusInvalid:!1,errorElement:"span",errorPlacement:function(e,t){Utils.showJqueryErr(e,t,"div")},success:function(){},rules:{SSID:{required:!0,maxlength:32,checkServerID:""},SSIDname:{validStrNoNull:"",maxlength:32,minlength:1},password:{maxlength:63,minlength:0,checkCommonNamePwd:""},Key:{required:!0,maxlength:32,minlength:8,checkCommonNamePwd:""},IpGateway:{checkIPAddrOrEmpty:"",checkIP1To223OrEmpty:"",checkWifiIPAddr:""},WifiIpAddress:{required:!0,isIPAddress:"",checkIP1To223:"",checkIPUnequalGW:"",userDefinedCheckIPAndMask:"#IpNetmask",userDefinedCheckIPAndMaskSameNet:"#WifiIpAddress,#IpNetmask,#WifiIpGateway",relationTo:[{id:"#WifiIpGateway",method:"userDefinedCheckIPAndMaskSameNet"}]},IpNetmask:{required:!0,isIPAddress:"",checkSubnetMask:"",relationTo:[{id:"#WifiIpAddress",method:"userDefinedCheckIPAndMask"},{id:"#WifiIpGateway",method:"userDefinedCheckIPAndMask"},{id:"#WifiIpGateway",method:"userDefinedCheckIPAndMaskSameNet"},{id:"#WifiIpAddress",method:"userDefinedCheckIPAndMaskSameNet"}]},WifiIpGateway:{checkIPAddrOrEmpty:"",checkIP1To223OrEmpty:"",checkIPUnequalGW:"",userDefinedCheckIPAndMask:"#IpNetmask",userDefinedCheckIPAndMaskSameNet:"#WifiIpAddress,#IpNetmask,#WifiIpGateway",relationTo:[{id:"#WifiIpAddress",method:"userDefinedCheckIPAndMaskSameNet"}]}}})).init()},initData:function(e){e.Key.value=d,e.password.value=d,Utils.LAPI_GetCfgData(LAPI_URL.WIFI_CFG,c)&&Utils.LAPI_GetCfgData(LAPI_URL.WiFiStreamAdaptSwitch,i)&&Utils.LAPI_GetCfgData(LAPI_URL.wifiIpv4,n)?(I=Utils.objectClone(c),a=Utils.objectClone(i),r=Utils.objectClone(n),0==c.Enabled&&(c.Mode=255),Utils.LAPI_CfgToForm("frmSetup",c,f,S),Utils.LAPI_CfgToForm("frmSetup",i,f,m),Utils.LAPI_CfgToForm("frmSetup",n,f,s),Capinfo.isSupportNormalWiFi&&this.initWifiDataView(),this.changeWifiModeType(),this.changeWifiIPGetType()):Utils.disableAll()},initEvent:function(){var e=this;p("#wifiModeType").change(this.changeWifiModeType),p("#fresh").bind("click",function(){P.refresh(),p("tbody tr").bind("click",e.indexTrMessage)}),p("#IPGetType").change(this.changeWifiIPGetType)},changeWifiIPGetType:function(){2==p("#IPGetType").val()?(p("#IPSet").addClass("hidden"),p("#MaskSet").addClass("hidden"),p("#GWSet").addClass("hidden")):(p("#IPSet").removeClass("hidden"),p("#MaskSet").removeClass("hidden"),p("#GWSet").removeClass("hidden"))},checkSubnetMask:function(e){if(!Utils.isIPAddress(e))return!1;var t=e.split("."),i=parseInt(t[0]),a=parseInt(t[1]),e=parseInt(t[2]),t=parseInt(t[3]);return!(-1<(Utils.format10To2(i)+Utils.format10To2(a)+Utils.format10To2(e)+Utils.format10To2(t)).indexOf("01"))&&(0!=i+a+e+t&&1020!=i+a+e+t)},checkIPUnequalGW:function(){return p("#WifiIpAddress").val()!=p("#WifiIpGateway").val()},submitF:function(){var e=p("#IpGateway"),t=parseInt(p("#wifiModeType").val());h.form()&&""!=e.val()&&"0.0.0.0"!=e.val()&&(""==p("#WifiIpGateway").val()&&p("#WifiIpGateway").val("0.0.0.0"),Utils.LAPI_FormToCfg("frmSetup",c,f,S),Utils.LAPI_FormToCfg("frmSetup",i,f,m),Utils.LAPI_FormToCfg("frmSetup",n,f,s),255==t?(c.Mode=I.Mode,c.Enabled=0):c.Enabled=1,!o&&!l&&Utils.isObjectEquals(c,I)&&Utils.isObjectEquals(i,a)&&Utils.isObjectEquals(n,r)?Frame.showMsg(!0,p.lang.tip.tipAnyChangeInfo,0):((o||l)&&(c.RSAPublicKey={},c.RSAPublicKey.RSAPublicKeyE=Frame.RSAPublicKeyE,c.RSAPublicKey.RSAPublicKeyN=Frame.RSAPublicKeyN,o&&(c.NormalCfg.Key=Utils.encrypting(p("#password").val(),Frame.RSAKey)),l&&(c.SoftAPCfg.Key=Utils.encrypting(p("#Key").val(),Frame.RSAKey))),(!o&&!l&&Utils.isObjectEquals(c,I)||Utils.LAPI_SetCfgData(LAPI_URL.WIFI_CFG,c,!1,this.callback))&&(Utils.isObjectEquals(i,a)||Utils.LAPI_SetCfgData(LAPI_URL.WiFiStreamAdaptSwitch,i)&&(a=Utils.objectClone(i)),Utils.isObjectEquals(n,r)||Utils.LAPI_SetCfgData(LAPI_URL.wifiIpv4,n)&&(r=Utils.objectClone(n)))))},callback:function(e){var t;ResultCode.RESULT_CODE_SUCCEED==e?((o||l)&&(delete c.RSAPublicKey,o&&delete c.NormalCfg.Key,l&&delete c.SoftAPCfg.Key),I=Utils.objectClone(c),l=o=!1,p("#Key").val(d),p("#password").val(d),p("#WifiLinkStatus").html(p.lang.pub.connecting),Frame.showMsg(!0)):ResultCode.RESULT_RASPUBLICKEY_AUTH_ERR==e?(t={},Utils.LAPI_GetCfgData(LAPI_URL.SecurityRSA,t)&&(setMaxDigits(130),Frame.RSAPublicKeyE=t.RSAPublicKeyE,Frame.RSAPublicKeyN=t.RSAPublicKeyN,Frame.RSAKey=new RSAKeyPair(Frame.RSAPublicKeyE,"",Frame.RSAPublicKeyN),c.RSAPublicKey={},c.RSAPublicKey.RSAPublicKeyE=Frame.RSAPublicKeyE,c.RSAPublicKey.RSAPublicKeyN=Frame.RSAPublicKeyN,o&&(c.NormalCfg.Key=Utils.encrypting(p("#password").val(),Frame.RSAKey)),l&&(c.SoftAPCfg.Key=Utils.encrypting(p("#Key").val(),Frame.RSAKey)),Utils.LAPI_SetCfgData(LAPI_URL.WIFI_CFG,c,!1,Config.softAP_config.callback))):GateWay.gatewayConflict==e?alert(p.lang.tip.tipIpGatewayErr):(Frame.showMsg(!1,p.lang.tip.tipSetCfgFail),p("#WifiName").text(""),p("#WifiLinkStatus").html(p.lang.pub.unConnect))},release:function(){},desc:function(e,t){var i=-1;return i=Number(e.RSSOnPCT)<Number(t.RSSOnPCT)?1:i},updateWiFiLinkInfo:function(){var i=this;Utils.LAPI_GetCfgData(LAPI_URL.WIFI_LINK_STATUS,{},"",!1,function(e,t){return i.updateWiFiLinkInfo_callback(e,t)},{"async":!0})},updateWiFiLinkInfo_callback:function(e,t){var i,a,n,r,s,o,l,d=p("#WifiName"),f=p("#WifiLinkStatus"),c=p("#wifiStrength");ResultCode.RESULT_CODE_SUCCEED!=e?(i=p.lang.pub.unConnect,a=p.lang.pub.none,s=r=n="0.0.0.0"):(i=WiFiLinkStatus.DISCONNECT==t.Connected?p.lang.pub.unConnect:p.lang.pub.connected,a=""==t.SSID?p.lang.pub.none:t.SSID,n=""==t.Address?"0.0.0.0":t.Address,r=""==t.Netmask?"0.0.0.0":t.Netmask,s=""==t.Gateway?"0.0.0.0":t.Gateway,o=""==t.SignalOnPCT?"0":t.SignalOnPCT),"string"==typeof a&&(a=a.replace(/\s/g,"&nbsp;")),d.html(a),f.text(i),p("#IpAddress").text(n),p("#NetMask").text(r),p("#GateWay").text(s),l=this.strengthFun(0,o),c.html(l),u=setTimeout("Config.softAP_config.updateWiFiLinkInfo()",9e3)},getData:function(){var e=[];if(t={},0==c.Mode){if(!Utils.LAPI_GetCfgData(LAPI_URL.WIFI_SCANNING_INFO,t))return;(e=t.ScanInfos).sort(this.desc)}return e},initWifiDataView:function(){var e=this;(P=new TableView("dataview_tbody",function(){return e.getData()},A)).setFields({EncryptType:function(e){return g[e]},AuthMode:function(e){return C[e]}}),P.createDataView()},changeWifiModeType:function(){h.form()&&p("#frmSetup .error").removeClass("error.41879f48");var e=p("#wifiModeType"),t=Number(e.val()),i=p("#wifiStatus"),a=p("#wifiList"),n=p("#wifiCfg"),r=p("#wifiSignal"),s=p("#wifiBiteAutoSwitch");if(i.addClass("hidden"),a.addClass("hidden"),n.addClass("hidden"),r.addClass("hidden"),s.addClass("hidden"),clearTimeout(u),Utils.LAPI_CfgToForm("frmSetup",I,f,S),e.val(t),o=!1,p("#Key").val(d),l=!1,p("#password").val(d),0==t){if(i.removeClass("hidden"),a.removeClass("hidden"),n.removeClass("hidden"),s.removeClass("hidden"),0!=c.Mode||1!=c.Enabled){if(c.Enabled=1,c.Mode=t,!Utils.LAPI_SetCfgData(LAPI_URL.WIFI_CFG,c,!1))return;I=Utils.objectClone(c),P.refresh()}p("tbody tr").bind("click",this.indexTrMessage),Config.softAP_config.updateWiFiLinkInfo(),Config.softAP_config.changeWifiIPGetType()}else 1==t&&r.removeClass("hidden")},indexTrMessage:function(){var e=p(this).attr("rowNum");p("#SSIDname").val(t.ScanInfos[e].SSID),p("#EncryptionMode").val(t.ScanInfos[e].EncryptType),p("#SafeType").val(t.ScanInfos[e].AuthMode),c.NormalCfg.SSID!=p("#SSIDname").val()?p("#password").val(""):p("#password").val(c.NormalCfg.Key)},strengthFun:function(e,t){var i="",a=0;switch(0==t?a=0:0<t&&t<=25?a=1:25<t&&t<=50?a=2:50<t&&t<=75?a=3:75<t&&t<100?a=4:100==t&&(a=5),a){case 0:i="<a class='icon strength_0' rowNum="+e+"></a>";break;case 1:i="<a class='icon strength_20' rowNum="+e+"></a>";break;case 2:i="<a class='icon strength_40' rowNum="+e+"></a>";break;case 3:i="<a class='icon strength_60' rowNum="+e+"></a>";break;case 4:i="<a class='icon strength_80' rowNum="+e+"></a>";break;case 5:i="<a class='icon strength_100' rowNum="+e+"></a>";break;default:i="<a class='icon strength_0' rowNum="+e+"></a>"}return i},initPwdChanged:function(e){"password"!=e||o?"Key"!=e||l||(p("#"+e).val(""),l=!0):(p("#"+e).val(""),o=!0)}}))}(jQuery),Config.softAP_config.init2(),Frame.currentNameSpace=Config.softAP_config;