Utils.$package("LoginPage"),LoginPage=function($){"undefined"==typeof top.banner&&(window.location="/");var language=parseInt(Utils.getparastr("langinfo")),user=Utils.getparastr("user"),key2=Utils.getparastr("Key2"),portMap={},languageList=showLangList.replace(/\s/g,"").split(","),serverIP=window.location.hostname,jsonMap={},isMac=Utils.isMacPlatform(),sdk_viewer=null,hrefArr=top.window.location.href,searchArr=top.window.location.search,isFirstLogin={};top.is64Platform=Utils.isWin64Platform(),top.loginUserName=Utils.getparastr("userName"),top.loginUserPwd=Utils.getparastr("loginCert"),top.responseAuthInfo=null,top.realm="",top.nonce="",top.qop="",top.stale="",top.nc=0,top.language=Utils.getparastr("langinfo"),top.SDKPort=Utils.getparastr("SDKPort"),null==top.SDKPort&&("https:"==window.location.protocol?top.SDKPort=""==window.location.port?443:window.location.port:top.SDKPort=""==window.location.port?80:window.location.port),top.RTSPPort=null==Utils.getparastr("RTSPPort")?0:Utils.getparastr("RTSPPort"),top.loginServerIp=window.location.host,top.loginClientIp=Utils.getparastr("clientIpAddr"),top.loginType=null==Utils.getparastr("loginType")?0:Utils.getparastr("loginType"),top.menuType=null==Utils.getparastr("menuType")?0:Utils.getparastr("menuType"),top.IsRemote=Number(Utils.getparastr("IsRemote")),$.ajaxSettings["async"]=!1,$.get("/LANG/custom/custom_lang.js?date="+(new Date).getTime(),function(){languageList.push(-1)}),$.ajaxSettings["async"]=!0,-1!=language?(Utils.isContainsElement(language,languageList)<0&&(language=languageList[0]),top.wdateLang=supportLangList[language].dateFileName):top.wdateLang=supportLangList[1].dateFileName,top.language=language,Utils.loadlanguageFile(top.language),top.defaultUserName="","top"==window.name&&window.close();var mainClass=Class.extend({openWinNameSpace:"",init:function(){$("input").attr("autocomplete","off"),$("form").attr("autocomplete","off"),"undefined"!=typeof showDeviceType&&(document.getElementById("deviceTypeName").innerHTML=showDeviceType.split("@")[0]),Utils.initLang(),this.initPage(),this.initEvent(),this.initData()},initPage:function(){top.document.getElementById("banner").setAttribute("allowfullscreen","true");var e,t=(new Date).getTime(),i={};Utils.setCookie("WebLoginHandle",t),Utils.delCookie("isRecordLoginCert"),Utils.delCookie("userName"),Utils.delCookie("loginCert"),$("#warningImg").attr("src",warningSrc[skinType]),$("#logoImg").attr("src","/skin/default_1/images/logo.png?t="+(new Date).getTime()),this.initOcx(),Capinfo.getCapInfo(),Capinfo.isUniarch&&Utils.loadCss("skinCss","/skin/uniarch/css/customized.56726c6e.css"),Capinfo.isNoPlugin||(null===(e=top.sdk_viewer.checkVersion())?(isMac||top.is64Platform?$("#login_body").find("#ieVersion .activeXDiv").html($.lang.tip.tipInstallPlugin):$("#login_body").find("#ieVersion .downloadTip").html($.lang.pub.downloadTip3+" "),$("#login_body").find("#ieVersion").slideDown()):(e||(isMac||top.is64Platform?$("#login_body").find("#ieVersion .activeXDiv").html($.lang.tip.tipInstallPlugin):$("#login_body").find("#ieVersion .downloadTip").html($.lang.pub.downloadTip3+" "),$("#login_body").find("#ieVersion").slideDown()),top.sdk_viewer.execFunctionReturnAll("NetSDKSetTrustSiteEnable",0),top.sdk_viewer.execFunctionReturnAll("NetSDKSetTrustSite",window.location.hostname)),$("#ieVersion").attr("title",$.lang.pub.hiddenTips),$("#download").attr("title",$.lang.pub.downloadSetup)),isUN?($("#findpasswd").removeClass("hidden"),top.defaultUserName="admin"):(e=new Date(Utils.getIPCTime()),$("#ipcDate").text(e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate())),$("#userName").val(top.defaultUserName),this.generalLangList(),$("#langinfo").val(top.language),Utils.strLimit(),document.title=$.lang.pub.indexTitle,Utils.LAPI_GetCfgData(LAPI_URL.FirstLogin,isFirstLogin)&&Utils.LAPI_GetCfgData(LAPI_URL.DeviceWorkMode,i)&&1===isFirstLogin.IsFirstLogin&&1===i.Mode&&(Utils.openWin($.lang.pub.changePwdTitle,"/page/common/firstLogin.8f45e0d9.htm",520,400,!1,"35%","25%",!1,"login_body"),$("#bgObj").css({opacity:"1",backgroundColor:"#f4f5f7"}),$("#userName").blur(),$("#password").blur())},initData:function(){var jsonMap;null!=user&&null!=key2&&(portMap=eval("("+Utils.base64decode(key2)+")"),top.SDKPort=portMap.sdk,top.RTSPPort=portMap.rtsp),LoginType.VM_LOGIN==top.loginType?window.location="/page/common/frame.5c86a01e.htm":($("#login_fullPage").removeClass("hidden"),isUN?0===isFirstLogin.IsFirstLogin&&$("#password").focus():0===isFirstLogin.IsFirstLogin&&$("#userName").focus(),"0"==Utils.getCookie("isAutoStartVideo")&&$("#autoPlay").prop("checked",!1),null!=top.loginUserName&&null!=top.loginUserPwd&&(jsonMap={},Utils.LAPI_SetCfgData(LAPI_URL.webLoginCfg,jsonMap,!1,LoginPage.queryStatus)&&(window.location="/page/common/frame.5c86a01e.htm")))},initEvent:function(){isUN||(document.onkeydown=this.showDate),$("#ieVersion").bind("dblclick",function(){$("#ieVersion").slideUp(0)}),$("#download").bind("click",this.checkInstallStatus),$("#findpasswd").bind("click",function(){var e=$(".login_form").offset(),t=e.left,e=e.top+$(".login_logo").height();Utils.openWin($.lang.pub.findpassward,"/page/common/findpasswd.9c056bc3.htm",548,200,!0,t,e,!1,"login_body")}),$("#langinfo").change(this.changeLanguage),$("#login").bind("click",this.submitF),$("#reset").bind("click",this.resetLoginInfo),$("#autoPlay").bind("click",this.enableAutoPlay),$("#saveLoginCert").bind("click",this.recordPassword)},submitF:function(){var e;if(""==document.loginForm.userName.value)return alert($.lang.tip.tipUsrNameRequired),void document.loginForm.userName.focus();Utils.validUserNameCheck(document.loginForm.userName,$.lang.tip.tipUsrNameInvalid)?(e=$("#password"),LoginPage.check_chinese(e.val())?(top.loginUserName=$("#userName").val(),top.loginUserPwd=$("#password").val(),Utils.LAPI_SetCfgData(LAPI_URL.webLoginCfg,{},!1,LoginPage.queryStatus)&&(window.location="/page/common/frame.5c86a01e.htm")):e.focus()):document.loginForm.userName.focus()},check_username:function(e){var t=Utils.getEvent().keyCode,i=e.value;13==t&&(0!=i.length?$("#password"):e).focus()},check_passwd:function(){13==Utils.getEvent().keyCode&&this.submitF()},release:function(){Video.sdk_viewer.isInstalled&&Video.sdk_viewer.unInit()},initOcx:function(){var e,t,i;isMac?(t="netsdkplayer-plugin",i="1.2.0.3"):(i=(t=isUN?(e="B91BB9EA-9CDF-4917-9037-27CE4DEF0D8A","netsdkplayer-plugin-un"):(e="0F1A61E3-9097-4550-AC8C-3EA1D34690C9","netsdkplayer-plugin-nb"),"0.3.0.6"),top.is64Platform&&(i="1.2.0.2")),Capinfo.isNoPlugin||(sdk_viewer=new Player({application:t,eventname:"plgnevent",clsid:e,version:i,id:"player",container:"activeX_obj",name:"sdk_viewer",szDeviceIp:top.loginServerIp,prefix:"__",maxWnd:6,noCreateWnd:!0}),top.sdk_viewer=sdk_viewer)},generalLangList:function(){for(var e,t=languageList.length,i="",n=0;n<t;n++)i+=-1==(e=languageList[n])?"<option value='-1'>CustomLang</option>":"<option value='"+e+"'>"+supportLangList[e].langName+"</option>";var o=$("#langinfo");o.empty(),o.append(i),1!=t&&$("#langinfoDiv").removeClass("hide")},showDate:function(e){var t=Utils.getEvent(),t=(e=e||t).keyCode||e.which||e.charCode;KEY_CODE.keyD==t&&e.shiftKey&&e.ctrlKey&&e.altKey&&$(".login_IpcDateDiv").removeClass("hidden")},checkInstallStatus:function(){(Utils.checkNavigator("ie")||Utils.checkNavigator("firefox"))&&LoginPage.initOcx();var e=sdk_viewer.checkVersion();e&&null!==e?window.location.reload():setTimeout(LoginPage.checkInstallStatus,5e3)},changeLanguage:function(){var e=Number($("#langinfo").val());top.language!=e&&(-1<hrefArr.indexOf("langinfo=")&&(hrefArr=hrefArr.replace("langinfo="+top.language,"langinfo="+e),top.window.location.href=hrefArr),""!=searchArr?(searchArr=-1<searchArr.indexOf("langinfo=")?searchArr.replace("langinfo="+top.language,"langinfo="+e):searchArr+"&langinfo="+e,top.window.location.search=searchArr):top.window.location.search="langinfo="+e,top.language=e)},check_chinese:function(e){for(var t=0;t<e.length;t++){var i=e.charCodeAt(t);if(256<=i&&i<=12287||12330<=i&&i<=65280)return alert($.lang.tip.tipUsrPwdUnCH),0}return 1},resetLoginInfo:function(){Utils.delCookie("isRecordLoginCert"),Utils.delCookie("userName"),Utils.delCookie("loginCert"),$("#userName").val(""),$("#password").val(""),$("#loginCert").val(""),$("#saveLoginCert").prop("checked",!1)},queryStatus:function(e){ResultCode.RESULT_CODE_SUCCEED!=e&&(e=ResultCode.RESULT_CODE_USERFULL==e?$.lang.tip.tipOcxInitFullUser:ResultCode.RESULT_CODE_USERNONEXIST==e||ResultCode.RESULT_CODE_PASSWD_INVALID==e?$.lang.tip.tipOcxInitInvalidUser:ResultCode.RESULT_CODE_TIMEOUT==e?$.lang.tip.tipOcxInitWaiting:ResultCode.ERR_SDK_COMMON_LOCK_USER==e?$.lang.tip.tipLockUser:ResultCode.ERR_SDK_REMOTE_USER_WITH_WEAK_PASSWD==e?$.lang.tip.tipLockUserPassword:ResultCode.ERR_SDK_COMMON_TEMPWD_LIMIT==e?$.lang.tip.tipTemPwdLimit:$.lang.tip.tipOcxInitFail,alert(e))},enableAutoPlay:function(){var e=$("#autoPlay").is(":checked")?1:0;Utils.setCookie("isAutoStartVideo",e)}});return new mainClass}(jQuery),$(window).resize(function(){var e=$(".login_form").offset(),t=e.left,e=e.top+$(".login_logo").height();$("#msgObj").css({left:t,top:e})});