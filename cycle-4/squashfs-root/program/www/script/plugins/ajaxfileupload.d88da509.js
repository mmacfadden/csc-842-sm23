jQuery.extend({createUploadIframe:function(e,t){var r="jUploadFrame"+e,e='<iframe id="'+r+'" name="'+r+'" style="position:absolute; top:-9999px; left:-9999px"';return window.ActiveXObject&&("boolean"==typeof t?e+=' src="javascript:false"':"string"==typeof t&&(e+=' src="'+t+'"')),e+=" />",jQuery(e).appendTo(document.body),jQuery("#"+r).get(0)},createUploadForm:function(e,t,r,a){var o="jUploadForm"+e,e="jUploadFile"+e,n=jQuery('<form  action="" method="POST" name="'+o+'" id="'+o+'" enctype="multipart/form-data"></form>');if(r)for(var u in r)jQuery('<input type="hidden" name="'+u+'" value="'+r[u]+'" />').appendTo(n);a=(t=null==a?jQuery("#"+t):a).clone(!0);return a[0].files=t[0].files,t.attr("id",e),t.before(a),t.appendTo(n),jQuery(n).css("position","absolute"),jQuery(n).css("top","-1200px"),jQuery(n).css("left","-1200px"),jQuery(n).appendTo("body"),n},ajaxFileUpload:function(n){n=jQuery.extend({},jQuery.ajaxSettings,n);var e=(new Date).getTime(),u=jQuery.createUploadForm(e,n.fileElementId,"undefined"!=typeof n.data&&n.data,n.fileElement),d=(jQuery.createUploadIframe(e,n.secureuri),"jUploadFrame"+e),e="jUploadForm"+e;n.global&&!jQuery.active++&&jQuery.event.trigger("ajaxStart");var c=!1,l={};n.global&&jQuery.event.trigger("ajaxSend",[l,n]);var t=function(e){var t,r,a=document.getElementById(d);try{a.contentWindow?(l.responseText=a.contentWindow.document.body?a.contentWindow.document.body.innerHTML:null,l.responseXML=a.contentWindow.document.XMLDocument||a.contentWindow.document):a.contentDocument&&(l.responseText=a.contentDocument.document.body?a.contentDocument.document.body.innerHTML:null,l.responseXML=a.contentDocument.document.XMLDocument||a.contentDocument.document)}catch(o){jQuery.handleError(n,l,null,o)}if(l||"timeout"==e){c=!0;try{"error"!=(r="timeout"!=e?"success":"error")?(t=jQuery.uploadHttpData(l,n.dataType),n.success&&n.success(t,r),n.global&&jQuery.event.trigger("ajaxSuccess",[t,n])):jQuery.handleError(n,l,r)}catch(o){r="error",jQuery.handleError(n,l,r,o)}n.global&&jQuery.event.trigger("ajaxComplete",[l,n]),n.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop"),n.complete&&n.complete(l,r),jQuery(a).unbind(),setTimeout(function(){try{jQuery(a).remove(),jQuery(u).remove()}catch(o){jQuery.handleError(n,l,null,o)}},100),l=null}};0<n.timeout&&setTimeout(function(){c||t("timeout")},n.timeout);try{u=jQuery("#"+e);jQuery(u).attr("action",n.url),jQuery(u).attr("method","POST"),jQuery(u).attr("target",d),u.encoding?jQuery(u).attr("encoding","multipart/form-data"):jQuery(u).attr("enctype","multipart/form-data"),jQuery(u).submit()}catch(r){jQuery.handleError(n,l,null,r)}return jQuery("#"+d).load(t),{abort:function(){try{jQuery("#"+d).remove(),jQuery(u).remove()}catch(r){}}}},uploadHttpData:function(r,type){var data=!type,data="xml"==type||data?r.responseXML:r.responseText;"script"==type&&jQuery.globalEval(data),"json"==type&&(data=r.responseText);var start=data.indexOf(">"),end;return-1!=start&&(end=data.indexOf("<",start+1),-1!=end&&(data=data.substring(start+1,end))),eval("data = "+data),"html"==type&&jQuery("<div>").html(data).evalScripts(),data},handleError:function(e,t,r,a){e.error&&e.error(t,r,a),e.global&&jQuery.event.trigger("ajaxError",[t,e,a])}});