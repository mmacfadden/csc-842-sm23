var TableView=function(e,t,i,n,a,s){this.getDataFn=t,this.table=document.getElementById(e)?document.getElementById(e):null,this.currectRow=-1,this._dataList=t()||[],this.headInfoList=i||[],this.trId="",this.trEventMap={},this.insertIndex=void 0===s?-1:0,this.defaultRowLen=n||0,this.evenColor=a||""};function setUpContent(e,t){t=t.fn;return e=t?t(e):e}TableView.prototype={createRow:function(e,t){var i=this.table.insertRow(this.insertIndex);if(i.setAttribute("rowNum",e),null!=t){""!=this.trId&&(i.id=t[this.trId]);var n=this,a=function(e){e=Utils.checkNavigator("ie")?document.activeElement:e.target;"TR"!=e.tagName&&"TD"!=e.tagName||n.checkRow(e.getAttribute("rowNum"))};for(w in i.addEventListener?i.addEventListener("click",a,!1):i.attachEvent("onclick",a),this.trEventMap)"onclick"==w&&(i.removeEventListener?i.removeEventListener("click",a,!1):i.detachEvent("onclick",a)),i.addEventListener?i.addEventListener(w.replace("on",""),this.trEventMap[w],!1):i.attachEvent(w,this.trEventMap[w]);""!==this.evenColor&&0==(e+1)%2&&(i.style.backgroundColor=this.evenColor)}for(var s=this.headInfoList?this.headInfoList.length:0,r=0;r<s;r++){var c=this.headInfoList[r],o=i.insertCell(-1);if(c.hidden&&(o.className="hidden"),null!=t){var l=void 0===(l=c.fieldType)?"label":l,d=c.fieldId,h=c.eventMap,u=t[d],v=c.styleText;"undefined"!=typeof c.hiddenFillter&&u==c.hiddenFillter&&(i.className="hidden"),o.id=d+e+"_TD",o.setAttribute("rowNum",e);var f="";if("RowNum"==l?f=e+1:"checkbox"==l?(f="<input type='checkbox' id='"+d+e+"' name='"+d+e+"'",1==Number(u)&&(f+="checked='checked'"),f+="/>"):"text"==l?f="<input type='text' class='dv_width' id='"+d+e+"' name='"+d+e+"' value='"+setUpContent(u,c)+"' />":"dateTime"==l?f="<input type='text' class='Wdate dv_width' id='"+d+e+"' name='"+d+e+"' value='"+u+"' onfocus='Utils.pickerTime()' />":"select"==l?f=(f=(f=(f="<select class='dv_width' id='"+d+e+"' name='"+d+e+"' >"+c.getOptions()+"</select>").replace('value="'+u+'"',"value='"+u+"' selected='selected'")).replace("value='"+u+"'","value='"+u+"' selected='selected'")).replace("value="+u,"value='"+u+"' selected='selected'"):"define"==l?(p=c.contentFn)&&p instanceof Function&&(f=p(e,u)):"option"==l?f=(f=(f=c.defineContextFn?c.defineContextFn(t):c.option).replace(/rowNum=rowNum/g,"rowNum="+e)).replace(/#rowNum/g,e):"label"==l&&"string"==typeof(f=setUpContent(u,c))&&f==u&&(f=f.replace(/\s/g,"&nbsp;")),o.innerHTML=f,v&&(o.style.cssText=v),h){var w,m=document.getElementById(d+e);for(w in h){var p=h[w];m.addEventListener?m.addEventListener(w.replace("on",""),p,!1):m.attachEvent(w,p)}}}}},createDataView:function(){this.clearTable(this.table);for(var e=this._dataList?this._dataList.length:0,t=0;t<e;t++){var i=this._dataList[t];this.createRow(t,i)}for(;t<this.defaultRowLen;t++)this.createRow(t,null)},setFields:function(e){for(var t=0,i=this.headInfoList.length;t<i;t++){var n=this.headInfoList[t],a=e[n.fieldId];a&&(n.fn=a)}},setTrEvnet:function(e){for(var t in e)this.trEventMap[t]=e[t]},addData:function(){var e=this._dataList?this._dataList.length:0,t=this._dataList[e-1];this.defaultRowLen>=e?this.refresh():this.createRow(e-1,t)},removeI:function(){},removeII:function(e){},getData:function(e,t){e=this._dataList[e];return e=undefined!=t?e[t]:e},checkRow:function(e){e<0||(-1!=this.currectRow&&(this.table.rows[this.currectRow].className=this.table.rows[this.currectRow].className.replace("selectedTR","")),this.currectRow=e,this.table.rows[this.currectRow].className=this.table.rows[this.currectRow].className+" selectedTR")},clearTable:function(e){for(var t=e.rows.length;0<t;t--)e.deleteRow(t-1)},refresh:function(){this._dataList=this.getDataFn(),this.createDataView(),this.currectRow=-1}};