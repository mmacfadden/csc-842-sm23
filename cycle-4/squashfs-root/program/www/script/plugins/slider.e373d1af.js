var isIE=!!document.all,$$=function(t){return"string"==typeof t?document.getElementById(t):t},Class={create:function(){return function(){this.initialize.apply(this,arguments)}}},Extend=function(t,i){for(var e in i)t[e]=i[e]},Bind=function(t,i){var e=Array.prototype.slice.call(arguments).slice(2);return function(){return i.apply(t,e)}},BindAsEventListener=function(i,e){return function(t){return e.call(i,Event(t))}};function Event(t){t=isIE?window.event:t;return isIE&&(t.pageX=t.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft),t.pageY=t.clientY+(document.documentElement.scrollTop||document.body.scrollTop),t.preventDefault=function(){this.returnValue=!1},t.detail=t.wheelDelta/-40,t.stopPropagation=function(){this.cancelBubble=!0}),t}var Each=function(t,i){for(var e=0,s=t.length;e<s;e++)i(t[e],e)},CurrentStyle=function(t){return t.currentStyle||document.defaultView.getComputedStyle(t,null)};function addEventHandler(t,i,e){t.addEventListener?t.addEventListener(i,e,!1):t.attachEvent?t.attachEvent("on"+i,e):t["on"+i]=e}function removeEventHandler(t,i,e){t.removeEventListener?t.removeEventListener(i,e,!1):t.detachEvent?t.detachEvent("on"+i,e):t["on"+i]=null}var Drag=Class.create();Drag.prototype={initialize:function(drag,options){if(this.Drag=$$(drag),this._x=this._y=0,this._marginLeft=this._marginTop=0,this._fA=BindAsEventListener(this,this.Start),this._fM=BindAsEventListener(this,this.Move),this._fS=Bind(this,this.Stop),this.SetOptions(options),this.Limit=!!this.options.Limit,this.mxLeft=parseInt(this.options.mxLeft),this.mxRight=parseInt(this.options.mxRight),this.mxTop=parseInt(this.options.mxTop),this.mxBottom=parseInt(this.options.mxBottom),this.LockX=!!this.options.LockX,this.LockY=!!this.options.LockY,this.Lock=!!this.options.Lock,this.onStart=this.options.onStart,this.onMove=this.options.onMove,this.onStop=this.options.onStop,this._Handle=$$(this.options.Handle)||this.Drag,this._mxContainer=$$(this.options.mxContainer)||null,this.Drag.style.position="absolute",isIE&&this.options.Transparent)with(this._Handle.style.overflow="hidden",this._Handle.appendChild(document.createElement("div")).style)width=height="100%",backgroundColor="#fff",filter="alpha(opacity:0)";this.Repair()},SetOptions:function(t){this.options={Handle:"",Limit:!1,mxLeft:0,mxRight:9999,mxTop:0,mxBottom:9999,mxContainer:"",LockX:!1,LockY:!1,Lock:!1,Transparent:!1,onStart:function(){},onMove:function(){},onStop:function(){}},Extend(this.options,t||{})},Start:function(t){this.Lock||(this.Repair(),this._x=t.clientX-this.Drag.offsetLeft,this._y=t.clientY-this.Drag.offsetTop,this._marginLeft=parseInt(CurrentStyle(this.Drag).marginLeft)||0,this._marginTop=parseInt(CurrentStyle(this.Drag).marginTop)||0,addEventHandler(document,"mousemove",this._fM),addEventHandler(document,"mouseup",this._fS),isIE?(addEventHandler(this._Handle,"losecapture",this._fS),this._Handle.setCapture()):(addEventHandler(window,"blur",this._fS),t.preventDefault()),this.onStart())},Repair:function(){this.Limit&&(this.mxRight=Math.max(this.mxRight,this.mxLeft+this.Drag.offsetWidth),this.mxBottom=Math.max(this.mxBottom,this.mxTop+this.Drag.offsetHeight),this._mxContainer&&"relative"!=CurrentStyle(this._mxContainer).position&&"absolute"!=CurrentStyle(this._mxContainer).position&&(this._mxContainer.style.position="relative"))},Move:function(t){this.Lock?this.Stop():(window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),this.SetPos(t.clientX-this._x,t.clientY-this._y))},SetPos:function(t,i){var e,s,n,o;this.Limit&&(e=this.mxLeft,s=this.mxRight,n=this.mxTop,o=this.mxBottom,this._mxContainer&&(e=Math.max(e,0),n=Math.max(n,0),s=Math.min(s,this._mxContainer.clientWidth),o=Math.min(o,this._mxContainer.clientHeight)),t=Math.max(Math.min(t,s-this.Drag.offsetWidth),e),i=Math.max(Math.min(i,o-this.Drag.offsetHeight),n)),this.LockX||(this.Drag.style.left=t-this._marginLeft+"px",this.Drag.previousSibling.style.width=this.Drag.style.left),this.LockY||(this.Drag.style.top=i-this._marginTop+"px",this.Drag.previousSibling.style.height=o-(i-this._marginTop)-this.Drag.offsetHeight+"px",this.Drag.previousSibling.style.top=i-this._marginTop+this.Drag.offsetHeight+"px"),this.onMove()},Stop:function(){removeEventHandler(document,"mousemove",this._fM),removeEventHandler(document,"mouseup",this._fS),isIE?(removeEventHandler(this._Handle,"losecapture",this._fS),this._Handle.releaseCapture()):removeEventHandler(window,"blur",this._fS),this.onStop()},SetEnable:function(t){(t?addEventHandler:removeEventHandler)(this._Handle,"mousedown",this._fA)}};var Slider=Class.create();Slider.prototype={initialize:function(t,i,e){this.Bar=$$(i),this.Container=$$(t),this._timer=null,this._ondrag=!1,this._IsMin=this._IsMax=this._IsMid=!1,this._drag=new Drag(this.Bar,{Limit:!0,mxContainer:this.Container,onStart:Bind(this,this.DragStart),onStop:Bind(this,this.DragStop),onMove:Bind(this,this.Move)}),this.SetOptions(e),this.WheelSpeed=Math.max(0,this.options.WheelSpeed),this.KeySpeed=Math.max(0,this.options.KeySpeed),this.MinValue=this.options.MinValue,this.MaxValue=this.options.MaxValue,this.RunTime=Math.max(1,this.options.RunTime),this.RunStep=Math.max(1,this.options.RunStep),this.Ease=!!this.options.Ease,this.EaseStep=Math.max(1,this.options.EaseStep),this.onMin=this.options.onMin,this.onMax=this.options.onMax,this.onMid=this.options.onMid,this.onDragStart=this.options.onDragStart,this.onDragStop=this.options.onDragStop,this.onMove=this.options.onMove,this._horizontal=!!this.options.Horizontal,this.showTip=this.options.showTip,this.sliderTip=this.Bar.nextSibling,this._drag[this._horizontal?"LockY":"LockX"]=!0,this.ContainerClk=BindAsEventListener(this,function(t){this._ondrag||this.ClickCtrl(t)}),this.BarClk=BindAsEventListener(this,function(t){t.stopPropagation()}),this.setEnable(!0),addEventHandler(this.Bar,"click",this.BarClk);var s=isIE?(this.KeyBind(this.Bar),this.Bar):this.Container;addEventHandler(this.Bar,"mousedown",function(){s.focus()});e=this.Bar.previousSibling;null!=e&&"DIV"==e.nodeName||((e=document.createElement("div")).className="slider-range",this.Container.insertBefore(e,this.Bar)),this._horizontal||(e.className="slider-range-vertical",$(this.Bar).addClass("bar-vertical"),$(this.Container).addClass("slider-vertical")),this.showTip&&(null!=this.sliderTip&&"DIV"==this.sliderTip.nodeName&&$(this.sliderTip).hasClass("slider-tip")||(this.sliderTip=document.createElement("div"),this.sliderTip.className="slider-tip hidden",$(this.Bar).after(this.sliderTip),this._horizontal?$(this.sliderTip).css({left:$(this.Container).width()+2,top:0-$(this.sliderTip).height()/2}):$(this.sliderTip).css({left:0,top:0-$(this.sliderTip).height()-4}),addEventHandler(this.Container,"mouseover",BindAsEventListener(this,function(){$(this.sliderTip).removeClass("hidden")})),addEventHandler(this.Container,"mouseout",BindAsEventListener(this,function(){$(this.sliderTip).addClass("hidden")}))))},setEnable:function(t){(t?addEventHandler:removeEventHandler)(this.Container,"click",this.ContainerClk),this._drag.SetEnable(t)},SetOptions:function(t){this.options={MinValue:0,MaxValue:255,WheelSpeed:.4,KeySpeed:130,Horizontal:!0,RunTime:10,RunStep:5,Ease:!1,EaseStep:5,showTip:!1,onMin:function(){},onMax:function(){},onMid:function(){},onDragStart:function(){},onDragStop:function(){},onMove:function(){}},Extend(this.options,t||{})},DragStart:function(){this.Stop(),this.onDragStart(),this._ondrag=!0},DragStop:function(){this.onDragStop(),setTimeout(Bind(this,function(){this._ondrag=!1}),10)},Move:function(){this.onMove();var t=this.GetPercent();0<t?this._IsMin=!1:this._IsMin||(this.onMin(),this._IsMin=!0),t<1?this._IsMax=!1:this._IsMax||(this.onMax(),this._IsMax=!0),0<t&&t<1?this._IsMid||(this.onMid(),this._IsMid=!0):this._IsMid=!1,this.UpdateTip()},ClickCtrl:function(t){for(var i=this.Container,e=i.offsetLeft,s=i.offsetTop;i.offsetParent;)e+=(i=i.offsetParent).offsetLeft,s+=i.offsetTop;this.EasePos(t.pageX-e-this.Bar.offsetWidth/2,t.pageY-s-this.Bar.offsetHeight/2),this.onDragStop()},WheelCtrl:function(t){var i=this.WheelSpeed*t.detail;this.SetPos(this.Bar.offsetLeft+i,this.Bar.offsetTop+i),t.preventDefault()},WheelBind:function(t){addEventHandler(t,isIE?"mousewheel":"DOMMouseScroll",BindAsEventListener(this,this.WheelCtrl))},KeyCtrl:function(t){if(this.KeySpeed){var i=this.Bar.offsetLeft,e=(this.Container.clientWidth-this.Bar.offsetWidth)/this.KeySpeed,s=this.Bar.offsetTop,n=(this.Container.clientHeight-this.Bar.offsetHeight)/this.KeySpeed;switch(t.keyCode){case 37:i-=e;break;case 38:s-=n;break;case 39:i+=e;break;case 40:s+=n;break;default:return}this.SetPos(i,s),t.preventDefault()}},KeyBind:function(t){addEventHandler(t,"keydown",BindAsEventListener(this,this.KeyCtrl)),t.tabIndex=-1,isIE||(t.style.outline="none")},GetValue:function(){return this.MinValue+this.GetPercent()*(this.MaxValue-this.MinValue)},SetValue:function(t){this.SetPercent((t-this.MinValue)/(this.MaxValue-this.MinValue)),this.UpdateTip()},GetPercent:function(){return this._horizontal?this.Bar.offsetLeft/(this.Container.clientWidth-this.Bar.offsetWidth):(this.Container.clientHeight-this.Bar.offsetHeight-this.Bar.offsetTop)/(this.Container.clientHeight-this.Bar.offsetHeight)},SetPercent:function(t){var i=this._horizontal?(this.Container.clientHeight-this.Bar.offsetHeight)*t:(this.Container.clientHeight-this.Bar.offsetHeight)*(1-t);this.EasePos((this.Container.clientWidth-this.Bar.offsetWidth)*t,i)},UpdateTip:function(){this.showTip&&$(this.sliderTip).text(Math.round(this.GetValue()))},Run:function(t){this.Stop(),t=!!t;var i=this.GetPercent()+(t?1:-1)*this.RunStep/100;this.SetPos((this.Container.clientWidth-this.Bar.offsetWidth)*i,(this.Container.clientHeight-this.Bar.offsetHeight)*i),(t?this._IsMax:this._IsMin)||(this._timer=setTimeout(Bind(this,this.Run,t),this.RunTime))},Stop:function(){clearTimeout(this._timer)},EasePos:function(t,i){var e,s,n,o;this.Stop(),t=Math.round(t),i=Math.round(i),this.Ease?(e=this.Bar.offsetLeft,s=this.GetStep(t,e),n=this.Bar.offsetTop,o=this.GetStep(i,n),(this._horizontal?s:o)&&(this.SetPos(e+s,n+o),this._IsMid&&(this._timer=setTimeout(Bind(this,this.EasePos,t,i),this.RunTime)))):this.SetPos(t,i)},GetStep:function(t,i){i=(t-i)/this.EaseStep;return 0==i?0:Math.abs(i)<1?0<i?1:-1:i},SetPos:function(t,i){this.Stop(),this._drag.SetPos(t,i)}};